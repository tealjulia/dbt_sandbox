

============================== 2022-05-26 19:20:58.316001 | dbbe322d-3f60-4459-91bf-ec2fab316ea5 ==============================
19:20:58.316018 [info ] [MainThread]: Running with dbt=1.1.0
19:20:58.316614 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
19:20:58.316789 [debug] [MainThread]: Tracking: tracking
19:20:58.330932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121635640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121635760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121635790>]}
19:20:58.331843 [info ] [MainThread]: Start parsing.
19:20:58.338319 [info ] [MainThread]: Dependencies loaded
19:20:58.338960 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
19:20:58.339089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbbe322d-3f60-4459-91bf-ec2fab316ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12162eaf0>]}
19:20:58.339190 [info ] [MainThread]: ManifestLoader created
19:20:58.346297 [debug] [MainThread]: Parsing macros/catalog.sql
19:20:58.348532 [debug] [MainThread]: Parsing macros/relations.sql
19:20:58.349232 [debug] [MainThread]: Parsing macros/adapters.sql
19:20:58.360082 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:20:58.360848 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:20:58.362574 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:20:58.363581 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:20:58.364326 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:20:58.372424 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:20:58.378948 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:20:58.384920 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:20:58.387079 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:20:58.387915 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:20:58.388727 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:20:58.390723 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:20:58.398853 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:20:58.399551 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:20:58.404367 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:20:58.412313 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:20:58.416531 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:20:58.417952 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:20:58.421501 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:20:58.422081 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:20:58.423315 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:20:58.424337 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:20:58.427146 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:20:58.435348 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:20:58.436060 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:20:58.437200 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:20:58.437921 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:20:58.438394 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:20:58.438798 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:20:58.439115 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:20:58.439748 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:20:58.441809 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:20:58.445935 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:20:58.446962 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:20:58.448163 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:20:58.452778 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:20:58.454108 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:20:58.456169 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:20:58.459596 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:20:58.464308 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:20:58.570870 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
19:20:58.577274 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
19:20:58.599919 [info ] [MainThread]: Manifest loaded
19:20:58.600223 [info ] [MainThread]: Manifest checked
19:20:58.600434 [info ] [MainThread]: Flat graph built
19:20:58.600552 [info ] [MainThread]: Manifest loaded
19:20:58.600847 [info ] [MainThread]: Performance info: target/perf_info.json
19:20:58.600966 [info ] [MainThread]: Done.
19:20:58.601119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12173d9a0>]}


============================== 2022-05-26 19:23:22.928279 | 2c14607a-9759-4ca3-b7d3-0ff745ecab81 ==============================
19:23:22.928301 [info ] [MainThread]: Running with dbt=1.1.0
19:23:22.928782 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
19:23:22.928888 [debug] [MainThread]: Tracking: tracking
19:23:22.942330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691adf0>]}
19:23:22.959493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:23:22.959621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:23:22.962439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c14607a-9759-4ca3-b7d3-0ff745ecab81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad50d0>]}
19:23:22.965080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c14607a-9759-4ca3-b7d3-0ff745ecab81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63eb0>]}
19:23:22.965269 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:23:22.965404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c14607a-9759-4ca3-b7d3-0ff745ecab81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63f40>]}
19:23:22.965774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a63a90>]}


============================== 2022-05-26 19:45:25.287761 | 519c935a-1e7b-4fbc-b623-9154378e5e3f ==============================
19:45:25.287766 [info ] [MainThread]: Running with dbt=1.1.0
19:45:25.287980 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
19:45:25.288056 [debug] [MainThread]: Tracking: tracking
19:45:25.308622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c054c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c07490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c07820>]}
19:45:25.347094 [debug] [MainThread]: Executing "git --help"
19:45:25.352442 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
19:45:25.352892 [debug] [MainThread]: STDERR: "b''"
19:45:25.355576 [debug] [MainThread]: Acquiring new postgres connection "debug"
19:45:25.356029 [debug] [MainThread]: Using postgres connection "debug"
19:45:25.356127 [debug] [MainThread]: On debug: select 1 as id
19:45:25.356207 [debug] [MainThread]: Opening a new connection, currently in state init
19:45:25.397307 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
19:45:25.398634 [debug] [MainThread]: On debug: Close
19:45:25.398950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f710d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f718b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f71dc0>]}
19:45:25.666891 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-26 19:58:31.140586 | 2b1afe57-5da5-41be-8d11-adc6b276eae4 ==============================
19:58:31.140608 [info ] [MainThread]: Running with dbt=1.1.0
19:58:31.141122 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:58:31.141220 [debug] [MainThread]: Tracking: tracking
19:58:31.156350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122dbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f4070>]}
19:58:31.166747 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:58:31.166978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b1afe57-5da5-41be-8d11-adc6b276eae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c4100>]}
19:58:31.172987 [debug] [MainThread]: Parsing macros/catalog.sql
19:58:31.174508 [debug] [MainThread]: Parsing macros/relations.sql
19:58:31.175181 [debug] [MainThread]: Parsing macros/adapters.sql
19:58:31.186537 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:58:31.187429 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:58:31.189164 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:58:31.190272 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:58:31.191039 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:58:31.199228 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:58:31.205864 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:58:31.211345 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:58:31.213402 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:58:31.214221 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:58:31.215017 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:58:31.217020 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:58:31.225164 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:58:31.225863 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:58:31.230915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:58:31.238694 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:58:31.242642 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:58:31.243995 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:58:31.247598 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:58:31.248193 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:58:31.249437 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:58:31.250448 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:58:31.253224 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:58:31.261064 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:58:31.261718 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:58:31.262799 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:58:31.263486 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:58:31.263882 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:58:31.264233 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:58:31.264532 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:58:31.265156 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:58:31.267125 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:58:31.271001 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:58:31.271932 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:58:31.273101 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:58:31.277474 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:58:31.278752 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:58:31.280693 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:58:31.284418 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:58:31.289053 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:58:31.393743 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
19:58:31.406523 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
19:58:31.415068 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.demo_data_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which was not found
19:58:31.415205 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.demo_data_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' which was not found
19:58:31.421634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b1afe57-5da5-41be-8d11-adc6b276eae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ada30>]}
19:58:31.423825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b1afe57-5da5-41be-8d11-adc6b276eae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e47c0>]}
19:58:31.423954 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:58:31.424079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1afe57-5da5-41be-8d11-adc6b276eae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122dbee0>]}
19:58:31.424590 [info ] [MainThread]: 
19:58:31.424797 [debug] [MainThread]: Acquiring new postgres connection "master"
19:58:31.425125 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
19:58:31.429710 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
19:58:31.429832 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
19:58:31.429899 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:58:31.479922 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
19:58:31.480857 [debug] [ThreadPool]: On list_demo_destination: Close
19:58:31.481442 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
19:58:31.484644 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
19:58:31.484744 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
19:58:31.484820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:58:31.516600 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
19:58:31.516792 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
19:58:31.516878 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:58:31.539444 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.02 seconds
19:58:31.540350 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
19:58:31.540675 [debug] [ThreadPool]: On list_demo_destination_public: Close
19:58:31.543432 [debug] [MainThread]: Using postgres connection "master"
19:58:31.543624 [debug] [MainThread]: On master: BEGIN
19:58:31.543831 [debug] [MainThread]: Opening a new connection, currently in state init
19:58:31.546999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:58:31.547177 [debug] [MainThread]: Using postgres connection "master"
19:58:31.547277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:58:31.550571 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
19:58:31.551604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1afe57-5da5-41be-8d11-adc6b276eae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112550f10>]}
19:58:31.551845 [debug] [MainThread]: On master: ROLLBACK
19:58:31.552117 [debug] [MainThread]: Using postgres connection "master"
19:58:31.552243 [debug] [MainThread]: On master: BEGIN
19:58:31.552549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:58:31.552664 [debug] [MainThread]: On master: COMMIT
19:58:31.552758 [debug] [MainThread]: Using postgres connection "master"
19:58:31.552841 [debug] [MainThread]: On master: COMMIT
19:58:31.553031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:31.553137 [debug] [MainThread]: On master: Close
19:58:31.553357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
19:58:31.553540 [info ] [MainThread]: 
19:58:31.564956 [debug] [Thread-1  ]: Began running node model.demo_data_project.my_first_dbt_model
19:58:31.565170 [info ] [Thread-1  ]: 1 of 1 START table model public.my_first_dbt_model ............................. [RUN]
19:58:31.565442 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.my_first_dbt_model"
19:58:31.565529 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.my_first_dbt_model
19:58:31.565609 [debug] [Thread-1  ]: Compiling model.demo_data_project.my_first_dbt_model
19:58:31.566982 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.my_first_dbt_model"
19:58:31.567390 [debug] [Thread-1  ]: finished collecting timing info
19:58:31.567479 [debug] [Thread-1  ]: Began executing node model.demo_data_project.my_first_dbt_model
19:58:31.582024 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.my_first_dbt_model"
19:58:31.582588 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.my_first_dbt_model"
19:58:31.582670 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: BEGIN
19:58:31.582742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:31.592703 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:58:31.592809 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.my_first_dbt_model"
19:58:31.592879 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.my_first_dbt_model"} */


  create  table "demo_destination"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:58:31.595829 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:58:31.599084 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.my_first_dbt_model"
19:58:31.599184 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.my_first_dbt_model"} */
alter table "demo_destination"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:58:31.599784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:58:31.604990 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: COMMIT
19:58:31.605103 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.my_first_dbt_model"
19:58:31.605185 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: COMMIT
19:58:31.606593 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:58:31.608802 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.my_first_dbt_model"
19:58:31.608900 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.my_first_dbt_model"} */
drop table if exists "demo_destination"."public"."my_first_dbt_model__dbt_backup" cascade
19:58:31.609378 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:58:31.609921 [debug] [Thread-1  ]: finished collecting timing info
19:58:31.610017 [debug] [Thread-1  ]: On model.demo_data_project.my_first_dbt_model: Close
19:58:31.610231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1afe57-5da5-41be-8d11-adc6b276eae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130b0d90>]}
19:58:31.610412 [info ] [Thread-1  ]: 1 of 1 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.04s]
19:58:31.610629 [debug] [Thread-1  ]: Finished running node model.demo_data_project.my_first_dbt_model
19:58:31.611228 [debug] [MainThread]: Acquiring new postgres connection "master"
19:58:31.611355 [debug] [MainThread]: Using postgres connection "master"
19:58:31.611429 [debug] [MainThread]: On master: BEGIN
19:58:31.611496 [debug] [MainThread]: Opening a new connection, currently in state closed
19:58:31.615001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:58:31.615126 [debug] [MainThread]: On master: COMMIT
19:58:31.615192 [debug] [MainThread]: Using postgres connection "master"
19:58:31.615258 [debug] [MainThread]: On master: COMMIT
19:58:31.615397 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:58:31.615472 [debug] [MainThread]: On master: Close
19:58:31.615636 [info ] [MainThread]: 
19:58:31.615759 [info ] [MainThread]: Finished running 1 table model in 0.19s.
19:58:31.615874 [debug] [MainThread]: Connection 'master' was properly closed.
19:58:31.615933 [debug] [MainThread]: Connection 'model.demo_data_project.my_first_dbt_model' was properly closed.
19:58:31.618282 [info ] [MainThread]: 
19:58:31.618430 [info ] [MainThread]: [32mCompleted successfully[0m
19:58:31.618572 [info ] [MainThread]: 
19:58:31.618681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
19:58:31.618832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251da00>]}


============================== 2022-05-27 13:37:37.335346 | 06694b1a-0beb-4ac2-b25a-8f2c9b61e81c ==============================
13:37:37.335371 [info ] [MainThread]: Running with dbt=1.1.0
13:37:37.335933 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:37:37.336038 [debug] [MainThread]: Tracking: tracking
13:37:37.353722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12265abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12265acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12265ad00>]}
13:37:37.373316 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 6 files added, 0 files changed.
13:37:37.373560 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/staging/stg_users.sql
13:37:37.373704 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/staging/stg_payments.sql
13:37:37.373795 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/staging/stg_accounts.sql
13:37:37.373879 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/staging/stg_plans.sql
13:37:37.373960 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/staging/stg_purchases.sql
13:37:37.374042 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/customers.sql
13:37:37.374138 [debug] [MainThread]: Partial parsing: deleted file: demo_data_project://models/example/my_first_dbt_model.sql
13:37:37.381577 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
13:37:37.388222 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
13:37:37.389386 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_accounts.sql
13:37:37.390453 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_plans.sql
13:37:37.391487 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_purchases.sql
13:37:37.393023 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
13:37:37.395731 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

13:37:37.398400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228550d0>]}
13:37:37.401365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227d0f10>]}
13:37:37.401514 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
13:37:37.401651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227d0fa0>]}
13:37:37.402380 [info ] [MainThread]: 
13:37:37.402616 [debug] [MainThread]: Acquiring new postgres connection "master"
13:37:37.403120 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
13:37:37.407971 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
13:37:37.408089 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
13:37:37.408159 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:37:37.443397 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
13:37:37.444355 [debug] [ThreadPool]: On list_demo_destination: Close
13:37:37.445085 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
13:37:37.468157 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
13:37:37.468312 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
13:37:37.468380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:37:37.473363 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
13:37:37.473444 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
13:37:37.473504 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
13:37:37.479803 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
13:37:37.480396 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
13:37:37.480641 [debug] [ThreadPool]: On list_demo_destination_public: Close
13:37:37.482640 [debug] [MainThread]: Using postgres connection "master"
13:37:37.482731 [debug] [MainThread]: On master: BEGIN
13:37:37.482796 [debug] [MainThread]: Opening a new connection, currently in state init
13:37:37.487002 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:37:37.487081 [debug] [MainThread]: Using postgres connection "master"
13:37:37.487146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:37:37.502633 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
13:37:37.503266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12263a250>]}
13:37:37.503421 [debug] [MainThread]: On master: ROLLBACK
13:37:37.503641 [debug] [MainThread]: Using postgres connection "master"
13:37:37.503717 [debug] [MainThread]: On master: BEGIN
13:37:37.504021 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:37:37.504099 [debug] [MainThread]: On master: COMMIT
13:37:37.504169 [debug] [MainThread]: Using postgres connection "master"
13:37:37.504233 [debug] [MainThread]: On master: COMMIT
13:37:37.504398 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:37:37.504487 [debug] [MainThread]: On master: Close
13:37:37.504644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:37:37.504781 [info ] [MainThread]: 
13:37:37.506880 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
13:37:37.507022 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
13:37:37.507239 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
13:37:37.507323 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
13:37:37.507401 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
13:37:37.508049 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
13:37:37.508511 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.508594 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
13:37:37.519852 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
13:37:37.520225 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
13:37:37.520303 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
13:37:37.520368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:37.526836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
13:37:37.526949 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
13:37:37.527014 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from accounts
  );
13:37:37.528703 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "accounts" does not exist
LINE 12: from accounts
              ^

13:37:37.528782 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: ROLLBACK
13:37:37.529043 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.529125 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
13:37:37.529280 [debug] [Thread-1  ]: Database Error in model stg_accounts (models/staging/stg_accounts.sql)
  relation "accounts" does not exist
  LINE 12: from accounts
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_accounts.sql
13:37:37.529414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120daddc0>]}
13:37:37.529584 [error] [Thread-1  ]: 1 of 6 ERROR creating view model public.stg_accounts ........................... [[31mERROR[0m in 0.02s]
13:37:37.529781 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
13:37:37.529869 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
13:37:37.530030 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
13:37:37.530266 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
13:37:37.530358 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
13:37:37.530435 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
13:37:37.531106 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
13:37:37.531357 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.531430 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
13:37:37.532390 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
13:37:37.532558 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
13:37:37.532634 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
13:37:37.532693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:37.537961 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
13:37:37.538076 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
13:37:37.538146 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from payments
  );
13:37:37.538603 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "payments" does not exist
LINE 10: from payments
              ^

13:37:37.538691 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: ROLLBACK
13:37:37.538926 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.539008 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
13:37:37.539155 [debug] [Thread-1  ]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "payments" does not exist
  LINE 10: from payments
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_payments.sql
13:37:37.539271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228ad0a0>]}
13:37:37.539421 [error] [Thread-1  ]: 2 of 6 ERROR creating view model public.stg_payments ........................... [[31mERROR[0m in 0.01s]
13:37:37.539598 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
13:37:37.539686 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
13:37:37.539837 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
13:37:37.540046 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
13:37:37.540120 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
13:37:37.540192 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
13:37:37.540794 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
13:37:37.541019 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.541091 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
13:37:37.542069 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
13:37:37.542287 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
13:37:37.542354 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
13:37:37.542414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:37.546004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
13:37:37.546119 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
13:37:37.546182 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from plans
  );
13:37:37.546496 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "plans" does not exist
LINE 9: from plans
             ^

13:37:37.546567 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: ROLLBACK
13:37:37.546741 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.546809 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
13:37:37.546962 [debug] [Thread-1  ]: Database Error in model stg_plans (models/staging/stg_plans.sql)
  relation "plans" does not exist
  LINE 9: from plans
               ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_plans.sql
13:37:37.547094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228c9550>]}
13:37:37.547254 [error] [Thread-1  ]: 3 of 6 ERROR creating view model public.stg_plans .............................. [[31mERROR[0m in 0.01s]
13:37:37.547424 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
13:37:37.547506 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
13:37:37.547682 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
13:37:37.547866 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
13:37:37.547935 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
13:37:37.547999 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
13:37:37.548627 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
13:37:37.548882 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.548955 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
13:37:37.549901 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
13:37:37.550070 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
13:37:37.550133 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
13:37:37.550192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:37.553528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
13:37:37.553627 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
13:37:37.553693 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from purchases
  );
13:37:37.553970 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "purchases" does not exist
LINE 13: from purchases
              ^

13:37:37.554051 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: ROLLBACK
13:37:37.554229 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.554297 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
13:37:37.554429 [debug] [Thread-1  ]: Database Error in model stg_purchases (models/staging/stg_purchases.sql)
  relation "purchases" does not exist
  LINE 13: from purchases
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_purchases.sql
13:37:37.554535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228e2c40>]}
13:37:37.554672 [error] [Thread-1  ]: 4 of 6 ERROR creating view model public.stg_purchases .......................... [[31mERROR[0m in 0.01s]
13:37:37.554836 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
13:37:37.554914 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
13:37:37.555044 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
13:37:37.555225 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
13:37:37.555294 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
13:37:37.555358 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
13:37:37.556609 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
13:37:37.556893 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.556998 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
13:37:37.558040 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
13:37:37.558286 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
13:37:37.558357 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
13:37:37.558417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:37:37.561989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
13:37:37.562071 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
13:37:37.562131 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from users
  );
13:37:37.562505 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: from users
              ^

13:37:37.562597 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: ROLLBACK
13:37:37.562780 [debug] [Thread-1  ]: finished collecting timing info
13:37:37.562856 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
13:37:37.562985 [debug] [Thread-1  ]: Database Error in model stg_users (models/staging/stg_users.sql)
  relation "users" does not exist
  LINE 14: from users
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_users.sql
13:37:37.563094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06694b1a-0beb-4ac2-b25a-8f2c9b61e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227a29a0>]}
13:37:37.563237 [error] [Thread-1  ]: 5 of 6 ERROR creating view model public.stg_users .............................. [[31mERROR[0m in 0.01s]
13:37:37.563406 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
13:37:37.563488 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
13:37:37.563597 [info ] [Thread-1  ]: 6 of 6 SKIP relation public.customers .......................................... [[33mSKIP[0m]
13:37:37.563747 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
13:37:37.564166 [debug] [MainThread]: Acquiring new postgres connection "master"
13:37:37.564259 [debug] [MainThread]: Using postgres connection "master"
13:37:37.564325 [debug] [MainThread]: On master: BEGIN
13:37:37.564384 [debug] [MainThread]: Opening a new connection, currently in state closed
13:37:37.567598 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:37:37.567685 [debug] [MainThread]: On master: COMMIT
13:37:37.567747 [debug] [MainThread]: Using postgres connection "master"
13:37:37.567805 [debug] [MainThread]: On master: COMMIT
13:37:37.567929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:37:37.567992 [debug] [MainThread]: On master: Close
13:37:37.568138 [info ] [MainThread]: 
13:37:37.568254 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.17s.
13:37:37.568363 [debug] [MainThread]: Connection 'master' was properly closed.
13:37:37.568420 [debug] [MainThread]: Connection 'model.demo_data_project.stg_users' was properly closed.
13:37:37.570598 [info ] [MainThread]: 
13:37:37.570735 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
13:37:37.570858 [info ] [MainThread]: 
13:37:37.570963 [error] [MainThread]: [33mDatabase Error in model stg_accounts (models/staging/stg_accounts.sql)[0m
13:37:37.571065 [error] [MainThread]:   relation "accounts" does not exist
13:37:37.571166 [error] [MainThread]:   LINE 12: from accounts
13:37:37.571271 [error] [MainThread]:                 ^
13:37:37.571368 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_accounts.sql
13:37:37.571466 [info ] [MainThread]: 
13:37:37.571566 [error] [MainThread]: [33mDatabase Error in model stg_payments (models/staging/stg_payments.sql)[0m
13:37:37.571665 [error] [MainThread]:   relation "payments" does not exist
13:37:37.571761 [error] [MainThread]:   LINE 10: from payments
13:37:37.571858 [error] [MainThread]:                 ^
13:37:37.571954 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_payments.sql
13:37:37.572051 [info ] [MainThread]: 
13:37:37.572149 [error] [MainThread]: [33mDatabase Error in model stg_plans (models/staging/stg_plans.sql)[0m
13:37:37.572248 [error] [MainThread]:   relation "plans" does not exist
13:37:37.572344 [error] [MainThread]:   LINE 9: from plans
13:37:37.572440 [error] [MainThread]:                ^
13:37:37.572535 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_plans.sql
13:37:37.572632 [info ] [MainThread]: 
13:37:37.572730 [error] [MainThread]: [33mDatabase Error in model stg_purchases (models/staging/stg_purchases.sql)[0m
13:37:37.572829 [error] [MainThread]:   relation "purchases" does not exist
13:37:37.572927 [error] [MainThread]:   LINE 13: from purchases
13:37:37.573023 [error] [MainThread]:                 ^
13:37:37.573119 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_purchases.sql
13:37:37.573216 [info ] [MainThread]: 
13:37:37.573314 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
13:37:37.573410 [error] [MainThread]:   relation "users" does not exist
13:37:37.573506 [error] [MainThread]:   LINE 14: from users
13:37:37.573602 [error] [MainThread]:                 ^
13:37:37.573698 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_users.sql
13:37:37.573799 [info ] [MainThread]: 
13:37:37.573898 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=1 TOTAL=6
13:37:37.574038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207f4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12074e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122645bb0>]}


============================== 2022-05-27 14:03:20.048934 | 1d0d4c06-6c08-41f5-a010-7a83edde331f ==============================
14:03:20.048949 [info ] [MainThread]: Running with dbt=1.1.0
14:03:20.049349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:03:20.049439 [debug] [MainThread]: Tracking: tracking
14:03:20.066220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134dbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134dbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134dbf10>]}
14:03:20.084588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:03:20.084725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:03:20.084972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:03:20.088098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11368a0d0>]}
14:03:20.090686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113625430>]}
14:03:20.090861 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:03:20.090997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136254c0>]}
14:03:20.091769 [info ] [MainThread]: 
14:03:20.092015 [debug] [MainThread]: Acquiring new postgres connection "master"
14:03:20.092567 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:03:20.097077 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:03:20.097169 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:03:20.097241 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:03:20.127246 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:03:20.128155 [debug] [ThreadPool]: On list_demo_destination: Close
14:03:20.128768 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:03:20.131685 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:03:20.131801 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:03:20.131872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:03:20.135423 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:03:20.135529 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:03:20.135600 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:03:20.139131 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
14:03:20.139737 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:03:20.139946 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:03:20.141972 [debug] [MainThread]: Using postgres connection "master"
14:03:20.142081 [debug] [MainThread]: On master: BEGIN
14:03:20.142168 [debug] [MainThread]: Opening a new connection, currently in state init
14:03:20.145588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:03:20.145769 [debug] [MainThread]: Using postgres connection "master"
14:03:20.145836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:03:20.185701 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
14:03:20.186365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ff850>]}
14:03:20.186534 [debug] [MainThread]: On master: ROLLBACK
14:03:20.186763 [debug] [MainThread]: Using postgres connection "master"
14:03:20.186847 [debug] [MainThread]: On master: BEGIN
14:03:20.187175 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:03:20.187268 [debug] [MainThread]: On master: COMMIT
14:03:20.187347 [debug] [MainThread]: Using postgres connection "master"
14:03:20.187416 [debug] [MainThread]: On master: COMMIT
14:03:20.187600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:03:20.187686 [debug] [MainThread]: On master: Close
14:03:20.187879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:03:20.188036 [info ] [MainThread]: 
14:03:20.191316 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:03:20.191522 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:03:20.191900 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:03:20.191995 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:03:20.192091 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:03:20.192833 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:03:20.193193 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.193294 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:03:20.205827 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:03:20.206208 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:20.206320 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:03:20.206399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:20.211890 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:03:20.212004 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:20.212072 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from accounts
  );
14:03:20.212476 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "accounts" does not exist
LINE 12: from accounts
              ^

14:03:20.212557 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: ROLLBACK
14:03:20.212769 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.212845 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:03:20.213008 [debug] [Thread-1  ]: Database Error in model stg_accounts (models/staging/stg_accounts.sql)
  relation "accounts" does not exist
  LINE 12: from accounts
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_accounts.sql
14:03:20.213133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11378f1c0>]}
14:03:20.213303 [error] [Thread-1  ]: 1 of 6 ERROR creating view model public.stg_accounts ........................... [[31mERROR[0m in 0.02s]
14:03:20.213500 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:03:20.213594 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:03:20.213758 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:03:20.213949 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:03:20.214016 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:03:20.214083 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:03:20.215189 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:03:20.215493 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.215571 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:03:20.236908 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:03:20.237277 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:20.237353 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:03:20.237415 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:20.260325 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:03:20.260500 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:20.260577 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from payments
  );
14:03:20.261009 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "payments" does not exist
LINE 10: from payments
              ^

14:03:20.261182 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: ROLLBACK
14:03:20.261436 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.261550 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:03:20.261749 [debug] [Thread-1  ]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "payments" does not exist
  LINE 10: from payments
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_payments.sql
14:03:20.261892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ca850>]}
14:03:20.262082 [error] [Thread-1  ]: 2 of 6 ERROR creating view model public.stg_payments ........................... [[31mERROR[0m in 0.05s]
14:03:20.262286 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:03:20.262378 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:03:20.262604 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:03:20.262955 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:03:20.263036 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:03:20.263109 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:03:20.263804 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:03:20.264108 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.264185 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:03:20.265216 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:03:20.265416 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:20.265486 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:03:20.265548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:20.269066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:20.269232 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:20.269304 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from plans
  );
14:03:20.269635 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "plans" does not exist
LINE 9: from plans
             ^

14:03:20.269716 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: ROLLBACK
14:03:20.269935 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.270018 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:03:20.270183 [debug] [Thread-1  ]: Database Error in model stg_plans (models/staging/stg_plans.sql)
  relation "plans" does not exist
  LINE 9: from plans
               ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_plans.sql
14:03:20.270315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bc580>]}
14:03:20.270496 [error] [Thread-1  ]: 3 of 6 ERROR creating view model public.stg_plans .............................. [[31mERROR[0m in 0.01s]
14:03:20.270689 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:03:20.270781 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:03:20.271020 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:03:20.271262 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:03:20.271345 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:03:20.271416 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:03:20.272151 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:03:20.272459 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.272540 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:03:20.273659 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:03:20.274055 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:20.274131 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:03:20.274194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:20.278480 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:20.278628 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:20.278694 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from purchases
  );
14:03:20.279007 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "purchases" does not exist
LINE 13: from purchases
              ^

14:03:20.279115 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: ROLLBACK
14:03:20.279332 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.279427 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:03:20.279589 [debug] [Thread-1  ]: Database Error in model stg_purchases (models/staging/stg_purchases.sql)
  relation "purchases" does not exist
  LINE 13: from purchases
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_purchases.sql
14:03:20.279717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113677fa0>]}
14:03:20.279885 [error] [Thread-1  ]: 4 of 6 ERROR creating view model public.stg_purchases .......................... [[31mERROR[0m in 0.01s]
14:03:20.280068 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:03:20.280156 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:03:20.280299 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:03:20.280488 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:03:20.280552 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:03:20.280620 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:03:20.281253 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:03:20.281503 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.281575 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:03:20.282641 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:03:20.282961 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:20.283036 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:03:20.283098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:20.286458 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:20.286568 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:20.286636 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from users
  );
14:03:20.286966 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "users" does not exist
LINE 14: from users
              ^

14:03:20.287056 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: ROLLBACK
14:03:20.287248 [debug] [Thread-1  ]: finished collecting timing info
14:03:20.287322 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:03:20.287476 [debug] [Thread-1  ]: Database Error in model stg_users (models/staging/stg_users.sql)
  relation "users" does not exist
  LINE 14: from users
                ^
  compiled SQL at target/run/demo_data_project/models/staging/stg_users.sql
14:03:20.287603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d0d4c06-6c08-41f5-a010-7a83edde331f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11349a280>]}
14:03:20.287756 [error] [Thread-1  ]: 5 of 6 ERROR creating view model public.stg_users .............................. [[31mERROR[0m in 0.01s]
14:03:20.287933 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:03:20.288017 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:03:20.288135 [info ] [Thread-1  ]: 6 of 6 SKIP relation public.customers .......................................... [[33mSKIP[0m]
14:03:20.288300 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:03:20.288760 [debug] [MainThread]: Acquiring new postgres connection "master"
14:03:20.288858 [debug] [MainThread]: Using postgres connection "master"
14:03:20.288921 [debug] [MainThread]: On master: BEGIN
14:03:20.288980 [debug] [MainThread]: Opening a new connection, currently in state closed
14:03:20.292450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:03:20.292538 [debug] [MainThread]: On master: COMMIT
14:03:20.292602 [debug] [MainThread]: Using postgres connection "master"
14:03:20.292662 [debug] [MainThread]: On master: COMMIT
14:03:20.292820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:03:20.292923 [debug] [MainThread]: On master: Close
14:03:20.293102 [info ] [MainThread]: 
14:03:20.293225 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.20s.
14:03:20.293370 [debug] [MainThread]: Connection 'master' was properly closed.
14:03:20.293445 [debug] [MainThread]: Connection 'model.demo_data_project.stg_users' was properly closed.
14:03:20.295838 [info ] [MainThread]: 
14:03:20.295981 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
14:03:20.296109 [info ] [MainThread]: 
14:03:20.296215 [error] [MainThread]: [33mDatabase Error in model stg_accounts (models/staging/stg_accounts.sql)[0m
14:03:20.296321 [error] [MainThread]:   relation "accounts" does not exist
14:03:20.296423 [error] [MainThread]:   LINE 12: from accounts
14:03:20.296523 [error] [MainThread]:                 ^
14:03:20.296619 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_accounts.sql
14:03:20.296718 [info ] [MainThread]: 
14:03:20.296822 [error] [MainThread]: [33mDatabase Error in model stg_payments (models/staging/stg_payments.sql)[0m
14:03:20.296920 [error] [MainThread]:   relation "payments" does not exist
14:03:20.297018 [error] [MainThread]:   LINE 10: from payments
14:03:20.297116 [error] [MainThread]:                 ^
14:03:20.297212 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_payments.sql
14:03:20.297310 [info ] [MainThread]: 
14:03:20.297408 [error] [MainThread]: [33mDatabase Error in model stg_plans (models/staging/stg_plans.sql)[0m
14:03:20.297506 [error] [MainThread]:   relation "plans" does not exist
14:03:20.297602 [error] [MainThread]:   LINE 9: from plans
14:03:20.297698 [error] [MainThread]:                ^
14:03:20.297795 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_plans.sql
14:03:20.297893 [info ] [MainThread]: 
14:03:20.297990 [error] [MainThread]: [33mDatabase Error in model stg_purchases (models/staging/stg_purchases.sql)[0m
14:03:20.298088 [error] [MainThread]:   relation "purchases" does not exist
14:03:20.298184 [error] [MainThread]:   LINE 13: from purchases
14:03:20.298279 [error] [MainThread]:                 ^
14:03:20.298374 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_purchases.sql
14:03:20.298471 [info ] [MainThread]: 
14:03:20.298568 [error] [MainThread]: [33mDatabase Error in model stg_users (models/staging/stg_users.sql)[0m
14:03:20.298705 [error] [MainThread]:   relation "users" does not exist
14:03:20.298809 [error] [MainThread]:   LINE 14: from users
14:03:20.298909 [error] [MainThread]:                 ^
14:03:20.299006 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/staging/stg_users.sql
14:03:20.299110 [info ] [MainThread]: 
14:03:20.299211 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=1 TOTAL=6
14:03:20.299357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113661f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ae5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a94c0>]}


============================== 2022-05-27 14:03:57.365680 | 2f708190-d5b1-43d6-9db4-75a62ade6f79 ==============================
14:03:57.365700 [info ] [MainThread]: Running with dbt=1.1.0
14:03:57.366164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:03:57.366268 [debug] [MainThread]: Tracking: tracking
14:03:57.382460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043dbf10>]}
14:03:57.398163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
14:03:57.398420 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/staging/stg_payments.sql
14:03:57.398552 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/staging/stg_users.sql
14:03:57.398670 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/staging/stg_plans.sql
14:03:57.398784 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/staging/stg_purchases.sql
14:03:57.398896 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/staging/stg_accounts.sql
14:03:57.405034 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_payments.sql
14:03:57.411704 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_users.sql
14:03:57.412834 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_plans.sql
14:03:57.413869 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_purchases.sql
14:03:57.414911 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_accounts.sql
14:03:57.417508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:03:57.419813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e60d0>]}
14:03:57.422132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466ee20>]}
14:03:57.422270 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:03:57.422404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466ee80>]}
14:03:57.423200 [info ] [MainThread]: 
14:03:57.423501 [debug] [MainThread]: Acquiring new postgres connection "master"
14:03:57.423982 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:03:57.428922 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:03:57.429074 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:03:57.429150 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:03:57.455101 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:03:57.456044 [debug] [ThreadPool]: On list_demo_destination: Close
14:03:57.456725 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:03:57.479956 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:03:57.480117 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:03:57.480187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:03:57.485236 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:03:57.485350 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:03:57.485417 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:03:57.490835 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
14:03:57.491389 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:03:57.492092 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:03:57.493944 [debug] [MainThread]: Using postgres connection "master"
14:03:57.494042 [debug] [MainThread]: On master: BEGIN
14:03:57.494105 [debug] [MainThread]: Opening a new connection, currently in state init
14:03:57.500304 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:03:57.500391 [debug] [MainThread]: Using postgres connection "master"
14:03:57.500459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:03:57.525411 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
14:03:57.526090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a8d60>]}
14:03:57.526260 [debug] [MainThread]: On master: ROLLBACK
14:03:57.526445 [debug] [MainThread]: Using postgres connection "master"
14:03:57.526527 [debug] [MainThread]: On master: BEGIN
14:03:57.526780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:03:57.526863 [debug] [MainThread]: On master: COMMIT
14:03:57.526939 [debug] [MainThread]: Using postgres connection "master"
14:03:57.527005 [debug] [MainThread]: On master: COMMIT
14:03:57.527153 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:03:57.527234 [debug] [MainThread]: On master: Close
14:03:57.527394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:03:57.527539 [info ] [MainThread]: 
14:03:57.529181 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:03:57.529337 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:03:57.529575 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:03:57.529661 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:03:57.529744 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:03:57.530437 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:03:57.530756 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.530845 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:03:57.541990 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:03:57.542351 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:57.542432 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:03:57.542496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:57.546292 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:57.546422 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:57.546490 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:03:57.549726 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:03:57.552793 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:57.552916 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:03:57.553493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:03:57.556950 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:03:57.557111 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:57.557187 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:03:57.557970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:03:57.560350 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:03:57.560449 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:03:57.560701 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:03:57.561242 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.561337 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:03:57.561543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103083220>]}
14:03:57.561713 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:03:57.561904 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:03:57.561993 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:03:57.562141 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:03:57.562349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:03:57.562428 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:03:57.562498 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:03:57.563114 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:03:57.563387 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.563469 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:03:57.564444 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:03:57.564644 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:57.564711 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:03:57.564775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:57.568667 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:57.568765 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:57.568830 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:03:57.570395 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:03:57.571719 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:57.571818 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:03:57.572190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:03:57.572790 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:03:57.572866 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:57.572932 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:03:57.573797 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:03:57.575401 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:03:57.575518 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:03:57.575826 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:03:57.576384 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.576480 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:03:57.576674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478ff70>]}
14:03:57.576843 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:03:57.577032 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:03:57.577122 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:03:57.577261 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:03:57.577469 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:03:57.577552 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:03:57.577622 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:03:57.578169 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:03:57.578473 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.578546 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:03:57.579548 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:03:57.579733 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:57.579801 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:03:57.579860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:57.583491 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:57.583582 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:57.583644 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:03:57.585803 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:03:57.587114 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:57.587222 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:03:57.587492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:03:57.588044 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:03:57.588120 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:57.588181 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:03:57.588998 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:03:57.589697 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:03:57.589767 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:03:57.590049 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:03:57.590532 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.590620 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:03:57.590815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047807c0>]}
14:03:57.590990 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
14:03:57.591193 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:03:57.591297 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:03:57.591496 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:03:57.591696 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:03:57.591774 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:03:57.591844 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:03:57.592461 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:03:57.592782 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.592914 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:03:57.593999 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:03:57.594251 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:57.594321 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:03:57.594380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:57.598038 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:57.598168 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:57.598233 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:03:57.601621 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:03:57.602847 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:57.602956 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:03:57.603579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:03:57.604179 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:03:57.604256 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:57.604321 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:03:57.604875 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:03:57.605637 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:03:57.605715 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:03:57.605975 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:03:57.606454 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.606585 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:03:57.606772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104787820>]}
14:03:57.607043 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:03:57.607238 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:03:57.607333 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:03:57.607520 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:03:57.607765 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:03:57.607855 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:03:57.607928 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:03:57.608605 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:03:57.608916 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.608993 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:03:57.610050 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:03:57.610259 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:57.610332 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:03:57.610395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:57.613959 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:57.614071 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:57.614138 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:03:57.617447 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:03:57.618673 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:57.618753 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:03:57.619245 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:03:57.619813 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:03:57.619908 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:57.619969 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:03:57.620806 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:03:57.621560 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:03:57.621648 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:03:57.621940 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:03:57.622421 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.622510 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:03:57.622701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104395280>]}
14:03:57.622885 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.01s]
14:03:57.623074 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:03:57.623167 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:03:57.623323 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:03:57.623556 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:03:57.623639 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:03:57.623713 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:03:57.625240 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:03:57.625596 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.625683 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:03:57.636297 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:03:57.636662 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:03:57.636734 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:03:57.636794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:57.641385 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:03:57.641483 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:03:57.641544 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
)

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
)

lifetime_value as (
    SELECT sum(payments.amount) WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id;
)

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)
  );
14:03:57.642199 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "plans"
LINE 16: plans as (
         ^

14:03:57.642284 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:03:57.642535 [debug] [Thread-1  ]: finished collecting timing info
14:03:57.642607 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:03:57.642752 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "plans"
  LINE 16: plans as (
           ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:03:57.642872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f708190-d5b1-43d6-9db4-75a62ade6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ee1c0>]}
14:03:57.643034 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:03:57.643222 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:03:57.643716 [debug] [MainThread]: Acquiring new postgres connection "master"
14:03:57.643823 [debug] [MainThread]: Using postgres connection "master"
14:03:57.643891 [debug] [MainThread]: On master: BEGIN
14:03:57.643951 [debug] [MainThread]: Opening a new connection, currently in state closed
14:03:57.647937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:03:57.648074 [debug] [MainThread]: On master: COMMIT
14:03:57.648154 [debug] [MainThread]: Using postgres connection "master"
14:03:57.648217 [debug] [MainThread]: On master: COMMIT
14:03:57.648385 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:03:57.648453 [debug] [MainThread]: On master: Close
14:03:57.648623 [info ] [MainThread]: 
14:03:57.648749 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.23s.
14:03:57.648864 [debug] [MainThread]: Connection 'master' was properly closed.
14:03:57.648923 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:03:57.651293 [info ] [MainThread]: 
14:03:57.651427 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:03:57.651544 [info ] [MainThread]: 
14:03:57.651649 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:03:57.651755 [error] [MainThread]:   syntax error at or near "plans"
14:03:57.651854 [error] [MainThread]:   LINE 16: plans as (
14:03:57.651952 [error] [MainThread]:            ^
14:03:57.652051 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:03:57.652157 [info ] [MainThread]: 
14:03:57.652260 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:03:57.652404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043badc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ee6d0>]}


============================== 2022-05-27 14:04:26.575056 | 4856a680-1894-4728-815b-2467cdd3a3e5 ==============================
14:04:26.575072 [info ] [MainThread]: Running with dbt=1.1.0
14:04:26.575428 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:04:26.575519 [debug] [MainThread]: Tracking: tracking
14:04:26.591059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105918ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105918dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105918df0>]}
14:04:26.606433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:04:26.606702 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:04:26.613035 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:04:26.620111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:04:26.622436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1b0d0>]}
14:04:26.624761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbde50>]}
14:04:26.624896 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:04:26.625026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbdee0>]}
14:04:26.625748 [info ] [MainThread]: 
14:04:26.625965 [debug] [MainThread]: Acquiring new postgres connection "master"
14:04:26.626427 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:04:26.631025 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:04:26.631200 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:04:26.631275 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:04:26.655413 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:04:26.656376 [debug] [ThreadPool]: On list_demo_destination: Close
14:04:26.656986 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:04:26.680065 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:04:26.680223 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:04:26.680293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:04:26.686362 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:04:26.686445 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:04:26.686502 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:04:26.691724 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:04:26.692430 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:04:26.692673 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:04:26.694816 [debug] [MainThread]: Using postgres connection "master"
14:04:26.694908 [debug] [MainThread]: On master: BEGIN
14:04:26.694977 [debug] [MainThread]: Opening a new connection, currently in state init
14:04:26.698974 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:26.699067 [debug] [MainThread]: Using postgres connection "master"
14:04:26.699137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:04:26.723792 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
14:04:26.724528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d790>]}
14:04:26.724694 [debug] [MainThread]: On master: ROLLBACK
14:04:26.724916 [debug] [MainThread]: Using postgres connection "master"
14:04:26.724998 [debug] [MainThread]: On master: BEGIN
14:04:26.725306 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:26.725385 [debug] [MainThread]: On master: COMMIT
14:04:26.725461 [debug] [MainThread]: Using postgres connection "master"
14:04:26.725533 [debug] [MainThread]: On master: COMMIT
14:04:26.725709 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:04:26.725791 [debug] [MainThread]: On master: Close
14:04:26.725960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:04:26.726104 [info ] [MainThread]: 
14:04:26.727904 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:04:26.728087 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:04:26.728336 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:04:26.728428 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:04:26.728509 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:04:26.729278 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:04:26.729627 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.729720 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:04:26.741263 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:04:26.741647 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:26.741723 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:04:26.741789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:26.744503 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:26.744619 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:26.744696 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:04:26.745606 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:26.748714 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:26.748799 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:04:26.749166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.750206 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:26.750284 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:04:26.750514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.753496 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:04:26.753597 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:26.753665 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:04:26.754226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:26.756249 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:26.756331 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:04:26.757835 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:26.758328 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.758421 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:04:26.758607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ef130>]}
14:04:26.758769 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:04:26.758955 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:04:26.759044 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:04:26.759191 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:04:26.759388 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:04:26.759462 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:04:26.759532 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:04:26.760124 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:04:26.760383 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.760458 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:04:26.761434 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:04:26.761624 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:26.761690 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:04:26.761749 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:26.765235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:26.765368 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:26.765430 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:04:26.767424 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:26.768581 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:26.768663 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:04:26.769010 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.769891 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:26.769962 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:04:26.770279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.771628 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:04:26.771700 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:26.771757 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:04:26.772162 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:26.772779 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:26.772859 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:04:26.773881 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:26.774356 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.774440 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:04:26.774616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105578820>]}
14:04:26.774772 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:04:26.774953 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:04:26.775044 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:04:26.775139 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:04:26.775321 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:04:26.775390 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:04:26.775465 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:04:26.776120 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:04:26.776470 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.776581 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:04:26.777684 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:04:26.777897 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:26.777969 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:04:26.778029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:26.781883 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:26.781997 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:26.782063 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:04:26.784588 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:26.785798 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:26.785876 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:04:26.786364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.787282 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:26.787351 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:04:26.787675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.788165 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:04:26.788229 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:26.788287 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:04:26.788936 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:26.789579 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:26.789644 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:04:26.790727 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:26.791213 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.791301 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:04:26.791503 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3760>]}
14:04:26.791711 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:04:26.791911 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:04:26.792008 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:04:26.792168 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:04:26.792414 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:04:26.792500 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:04:26.792569 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:04:26.793209 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:04:26.793492 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.793563 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:04:26.794550 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:04:26.794741 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:26.794804 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:04:26.794860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:26.798939 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:26.799030 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:26.799096 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:04:26.801775 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:26.802830 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:26.802908 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:04:26.803270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.804174 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:26.804243 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:04:26.804568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.805133 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:04:26.805205 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:26.805266 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:04:26.805757 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:26.806439 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:26.806510 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:04:26.807649 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:26.808123 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.808204 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:04:26.808362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d09c70>]}
14:04:26.808500 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:04:26.808668 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:04:26.808751 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:04:26.808846 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:04:26.809016 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:04:26.809114 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:04:26.809187 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:04:26.809685 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:04:26.809923 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.809999 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:04:26.811017 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:04:26.811301 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:26.811370 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:04:26.811429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:26.816504 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:04:26.816618 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:26.816677 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:04:26.819991 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:26.821093 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:26.821168 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:04:26.821693 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.823284 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:26.823355 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:04:26.823806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:26.824347 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:04:26.824419 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:26.824479 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:04:26.824919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:26.825643 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:26.825712 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:04:26.827549 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:26.828035 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.828133 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:04:26.828318 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0b9d0>]}
14:04:26.828473 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:04:26.828651 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:04:26.828737 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:04:26.828874 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:04:26.829063 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:04:26.829132 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:04:26.829199 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:04:26.830566 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:04:26.830865 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.830937 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:04:26.840514 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:04:26.840781 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:04:26.840849 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:04:26.840906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:26.845125 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:26.845221 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:04:26.845290 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id;
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)
  );
14:04:26.845576 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: ...unt_id === accounts.account_id GROUP BY accounts.account_id;
                                                                       ^

14:04:26.845669 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:04:26.845885 [debug] [Thread-1  ]: finished collecting timing info
14:04:26.845980 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:04:26.846121 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near ";"
  LINE 21: ...unt_id === accounts.account_id GROUP BY accounts.account_id;
                                                                         ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:04:26.846228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4856a680-1894-4728-815b-2467cdd3a3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3bb0>]}
14:04:26.846370 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:04:26.846544 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:04:26.846993 [debug] [MainThread]: Acquiring new postgres connection "master"
14:04:26.847091 [debug] [MainThread]: Using postgres connection "master"
14:04:26.847155 [debug] [MainThread]: On master: BEGIN
14:04:26.847211 [debug] [MainThread]: Opening a new connection, currently in state closed
14:04:26.851329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:26.851406 [debug] [MainThread]: On master: COMMIT
14:04:26.851463 [debug] [MainThread]: Using postgres connection "master"
14:04:26.851517 [debug] [MainThread]: On master: COMMIT
14:04:26.851686 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:04:26.851747 [debug] [MainThread]: On master: Close
14:04:26.851885 [info ] [MainThread]: 
14:04:26.851996 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.23s.
14:04:26.852113 [debug] [MainThread]: Connection 'master' was properly closed.
14:04:26.852169 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:04:26.854236 [info ] [MainThread]: 
14:04:26.854364 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:04:26.854483 [info ] [MainThread]: 
14:04:26.854587 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:04:26.854693 [error] [MainThread]:   syntax error at or near ";"
14:04:26.854792 [error] [MainThread]:   LINE 21: ...unt_id === accounts.account_id GROUP BY accounts.account_id;
14:04:26.854888 [error] [MainThread]:                                                                          ^
14:04:26.854982 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:04:26.855084 [info ] [MainThread]: 
14:04:26.855182 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:04:26.855316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105900040>]}


============================== 2022-05-27 14:04:36.453806 | 44556e84-67a8-4a75-b12d-a0378278d99f ==============================
14:04:36.453825 [info ] [MainThread]: Running with dbt=1.1.0
14:04:36.454241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:04:36.454349 [debug] [MainThread]: Tracking: tracking
14:04:36.468170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddac70>]}
14:04:36.483761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:04:36.484015 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:04:36.489993 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:04:36.497542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:04:36.500027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc80d0>]}
14:04:36.502446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f68eb0>]}
14:04:36.502592 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:04:36.502721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc8b50>]}
14:04:36.503422 [info ] [MainThread]: 
14:04:36.503664 [debug] [MainThread]: Acquiring new postgres connection "master"
14:04:36.504126 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:04:36.508705 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:04:36.508862 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:04:36.508962 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:04:36.520281 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:04:36.521206 [debug] [ThreadPool]: On list_demo_destination: Close
14:04:36.521816 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:04:36.544630 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:04:36.544805 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:04:36.544870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:04:36.548804 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:04:36.548895 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:04:36.548959 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:04:36.552479 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:04:36.553064 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:04:36.553261 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:04:36.555122 [debug] [MainThread]: Using postgres connection "master"
14:04:36.555214 [debug] [MainThread]: On master: BEGIN
14:04:36.555277 [debug] [MainThread]: Opening a new connection, currently in state init
14:04:36.558877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:36.558997 [debug] [MainThread]: Using postgres connection "master"
14:04:36.559069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:04:36.592336 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:04:36.593164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb3ee0>]}
14:04:36.593337 [debug] [MainThread]: On master: ROLLBACK
14:04:36.593569 [debug] [MainThread]: Using postgres connection "master"
14:04:36.593652 [debug] [MainThread]: On master: BEGIN
14:04:36.593966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:36.594048 [debug] [MainThread]: On master: COMMIT
14:04:36.594116 [debug] [MainThread]: Using postgres connection "master"
14:04:36.594190 [debug] [MainThread]: On master: COMMIT
14:04:36.594369 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:04:36.594451 [debug] [MainThread]: On master: Close
14:04:36.594635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:04:36.594796 [info ] [MainThread]: 
14:04:36.596446 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:04:36.596609 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:04:36.596848 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:04:36.596930 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:04:36.597013 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:04:36.597751 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:04:36.598088 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.598179 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:04:36.609513 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:04:36.609865 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:36.609938 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:04:36.610001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:36.612810 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:36.612954 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:36.613020 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:04:36.615081 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:36.618049 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:36.618157 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:04:36.618499 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.619469 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:36.619538 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:04:36.619813 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.622680 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:04:36.622780 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:36.622845 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:04:36.623374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:36.625338 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:04:36.625412 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:04:36.626993 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:36.627501 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.627607 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:04:36.627812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106460640>]}
14:04:36.627977 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:04:36.628173 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:04:36.628309 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:04:36.628496 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:04:36.628721 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:04:36.628793 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:04:36.628861 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:04:36.629466 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:04:36.629760 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.629830 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:04:36.630785 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:04:36.630960 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:36.631024 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:04:36.631099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:36.634729 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:36.634813 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:36.634876 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:04:36.636504 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:36.637547 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:36.637624 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:04:36.637900 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.638780 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:36.638861 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:04:36.639130 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.640497 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:04:36.640591 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:36.640657 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:04:36.641422 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:36.642055 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:04:36.642121 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:04:36.643002 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:36.643437 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.643517 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:04:36.643676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dacf40>]}
14:04:36.643820 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:04:36.643999 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:04:36.644083 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:04:36.644180 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:04:36.644404 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:04:36.644481 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:04:36.644550 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:04:36.645153 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:04:36.645403 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.645481 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:04:36.646552 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:04:36.646857 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:36.646927 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:04:36.646986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:36.650404 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:36.650513 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:36.650574 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:04:36.652116 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:36.653192 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:36.653266 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:04:36.653524 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.654444 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:36.654530 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:04:36.654772 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.655270 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:04:36.655336 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:36.655394 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:04:36.656001 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:36.656626 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:04:36.656690 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:04:36.657476 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:36.657890 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.657966 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:04:36.658128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808fb80>]}
14:04:36.658276 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
14:04:36.658449 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:04:36.658532 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:04:36.658627 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:04:36.658800 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:04:36.658871 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:04:36.658939 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:04:36.659545 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:04:36.659836 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.659926 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:04:36.660889 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:04:36.661147 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:36.661224 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:04:36.661287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:36.665254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:36.665404 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:36.665476 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:04:36.667583 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:36.668740 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:36.668822 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:04:36.669151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.670065 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:36.670156 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:04:36.670447 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.670943 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:04:36.671007 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:36.671065 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:04:36.671479 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:36.672095 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:04:36.672161 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:04:36.673093 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:36.673567 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.673647 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:04:36.673813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805f2b0>]}
14:04:36.673958 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:04:36.674133 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:04:36.674216 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:04:36.674310 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:04:36.674483 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:04:36.674554 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:04:36.674626 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:04:36.675116 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:04:36.675377 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.675460 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:04:36.676438 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:04:36.676612 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:36.676678 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:04:36.676735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:36.681260 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:36.681366 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:36.681428 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:04:36.683633 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:04:36.684776 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:36.684852 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:04:36.685149 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.686808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:36.686904 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:04:36.687211 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:04:36.687758 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:04:36.687831 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:36.687892 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:04:36.688314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:04:36.689047 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:04:36.689119 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:04:36.689982 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:04:36.690419 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.690499 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:04:36.690668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ca3a0>]}
14:04:36.690817 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:04:36.690997 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:04:36.691083 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:04:36.691179 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:04:36.691395 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:04:36.691469 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:04:36.691534 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:04:36.692866 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:04:36.693117 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.693191 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:04:36.702630 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:04:36.702890 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:04:36.702962 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:04:36.703023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:36.706356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:04:36.706443 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:04:36.706502 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)
  );
14:04:36.706859 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 29:   );
           ^

14:04:36.706941 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:04:36.707115 [debug] [Thread-1  ]: finished collecting timing info
14:04:36.707188 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:04:36.707320 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near ")"
  LINE 29:   );
             ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:04:36.707435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44556e84-67a8-4a75-b12d-a0378278d99f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108075340>]}
14:04:36.707584 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:04:36.707757 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:04:36.708267 [debug] [MainThread]: Acquiring new postgres connection "master"
14:04:36.708366 [debug] [MainThread]: Using postgres connection "master"
14:04:36.708429 [debug] [MainThread]: On master: BEGIN
14:04:36.708486 [debug] [MainThread]: Opening a new connection, currently in state closed
14:04:36.711758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:04:36.711887 [debug] [MainThread]: On master: COMMIT
14:04:36.711951 [debug] [MainThread]: Using postgres connection "master"
14:04:36.712011 [debug] [MainThread]: On master: COMMIT
14:04:36.712145 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:04:36.712216 [debug] [MainThread]: On master: Close
14:04:36.712377 [info ] [MainThread]: 
14:04:36.712499 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.21s.
14:04:36.712612 [debug] [MainThread]: Connection 'master' was properly closed.
14:04:36.712670 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:04:36.714964 [info ] [MainThread]: 
14:04:36.715101 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:04:36.715222 [info ] [MainThread]: 
14:04:36.715327 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:04:36.715430 [error] [MainThread]:   syntax error at or near ")"
14:04:36.715533 [error] [MainThread]:   LINE 29:   );
14:04:36.715631 [error] [MainThread]:              ^
14:04:36.715728 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:04:36.715834 [info ] [MainThread]: 
14:04:36.715934 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:04:36.716079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dac9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b89a60>]}


============================== 2022-05-27 14:05:28.922554 | f1263959-a89b-44d4-9e39-ffe320ab7179 ==============================
14:05:28.922575 [info ] [MainThread]: Running with dbt=1.1.0
14:05:28.923024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:05:28.923275 [debug] [MainThread]: Tracking: tracking
14:05:28.937698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdae20>]}
14:05:28.953974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:05:28.954278 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:05:28.960190 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:05:28.967660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:05:28.970030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c70d0>]}
14:05:28.972754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111168e50>]}
14:05:28.972941 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:05:28.973080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111168ee0>]}
14:05:28.973840 [info ] [MainThread]: 
14:05:28.974081 [debug] [MainThread]: Acquiring new postgres connection "master"
14:05:28.974602 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:05:28.979389 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:05:28.979540 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:05:28.979657 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:05:29.003510 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:05:29.004445 [debug] [ThreadPool]: On list_demo_destination: Close
14:05:29.005099 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:05:29.028512 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:05:29.028685 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:05:29.028753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:05:29.035170 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:05:29.035261 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:05:29.035323 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:05:29.040823 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:05:29.041463 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:05:29.041701 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:05:29.043766 [debug] [MainThread]: Using postgres connection "master"
14:05:29.043875 [debug] [MainThread]: On master: BEGIN
14:05:29.043946 [debug] [MainThread]: Opening a new connection, currently in state init
14:05:29.049234 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:05:29.049357 [debug] [MainThread]: Using postgres connection "master"
14:05:29.049427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:05:29.085174 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:05:29.085989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2cb80>]}
14:05:29.086169 [debug] [MainThread]: On master: ROLLBACK
14:05:29.086411 [debug] [MainThread]: Using postgres connection "master"
14:05:29.086504 [debug] [MainThread]: On master: BEGIN
14:05:29.086794 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:05:29.086887 [debug] [MainThread]: On master: COMMIT
14:05:29.086966 [debug] [MainThread]: Using postgres connection "master"
14:05:29.087037 [debug] [MainThread]: On master: COMMIT
14:05:29.087191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:29.087277 [debug] [MainThread]: On master: Close
14:05:29.087451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:05:29.087595 [info ] [MainThread]: 
14:05:29.089204 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:05:29.089361 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:05:29.089603 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:05:29.089691 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:05:29.089772 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:05:29.090516 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:05:29.090830 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.090918 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:05:29.102755 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:05:29.103103 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:29.103187 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:05:29.103253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:29.105713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:29.105832 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:29.105899 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:05:29.106878 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:29.109894 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:29.110012 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:05:29.110275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.111274 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:29.111343 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:05:29.111523 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.114476 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:05:29.114562 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:29.114623 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:05:29.115184 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:29.117189 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:29.117263 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:05:29.117752 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:29.118271 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.118361 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:05:29.118560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111351c10>]}
14:05:29.118722 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:05:29.119006 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:05:29.119178 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:05:29.119351 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:05:29.119594 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:05:29.119673 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:05:29.119740 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:05:29.120399 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:05:29.120630 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.120703 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:05:29.121689 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:05:29.121878 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:29.121943 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:05:29.122000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:29.126033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:29.126105 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:29.126163 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:05:29.128025 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:29.129122 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:29.129201 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:05:29.129555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.130448 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:29.130515 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:05:29.130856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.132172 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:05:29.132247 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:29.132308 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:05:29.132672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:29.133312 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:29.133391 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:05:29.134624 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:29.135074 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.135156 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:05:29.135314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d77940>]}
14:05:29.135473 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:05:29.135657 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:05:29.135753 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:05:29.135876 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:05:29.136047 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:05:29.136116 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:05:29.136179 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:05:29.136794 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:05:29.137122 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.137222 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:05:29.138271 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:05:29.138490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:29.138558 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:05:29.138617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:29.144441 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:05:29.144513 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:29.144571 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:05:29.146679 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:29.147731 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:29.147826 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:05:29.148152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.149073 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:29.149141 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:05:29.149413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.149933 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:05:29.150004 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:29.150064 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:05:29.150434 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:29.151115 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:29.151191 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:05:29.152588 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:29.153076 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.153156 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:05:29.153338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d777f0>]}
14:05:29.153493 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:05:29.153675 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:05:29.153761 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:05:29.153901 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:05:29.154128 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:05:29.154208 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:05:29.154290 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:05:29.154928 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:05:29.155198 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.155272 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:05:29.156263 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:05:29.156459 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:29.156524 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:05:29.156586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:29.160298 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:29.160368 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:29.160425 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:05:29.163080 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:29.164095 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:29.164167 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:05:29.164512 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.165428 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:29.165508 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:05:29.166073 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.166582 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:05:29.166649 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:29.166708 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:05:29.167976 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:29.168603 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:29.168668 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:05:29.169749 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:29.170231 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.170312 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:05:29.170465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d878e0>]}
14:05:29.170601 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:05:29.170765 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:05:29.170845 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:05:29.170941 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:05:29.171161 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:05:29.171237 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:05:29.171305 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:05:29.171826 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:05:29.172045 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.172116 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:05:29.173087 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:05:29.173276 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:29.173340 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:05:29.173398 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:29.177888 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:29.177986 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:29.178047 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:05:29.179913 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:29.181097 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:29.181176 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:05:29.181492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.183162 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:29.183252 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:05:29.183625 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:29.184173 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:05:29.184252 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:29.184315 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:05:29.184943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:29.185661 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:29.185732 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:05:29.186921 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:29.187370 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.187452 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:05:29.187613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113cc9d0>]}
14:05:29.187765 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:05:29.187939 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:05:29.188027 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:05:29.188155 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:05:29.188335 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:05:29.188403 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:05:29.188468 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:05:29.189912 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:05:29.190197 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.190277 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:05:29.200399 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:05:29.200694 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:05:29.200766 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:05:29.200827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:29.206707 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:05:29.206863 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:05:29.206926 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final;
  );
14:05:29.208896 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: SELECT * FROM final;
                            ^

14:05:29.208991 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:05:29.209216 [debug] [Thread-1  ]: finished collecting timing info
14:05:29.209283 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:05:29.209428 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near ";"
  LINE 30: SELECT * FROM final;
                              ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:05:29.209539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1263959-a89b-44d4-9e39-ffe320ab7179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111393190>]}
14:05:29.209687 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:05:29.209862 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:05:29.210321 [debug] [MainThread]: Acquiring new postgres connection "master"
14:05:29.210409 [debug] [MainThread]: Using postgres connection "master"
14:05:29.210471 [debug] [MainThread]: On master: BEGIN
14:05:29.210530 [debug] [MainThread]: Opening a new connection, currently in state closed
14:05:29.215354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:05:29.215448 [debug] [MainThread]: On master: COMMIT
14:05:29.215506 [debug] [MainThread]: Using postgres connection "master"
14:05:29.215561 [debug] [MainThread]: On master: COMMIT
14:05:29.215713 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:29.215779 [debug] [MainThread]: On master: Close
14:05:29.215920 [info ] [MainThread]: 
14:05:29.216032 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:05:29.216138 [debug] [MainThread]: Connection 'master' was properly closed.
14:05:29.216195 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:05:29.218433 [info ] [MainThread]: 
14:05:29.218562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:05:29.218686 [info ] [MainThread]: 
14:05:29.218786 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:05:29.218891 [error] [MainThread]:   syntax error at or near ";"
14:05:29.218988 [error] [MainThread]:   LINE 30: SELECT * FROM final;
14:05:29.219083 [error] [MainThread]:                               ^
14:05:29.219184 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:05:29.219285 [info ] [MainThread]: 
14:05:29.219385 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:05:29.219524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d77370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d77850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fbe190>]}


============================== 2022-05-27 14:05:37.944774 | b6389174-a405-4f6e-9d49-63fff61f9878 ==============================
14:05:37.944799 [info ] [MainThread]: Running with dbt=1.1.0
14:05:37.945299 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:05:37.945391 [debug] [MainThread]: Tracking: tracking
14:05:37.960425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65aca0>]}
14:05:37.977090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:05:37.977390 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:05:37.983764 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:05:37.991055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:05:37.993402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84a0d0>]}
14:05:37.996097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e7e50>]}
14:05:37.996292 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:05:37.996430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62e610>]}
14:05:37.997140 [info ] [MainThread]: 
14:05:37.997371 [debug] [MainThread]: Acquiring new postgres connection "master"
14:05:37.997878 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:05:38.003067 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:05:38.003230 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:05:38.003306 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:05:38.020938 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:05:38.021882 [debug] [ThreadPool]: On list_demo_destination: Close
14:05:38.022476 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:05:38.045509 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:05:38.045742 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:05:38.045825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:05:38.051655 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:05:38.051761 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:05:38.051835 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:05:38.055230 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:05:38.055860 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:05:38.056052 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:05:38.058046 [debug] [MainThread]: Using postgres connection "master"
14:05:38.058141 [debug] [MainThread]: On master: BEGIN
14:05:38.058208 [debug] [MainThread]: Opening a new connection, currently in state init
14:05:38.064767 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:05:38.064901 [debug] [MainThread]: Using postgres connection "master"
14:05:38.064971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:05:38.093016 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:05:38.093938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716b0a0>]}
14:05:38.094125 [debug] [MainThread]: On master: ROLLBACK
14:05:38.094347 [debug] [MainThread]: Using postgres connection "master"
14:05:38.094429 [debug] [MainThread]: On master: BEGIN
14:05:38.094679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:05:38.094758 [debug] [MainThread]: On master: COMMIT
14:05:38.094832 [debug] [MainThread]: Using postgres connection "master"
14:05:38.094899 [debug] [MainThread]: On master: COMMIT
14:05:38.095047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:38.095129 [debug] [MainThread]: On master: Close
14:05:38.095307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:05:38.095453 [info ] [MainThread]: 
14:05:38.097051 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:05:38.097210 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:05:38.097437 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:05:38.097521 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:05:38.097600 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:05:38.098322 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:05:38.098630 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.098712 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:05:38.109602 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:05:38.109989 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:38.110071 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:05:38.110135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:38.112580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:38.112678 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:38.112744 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:05:38.113864 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:38.116820 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:38.116914 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:05:38.117161 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.118165 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:38.118251 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:05:38.118464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.121622 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:05:38.121738 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:38.121803 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:05:38.122695 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:38.124877 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:05:38.124965 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:05:38.126147 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:38.126655 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.126745 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:05:38.126939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f5b50>]}
14:05:38.127099 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:05:38.127295 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:05:38.127383 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:05:38.127481 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:05:38.127664 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:05:38.127736 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:05:38.127805 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:05:38.128380 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:05:38.128677 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.128756 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:05:38.129724 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:05:38.129921 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:38.129986 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:05:38.130044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:38.137752 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:05:38.137894 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:38.137957 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:05:38.140715 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:38.141895 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:38.141981 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:05:38.142339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.143264 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:38.143339 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:05:38.143653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.145231 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:05:38.145313 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:38.145371 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:05:38.146149 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:38.147032 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:05:38.147113 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:05:38.148785 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:38.149331 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.149418 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:05:38.149616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c6760>]}
14:05:38.149788 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:05:38.149975 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:05:38.150067 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:05:38.150166 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:05:38.150345 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:05:38.150416 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:05:38.150485 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:05:38.151086 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:05:38.151345 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.151426 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:05:38.152388 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:05:38.152587 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:38.152654 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:05:38.152719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:38.156405 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:38.156532 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:38.156594 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:05:38.158262 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:38.159455 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:38.159543 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:05:38.160207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.161309 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:38.161414 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:05:38.161981 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.162521 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:05:38.162610 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:38.162675 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:05:38.163182 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:38.163871 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:05:38.163942 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:05:38.164916 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:38.165416 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.165502 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:05:38.165682 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa03f10>]}
14:05:38.165841 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:05:38.166059 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:05:38.166185 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:05:38.166300 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:05:38.166502 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:05:38.166577 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:05:38.166647 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:05:38.167267 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:05:38.167595 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.167671 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:05:38.168623 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:05:38.168823 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:38.168893 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:05:38.168954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:38.172239 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:38.172358 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:38.172424 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:05:38.174088 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:38.175261 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:38.175350 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:05:38.175629 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.176583 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:38.176666 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:05:38.176949 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.177482 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:05:38.177555 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:38.177617 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:05:38.179405 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:38.180152 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:05:38.180225 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:05:38.181547 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:38.182086 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.182170 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:05:38.182348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ed700>]}
14:05:38.182507 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:05:38.182691 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:05:38.182821 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:05:38.182940 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:05:38.183216 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:05:38.183312 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:05:38.183399 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:05:38.183951 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:05:38.184235 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.184315 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:05:38.185376 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:05:38.185588 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:38.185654 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:05:38.185712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:38.189512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:05:38.189592 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:38.189651 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:05:38.191742 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:05:38.192751 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:38.192823 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:05:38.193493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.195070 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:38.195155 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:05:38.195543 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:05:38.196032 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:05:38.196097 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:38.196155 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:05:38.196651 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:05:38.197294 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:05:38.197357 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:05:38.198829 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:05:38.199244 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.199321 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:05:38.199472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c61c0>]}
14:05:38.199612 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:05:38.199782 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:05:38.199870 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:05:38.199964 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:05:38.200141 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:05:38.200211 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:05:38.200276 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:05:38.201723 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:05:38.202054 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.202132 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:05:38.211952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:05:38.212232 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:05:38.212317 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:05:38.212384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:05:38.218152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:05:38.218283 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:05:38.218357 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final
  );
14:05:38.219843 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "payments"
LINE 21:     SELECT sum(payments.amount) WHERE payments.account_id ==...
                        ^

14:05:38.219925 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:05:38.220574 [debug] [Thread-1  ]: finished collecting timing info
14:05:38.220647 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:05:38.220800 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "payments"
  LINE 21:     SELECT sum(payments.amount) WHERE payments.account_id ==...
                          ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:05:38.220923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6389174-a405-4f6e-9d49-63fff61f9878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8dd4f0>]}
14:05:38.221083 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:05:38.221273 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:05:38.221790 [debug] [MainThread]: Acquiring new postgres connection "master"
14:05:38.221893 [debug] [MainThread]: Using postgres connection "master"
14:05:38.221961 [debug] [MainThread]: On master: BEGIN
14:05:38.222021 [debug] [MainThread]: Opening a new connection, currently in state closed
14:05:38.226453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:05:38.226541 [debug] [MainThread]: On master: COMMIT
14:05:38.226600 [debug] [MainThread]: Using postgres connection "master"
14:05:38.226657 [debug] [MainThread]: On master: COMMIT
14:05:38.226788 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:05:38.226856 [debug] [MainThread]: On master: Close
14:05:38.226997 [info ] [MainThread]: 
14:05:38.227112 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.23s.
14:05:38.227220 [debug] [MainThread]: Connection 'master' was properly closed.
14:05:38.227280 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:05:38.229477 [info ] [MainThread]: 
14:05:38.229598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:05:38.229718 [info ] [MainThread]: 
14:05:38.229822 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:05:38.229930 [error] [MainThread]:   missing FROM-clause entry for table "payments"
14:05:38.230030 [error] [MainThread]:   LINE 21:     SELECT sum(payments.amount) WHERE payments.account_id ==...
14:05:38.230130 [error] [MainThread]:                           ^
14:05:38.230229 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:05:38.230335 [info ] [MainThread]: 
14:05:38.230444 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:05:38.230598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a637ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a637a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa22be0>]}


============================== 2022-05-27 14:09:20.554845 | e4355f59-43a8-4935-ab44-45a19762252e ==============================
14:09:20.554884 [info ] [MainThread]: Running with dbt=1.1.0
14:09:20.555271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:09:20.555370 [debug] [MainThread]: Tracking: tracking
14:09:20.569646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dcc40>]}
14:09:20.585242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:09:20.585519 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:09:20.591214 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:09:20.598325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:09:20.601005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cd0d0>]}
14:09:20.603452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696ce80>]}
14:09:20.603595 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:09:20.603727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696cd60>]}
14:09:20.604433 [info ] [MainThread]: 
14:09:20.604650 [debug] [MainThread]: Acquiring new postgres connection "master"
14:09:20.605152 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:09:20.609853 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:09:20.609968 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:09:20.610042 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:09:20.640999 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:09:20.641950 [debug] [ThreadPool]: On list_demo_destination: Close
14:09:20.642586 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:09:20.665256 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:09:20.665434 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:09:20.665507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:09:20.672236 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:09:20.672356 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:09:20.672425 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:09:20.679691 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:09:20.680376 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:09:20.680603 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:09:20.682756 [debug] [MainThread]: Using postgres connection "master"
14:09:20.682885 [debug] [MainThread]: On master: BEGIN
14:09:20.682955 [debug] [MainThread]: Opening a new connection, currently in state init
14:09:20.687550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:09:20.687654 [debug] [MainThread]: Using postgres connection "master"
14:09:20.687718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:09:20.719348 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:09:20.720079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106762eb0>]}
14:09:20.720252 [debug] [MainThread]: On master: ROLLBACK
14:09:20.720462 [debug] [MainThread]: Using postgres connection "master"
14:09:20.720538 [debug] [MainThread]: On master: BEGIN
14:09:20.720803 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:09:20.720879 [debug] [MainThread]: On master: COMMIT
14:09:20.720947 [debug] [MainThread]: Using postgres connection "master"
14:09:20.721016 [debug] [MainThread]: On master: COMMIT
14:09:20.721177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:09:20.721255 [debug] [MainThread]: On master: Close
14:09:20.721423 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:09:20.721563 [info ] [MainThread]: 
14:09:20.723134 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:09:20.723311 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:09:20.723565 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:09:20.723650 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:09:20.723730 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:09:20.724482 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:09:20.724804 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.724888 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:09:20.736998 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:09:20.737492 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:09:20.737584 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:09:20.737652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:20.740291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:09:20.740403 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:09:20.740469 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:09:20.741635 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:09:20.744891 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:09:20.745023 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:09:20.745377 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.746612 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:09:20.746721 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:09:20.747013 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.750173 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:09:20.750269 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:09:20.750334 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:09:20.750677 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:09:20.753025 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:09:20.753131 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:09:20.753901 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:09:20.754463 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.754563 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:09:20.754762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106966910>]}
14:09:20.754936 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:09:20.755138 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:09:20.755234 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:09:20.755345 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:09:20.755587 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:09:20.755753 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:09:20.755865 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:09:20.756638 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:09:20.756934 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.757021 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:09:20.758108 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:09:20.758331 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:09:20.758399 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:09:20.758464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:20.760892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:09:20.761027 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:09:20.761094 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:09:20.761945 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:09:20.763226 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:09:20.763320 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:09:20.763527 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.764522 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:09:20.764598 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:09:20.764780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.766121 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:09:20.766199 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:09:20.766263 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:09:20.766692 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:09:20.767371 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:09:20.767457 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:09:20.767925 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:09:20.768429 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.768525 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:09:20.768710 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a92580>]}
14:09:20.768868 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:09:20.769064 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:09:20.769147 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:09:20.769383 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:09:20.769609 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:09:20.769681 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:09:20.769748 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:09:20.770480 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:09:20.770836 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.770918 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:09:20.772005 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:09:20.772222 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:09:20.772287 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:09:20.772349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:20.776014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:09:20.776122 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:09:20.776183 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:09:20.777796 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:09:20.779045 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:09:20.779130 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:09:20.779478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.780445 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:09:20.780543 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:09:20.780833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.781355 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:09:20.781424 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:09:20.781484 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:09:20.782087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:09:20.782717 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:09:20.782784 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:09:20.783702 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:09:20.784196 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.784281 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:09:20.784486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654d790>]}
14:09:20.784649 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
14:09:20.784832 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:09:20.784920 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:09:20.785068 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:09:20.785300 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:09:20.785373 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:09:20.785443 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:09:20.786103 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:09:20.786353 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.786443 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:09:20.787577 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:09:20.787906 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:09:20.787980 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:09:20.788040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:20.791735 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:09:20.791843 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:09:20.791907 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:09:20.793946 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:09:20.795333 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:09:20.795440 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:09:20.795769 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.796916 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:09:20.797009 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:09:20.797284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.797903 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:09:20.797988 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:09:20.798053 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:09:20.798542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:09:20.799266 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:09:20.799344 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:09:20.800307 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:09:20.800886 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.800988 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:09:20.801187 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654d760>]}
14:09:20.801344 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:09:20.801527 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:09:20.801673 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:09:20.801787 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:09:20.801991 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:09:20.802060 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:09:20.802127 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:09:20.802655 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:09:20.802966 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.803069 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:09:20.804234 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:09:20.804462 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:09:20.804530 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:09:20.804590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:20.808041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:09:20.808136 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:09:20.808199 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:09:20.810733 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:09:20.811939 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:09:20.812021 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:09:20.812432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.814202 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:09:20.814299 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:09:20.814692 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:09:20.815231 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:09:20.815301 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:09:20.815363 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:09:20.815788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:09:20.816506 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:09:20.816575 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:09:20.817405 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:09:20.818060 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.818169 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:09:20.818366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abc580>]}
14:09:20.818519 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:09:20.818689 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:09:20.818768 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:09:20.818856 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:09:20.819031 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:09:20.819110 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:09:20.819237 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:09:20.820700 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:09:20.820990 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.821070 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:09:20.831151 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:09:20.831434 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:09:20.831509 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:09:20.831573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:20.836802 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:09:20.836900 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:09:20.836964 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final
  );
14:09:20.838101 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "accounts"
LINE 21: ...ount) FROM payments WHERE payments.account_id === accounts.a...
                                                              ^

14:09:20.838192 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:09:20.838419 [debug] [Thread-1  ]: finished collecting timing info
14:09:20.838493 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:09:20.838642 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "accounts"
  LINE 21: ...ount) FROM payments WHERE payments.account_id === accounts.a...
                                                                ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:09:20.838758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4355f59-43a8-4935-ab44-45a19762252e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a838b0>]}
14:09:20.838909 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:09:20.839095 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:09:20.839556 [debug] [MainThread]: Acquiring new postgres connection "master"
14:09:20.839659 [debug] [MainThread]: Using postgres connection "master"
14:09:20.839725 [debug] [MainThread]: On master: BEGIN
14:09:20.839786 [debug] [MainThread]: Opening a new connection, currently in state closed
14:09:20.847224 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:09:20.847316 [debug] [MainThread]: On master: COMMIT
14:09:20.847380 [debug] [MainThread]: Using postgres connection "master"
14:09:20.847439 [debug] [MainThread]: On master: COMMIT
14:09:20.847630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:09:20.847696 [debug] [MainThread]: On master: Close
14:09:20.847846 [info ] [MainThread]: 
14:09:20.847965 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:09:20.848073 [debug] [MainThread]: Connection 'master' was properly closed.
14:09:20.848157 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:09:20.850482 [info ] [MainThread]: 
14:09:20.850619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:09:20.850744 [info ] [MainThread]: 
14:09:20.850851 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:09:20.850957 [error] [MainThread]:   missing FROM-clause entry for table "accounts"
14:09:20.851057 [error] [MainThread]:   LINE 21: ...ount) FROM payments WHERE payments.account_id === accounts.a...
14:09:20.851214 [error] [MainThread]:                                                                 ^
14:09:20.851320 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:09:20.851478 [info ] [MainThread]: 
14:09:20.851604 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:09:20.851758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b2ca0>]}


============================== 2022-05-27 14:10:02.926527 | f56f5cc5-22fe-4d79-8831-3fabc450bf40 ==============================
14:10:02.926561 [info ] [MainThread]: Running with dbt=1.1.0
14:10:02.927010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:10:02.927104 [debug] [MainThread]: Tracking: tracking
14:10:02.941398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745ad90>]}
14:10:02.957369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:10:02.957646 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:10:02.963393 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:10:02.971168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:10:02.973664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076470d0>]}
14:10:02.976279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e7e50>]}
14:10:02.976454 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:10:02.976618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e7ee0>]}
14:10:02.977292 [info ] [MainThread]: 
14:10:02.977523 [debug] [MainThread]: Acquiring new postgres connection "master"
14:10:02.977971 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:10:02.983036 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:10:02.983187 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:10:02.983267 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:10:03.005949 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:10:03.006974 [debug] [ThreadPool]: On list_demo_destination: Close
14:10:03.007677 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:10:03.030570 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:10:03.030752 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:10:03.030819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:10:03.034781 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:10:03.034865 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:10:03.034930 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:10:03.040482 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:10:03.041101 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:10:03.041341 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:10:03.043303 [debug] [MainThread]: Using postgres connection "master"
14:10:03.043396 [debug] [MainThread]: On master: BEGIN
14:10:03.043460 [debug] [MainThread]: Opening a new connection, currently in state init
14:10:03.046914 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:03.046998 [debug] [MainThread]: Using postgres connection "master"
14:10:03.047063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:10:03.077865 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:10:03.078614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039c9f10>]}
14:10:03.078787 [debug] [MainThread]: On master: ROLLBACK
14:10:03.079020 [debug] [MainThread]: Using postgres connection "master"
14:10:03.079102 [debug] [MainThread]: On master: BEGIN
14:10:03.079406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:03.079487 [debug] [MainThread]: On master: COMMIT
14:10:03.079561 [debug] [MainThread]: Using postgres connection "master"
14:10:03.079628 [debug] [MainThread]: On master: COMMIT
14:10:03.079800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:10:03.079880 [debug] [MainThread]: On master: Close
14:10:03.080045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:10:03.080198 [info ] [MainThread]: 
14:10:03.081674 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:10:03.081816 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:10:03.082023 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:10:03.082100 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:10:03.082177 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:10:03.082878 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:10:03.083188 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.083268 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:10:03.094509 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:10:03.094904 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:03.094982 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:10:03.095047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:03.100937 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:10:03.101080 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:03.101156 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:10:03.103249 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:03.106526 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:03.106672 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:10:03.107178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.108250 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:03.108336 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:10:03.108648 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.111981 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:10:03.112112 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:03.112181 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:10:03.113043 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:03.115391 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:03.115489 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:10:03.116676 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:03.117203 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.117293 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:10:03.117492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b97940>]}
14:10:03.117660 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.04s]
14:10:03.117861 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:10:03.117955 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:10:03.118107 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:10:03.118325 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:10:03.118406 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:10:03.118489 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:10:03.119124 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:10:03.119400 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.119477 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:10:03.120517 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:10:03.120726 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:03.120792 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:10:03.120861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:03.124237 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:03.124324 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:03.124389 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:10:03.126230 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:03.127302 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:03.127382 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:10:03.127796 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.128700 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:03.128771 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:10:03.129052 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.130326 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:10:03.130399 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:03.130462 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:10:03.130989 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:03.131625 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:03.131695 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:10:03.132841 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:03.133275 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.133355 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:10:03.133522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f9700>]}
14:10:03.133671 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:10:03.133840 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:10:03.133926 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:10:03.134061 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:10:03.134270 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:10:03.134346 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:10:03.134413 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:10:03.135045 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:10:03.135291 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.135374 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:10:03.136500 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:10:03.136845 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:03.136924 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:10:03.136988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:03.140437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:03.140566 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:03.140632 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:10:03.142842 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:03.144051 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:03.144139 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:10:03.144549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.145637 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:03.145739 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:10:03.146226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.146847 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:10:03.146923 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:03.146988 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:10:03.147643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:03.148327 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:03.148396 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:10:03.165342 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
14:10:03.165919 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.166017 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:10:03.166221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f95b0>]}
14:10:03.166401 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.03s]
14:10:03.166613 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:10:03.166714 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:10:03.166920 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:10:03.167152 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:10:03.167246 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:10:03.167324 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:10:03.168033 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:10:03.168306 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.168393 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:10:03.169433 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:10:03.169627 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:03.169701 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:10:03.169766 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:03.173207 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:03.173294 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:03.173361 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:10:03.174974 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:03.176036 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:03.176116 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:10:03.176442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.177413 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:03.177488 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:10:03.177870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.178404 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:10:03.178477 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:03.178542 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:10:03.179222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:03.179885 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:03.179956 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:10:03.181206 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:03.181784 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.181899 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:10:03.182096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e2c10>]}
14:10:03.182258 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.01s]
14:10:03.182452 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:10:03.182555 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:10:03.182707 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:10:03.182910 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:10:03.182991 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:10:03.183066 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:10:03.183665 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:10:03.183954 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.184040 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:10:03.185101 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:10:03.185307 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:03.185376 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:10:03.185438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:03.189175 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:03.189267 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:03.189337 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:10:03.191005 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:03.192091 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:03.192169 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:10:03.193807 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.195473 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:03.195560 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:10:03.195871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:03.196406 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:10:03.196491 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:03.196558 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:10:03.196952 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:03.197775 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:03.197870 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:10:03.198905 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:03.199434 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.199525 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:10:03.199707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107738af0>]}
14:10:03.199866 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:10:03.200049 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:10:03.200142 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:10:03.200281 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:10:03.200485 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:10:03.200560 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:10:03.200631 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:10:03.202075 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:10:03.202355 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.202438 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:10:03.212803 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:10:03.213163 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:10:03.213242 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:10:03.213307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:03.218731 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:10:03.218830 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:10:03.218898 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts WHERE payments.account_id === accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final
  );
14:10:03.219180 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 21: ...ayments.amount) FROM payments INNER JOIN accounts WHERE paym...
                                                              ^

14:10:03.219269 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:10:03.219471 [debug] [Thread-1  ]: finished collecting timing info
14:10:03.219546 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:10:03.219686 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "WHERE"
  LINE 21: ...ayments.amount) FROM payments INNER JOIN accounts WHERE paym...
                                                                ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:10:03.219810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f56f5cc5-22fe-4d79-8831-3fabc450bf40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f79d0>]}
14:10:03.219973 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:10:03.220164 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:10:03.220761 [debug] [MainThread]: Acquiring new postgres connection "master"
14:10:03.220871 [debug] [MainThread]: Using postgres connection "master"
14:10:03.220943 [debug] [MainThread]: On master: BEGIN
14:10:03.221008 [debug] [MainThread]: Opening a new connection, currently in state closed
14:10:03.224308 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:03.224429 [debug] [MainThread]: On master: COMMIT
14:10:03.224498 [debug] [MainThread]: Using postgres connection "master"
14:10:03.224562 [debug] [MainThread]: On master: COMMIT
14:10:03.224711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:10:03.224791 [debug] [MainThread]: On master: Close
14:10:03.224956 [info ] [MainThread]: 
14:10:03.225084 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:10:03.225196 [debug] [MainThread]: Connection 'master' was properly closed.
14:10:03.225256 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:10:03.227689 [info ] [MainThread]: 
14:10:03.227820 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:10:03.227944 [info ] [MainThread]: 
14:10:03.228052 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:10:03.228157 [error] [MainThread]:   syntax error at or near "WHERE"
14:10:03.228263 [error] [MainThread]:   LINE 21: ...ayments.amount) FROM payments INNER JOIN accounts WHERE paym...
14:10:03.228359 [error] [MainThread]:                                                                 ^
14:10:03.228551 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:10:03.228675 [info ] [MainThread]: 
14:10:03.228782 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:10:03.228940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105860640>]}


============================== 2022-05-27 14:10:36.133298 | 8b03839b-7a2d-47c0-b278-b9097eec9ded ==============================
14:10:36.133314 [info ] [MainThread]: Running with dbt=1.1.0
14:10:36.133764 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:10:36.133860 [debug] [MainThread]: Tracking: tracking
14:10:36.148662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edae20>]}
14:10:36.164300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:10:36.164573 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:10:36.170231 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:10:36.177813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:10:36.180331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dc0d0>]}
14:10:36.182993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717ce50>]}
14:10:36.183152 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:10:36.183297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717cee0>]}
14:10:36.184017 [info ] [MainThread]: 
14:10:36.184306 [debug] [MainThread]: Acquiring new postgres connection "master"
14:10:36.184843 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:10:36.190088 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:10:36.190206 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:10:36.190287 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:10:36.218254 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:10:36.219303 [debug] [ThreadPool]: On list_demo_destination: Close
14:10:36.220023 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:10:36.244172 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:10:36.244390 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:10:36.244462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:10:36.249793 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:10:36.249931 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:10:36.250006 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:10:36.253028 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:10:36.253696 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:10:36.255233 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:10:36.257338 [debug] [MainThread]: Using postgres connection "master"
14:10:36.257431 [debug] [MainThread]: On master: BEGIN
14:10:36.257502 [debug] [MainThread]: Opening a new connection, currently in state init
14:10:36.267930 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:10:36.268040 [debug] [MainThread]: Using postgres connection "master"
14:10:36.268108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:10:36.300618 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:10:36.301512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2cb80>]}
14:10:36.301706 [debug] [MainThread]: On master: ROLLBACK
14:10:36.301959 [debug] [MainThread]: Using postgres connection "master"
14:10:36.302042 [debug] [MainThread]: On master: BEGIN
14:10:36.302364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:36.302445 [debug] [MainThread]: On master: COMMIT
14:10:36.302514 [debug] [MainThread]: Using postgres connection "master"
14:10:36.302586 [debug] [MainThread]: On master: COMMIT
14:10:36.302807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:10:36.302894 [debug] [MainThread]: On master: Close
14:10:36.303079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:10:36.303258 [info ] [MainThread]: 
14:10:36.304911 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:10:36.305077 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:10:36.305325 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:10:36.305412 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:10:36.305493 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:10:36.306280 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:10:36.306611 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.306698 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:10:36.319062 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:10:36.319452 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:36.319539 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:10:36.319604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:36.323655 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:36.323808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:36.323891 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:10:36.324808 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:36.328124 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:36.328235 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:10:36.328585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.329635 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:36.329718 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:10:36.329954 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.333108 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:10:36.333220 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:36.333298 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:10:36.333926 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:36.336260 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:36.336366 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:10:36.337837 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:36.338547 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.338696 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:10:36.338942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717ca90>]}
14:10:36.339135 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:10:36.339346 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:10:36.339437 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:10:36.339587 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:10:36.339786 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:10:36.339860 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:10:36.339934 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:10:36.340569 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:10:36.340858 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.340937 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:10:36.342050 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:10:36.342362 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:36.342437 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:10:36.342501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:36.347625 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:10:36.347808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:36.347884 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:10:36.349610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:36.350983 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:36.351070 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:10:36.351630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.352653 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:36.352737 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:10:36.353091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.354538 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:10:36.354621 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:36.354688 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:10:36.355081 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:36.355978 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:36.356135 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:10:36.357033 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:36.357601 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.357696 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:10:36.357897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79790>]}
14:10:36.358071 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:10:36.358268 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:10:36.358389 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:10:36.358560 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:10:36.358758 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:10:36.358830 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:10:36.358900 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:10:36.359569 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:10:36.359856 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.359992 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:10:36.361103 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:10:36.361376 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:36.361443 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:10:36.361503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:36.366803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:10:36.366945 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:36.367027 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:10:36.370625 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:36.371926 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:36.372021 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:10:36.372540 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.373548 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:36.373629 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:10:36.373968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.374522 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:10:36.374592 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:36.374655 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:10:36.375255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:36.375923 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:36.375991 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:10:36.377971 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:36.378521 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.378614 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:10:36.378811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79880>]}
14:10:36.378975 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:10:36.379163 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:10:36.379250 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:10:36.379387 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:10:36.379781 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:10:36.379905 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:10:36.379980 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:10:36.380692 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:10:36.380965 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.381043 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:10:36.382154 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:10:36.382413 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:36.382494 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:10:36.382564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:36.387208 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:36.387344 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:36.387416 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:10:36.390441 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:36.391808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:36.391896 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:10:36.392411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.393610 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:36.393733 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:10:36.394077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.394840 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:10:36.394965 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:36.395044 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:10:36.395554 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:36.396408 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:36.396500 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:10:36.397989 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:36.398678 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.398798 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:10:36.399047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79790>]}
14:10:36.399213 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:10:36.399399 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:10:36.399483 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:10:36.399663 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:10:36.399926 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:10:36.400007 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:10:36.400075 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:10:36.400681 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:10:36.400992 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.401088 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:10:36.402145 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:10:36.402370 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:36.402434 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:10:36.402491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:36.408167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:10:36.408310 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:36.408383 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:10:36.411029 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:36.412387 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:36.412466 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:10:36.413120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.415013 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:36.415140 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:10:36.415630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:36.416196 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:10:36.416277 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:36.416336 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:10:36.417231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:36.418003 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:36.418088 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:10:36.419663 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:36.420264 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.420361 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:10:36.420539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ca9d0>]}
14:10:36.420687 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:10:36.420860 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:10:36.420942 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:10:36.421034 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:10:36.421337 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:10:36.421434 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:10:36.421506 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:10:36.423011 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:10:36.423347 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.423424 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:10:36.433965 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:10:36.434285 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:10:36.434364 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:10:36.434426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:36.441616 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:10:36.441790 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:10:36.441934 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON payments.account_id === accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final
  );
14:10:36.442816 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: double precision === double precision
LINE 21: ...yments INNER JOIN accounts ON payments.account_id === accoun...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

14:10:36.442962 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:10:36.443195 [debug] [Thread-1  ]: finished collecting timing info
14:10:36.443276 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:10:36.443455 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  operator does not exist: double precision === double precision
  LINE 21: ...yments INNER JOIN accounts ON payments.account_id === accoun...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:10:36.443601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b03839b-7a2d-47c0-b278-b9097eec9ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107276310>]}
14:10:36.443773 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:10:36.443974 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:10:36.444552 [debug] [MainThread]: Acquiring new postgres connection "master"
14:10:36.444676 [debug] [MainThread]: Using postgres connection "master"
14:10:36.444744 [debug] [MainThread]: On master: BEGIN
14:10:36.444804 [debug] [MainThread]: Opening a new connection, currently in state closed
14:10:36.451462 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:10:36.451613 [debug] [MainThread]: On master: COMMIT
14:10:36.451689 [debug] [MainThread]: Using postgres connection "master"
14:10:36.451756 [debug] [MainThread]: On master: COMMIT
14:10:36.451932 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:10:36.452010 [debug] [MainThread]: On master: Close
14:10:36.452200 [info ] [MainThread]: 
14:10:36.452324 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.27s.
14:10:36.452437 [debug] [MainThread]: Connection 'master' was properly closed.
14:10:36.452498 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:10:36.454900 [info ] [MainThread]: 
14:10:36.455030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:10:36.455154 [info ] [MainThread]: 
14:10:36.455273 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:10:36.455378 [error] [MainThread]:   operator does not exist: double precision === double precision
14:10:36.455482 [error] [MainThread]:   LINE 21: ...yments INNER JOIN accounts ON payments.account_id === accoun...
14:10:36.455585 [error] [MainThread]:                                                                 ^
14:10:36.455683 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
14:10:36.455790 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:10:36.455896 [info ] [MainThread]: 
14:10:36.456000 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:10:36.456151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eba940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eba9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec60d0>]}


============================== 2022-05-27 14:10:55.361159 | 658571b0-e055-4dd1-9bab-46a570b6f3f4 ==============================
14:10:55.361182 [info ] [MainThread]: Running with dbt=1.1.0
14:10:55.361644 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:10:55.361765 [debug] [MainThread]: Tracking: tracking
14:10:55.376746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed8e20>]}
14:10:55.392830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:10:55.393089 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:10:55.399302 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:10:55.406986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:10:55.409652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128db0d0>]}
14:10:55.412225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287be50>]}
14:10:55.412377 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:10:55.412525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287bee0>]}
14:10:55.413257 [info ] [MainThread]: 
14:10:55.413499 [debug] [MainThread]: Acquiring new postgres connection "master"
14:10:55.413982 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:10:55.418609 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:10:55.418759 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:10:55.418858 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:10:55.448598 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:10:55.449541 [debug] [ThreadPool]: On list_demo_destination: Close
14:10:55.450184 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:10:55.473465 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:10:55.473656 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:10:55.473730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:10:55.488025 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:10:55.488151 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:10:55.488226 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:10:55.492410 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:10:55.493113 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:10:55.493346 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:10:55.495446 [debug] [MainThread]: Using postgres connection "master"
14:10:55.495545 [debug] [MainThread]: On master: BEGIN
14:10:55.495613 [debug] [MainThread]: Opening a new connection, currently in state init
14:10:55.499683 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:55.499769 [debug] [MainThread]: Using postgres connection "master"
14:10:55.499834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:10:55.531506 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:10:55.532200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a08640>]}
14:10:55.532360 [debug] [MainThread]: On master: ROLLBACK
14:10:55.532574 [debug] [MainThread]: Using postgres connection "master"
14:10:55.532655 [debug] [MainThread]: On master: BEGIN
14:10:55.532966 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:55.533049 [debug] [MainThread]: On master: COMMIT
14:10:55.533125 [debug] [MainThread]: Using postgres connection "master"
14:10:55.533194 [debug] [MainThread]: On master: COMMIT
14:10:55.533367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:10:55.533449 [debug] [MainThread]: On master: Close
14:10:55.533618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:10:55.533766 [info ] [MainThread]: 
14:10:55.535304 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:10:55.535470 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:10:55.535708 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:10:55.535795 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:10:55.535879 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:10:55.536629 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:10:55.536985 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.537081 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:10:55.549099 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:10:55.549487 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:55.549568 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:10:55.549637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:55.552241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:55.552368 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:55.552448 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:10:55.553350 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:55.556632 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:55.556788 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:10:55.557169 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.558300 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:55.558384 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:10:55.558820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.562139 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:10:55.562283 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:55.562364 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:10:55.563045 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:55.565364 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:10:55.565467 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:10:55.566045 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:55.566582 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.566687 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:10:55.566886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac7820>]}
14:10:55.567069 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:10:55.567272 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:10:55.567369 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:10:55.567466 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:10:55.567710 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:10:55.567791 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:10:55.567862 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:10:55.568490 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:10:55.568739 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.568822 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:10:55.569897 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:10:55.570127 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:55.570200 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:10:55.570283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:55.573799 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:55.573892 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:55.573961 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:10:55.575707 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:55.576942 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:55.577032 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:10:55.577462 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.578502 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:55.578584 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:10:55.578849 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.580161 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:10:55.580243 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:55.580305 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:10:55.581004 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:55.581628 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:10:55.581716 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:10:55.582653 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:55.583103 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.583186 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:10:55.583359 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c87760>]}
14:10:55.583513 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:10:55.583701 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:10:55.583788 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:10:55.583918 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:10:55.584099 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:10:55.584169 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:10:55.584239 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:10:55.584846 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:10:55.585109 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.585180 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:10:55.586088 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:10:55.586274 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:55.586337 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:10:55.586393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:55.589810 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:55.589882 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:55.589939 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:10:55.591610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:55.592595 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:55.592671 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:10:55.593025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.593929 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:55.593995 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:10:55.594283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.594867 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:10:55.594946 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:55.595008 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:10:55.595639 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:55.596280 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:10:55.596352 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:10:55.597416 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:55.597839 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.597916 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:10:55.598076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c87520>]}
14:10:55.598213 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
14:10:55.598381 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:10:55.598466 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:10:55.598653 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:10:55.598844 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:10:55.598925 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:10:55.598991 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:10:55.599589 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:10:55.599818 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.599889 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:10:55.600837 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:10:55.601014 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:55.601081 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:10:55.601140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:55.604368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:55.604451 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:55.604514 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:10:55.607083 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:55.608112 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:55.608190 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:10:55.608577 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.609490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:55.609557 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:10:55.610009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.610545 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:10:55.610618 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:55.610680 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:10:55.611196 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:55.611832 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:10:55.611907 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:10:55.612962 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:55.613446 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.613531 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:10:55.613695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c87c10>]}
14:10:55.613837 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.01s]
14:10:55.614012 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:10:55.614095 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:10:55.614243 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:10:55.614460 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:10:55.614536 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:10:55.614605 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:10:55.615142 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:10:55.615398 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.615472 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:10:55.616501 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:10:55.616696 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:55.616762 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:10:55.616825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:55.620317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:55.620428 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:55.620496 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:10:55.622739 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:10:55.623872 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:55.623951 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:10:55.624361 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.625965 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:55.626055 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:10:55.626424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:10:55.626934 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:10:55.627014 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:55.627076 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:10:55.627999 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:10:55.628690 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:10:55.628756 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:10:55.629841 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:10:55.630274 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.630357 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:10:55.630517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e9d60>]}
14:10:55.630656 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:10:55.630828 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:10:55.630911 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:10:55.631037 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:10:55.631208 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:10:55.631277 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:10:55.631342 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:10:55.632711 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:10:55.632973 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.633044 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:10:55.643151 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:10:55.643522 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:10:55.643597 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:10:55.643659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:10:55.647978 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:10:55.648074 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:10:55.648133 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON payments.account_id = accounts.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final
  );
14:10:55.650231 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "accounts"
LINE 26:         accounts.account_name
                 ^

14:10:55.650328 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:10:55.650575 [debug] [Thread-1  ]: finished collecting timing info
14:10:55.650647 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:10:55.650801 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "accounts"
  LINE 26:         accounts.account_name
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:10:55.650920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658571b0-e055-4dd1-9bab-46a570b6f3f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b6580>]}
14:10:55.651081 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:10:55.651273 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:10:55.651771 [debug] [MainThread]: Acquiring new postgres connection "master"
14:10:55.651875 [debug] [MainThread]: Using postgres connection "master"
14:10:55.651941 [debug] [MainThread]: On master: BEGIN
14:10:55.652001 [debug] [MainThread]: Opening a new connection, currently in state closed
14:10:55.655628 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:10:55.655752 [debug] [MainThread]: On master: COMMIT
14:10:55.655819 [debug] [MainThread]: Using postgres connection "master"
14:10:55.655879 [debug] [MainThread]: On master: COMMIT
14:10:55.656071 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:10:55.656147 [debug] [MainThread]: On master: Close
14:10:55.656337 [info ] [MainThread]: 
14:10:55.656467 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:10:55.656578 [debug] [MainThread]: Connection 'master' was properly closed.
14:10:55.656638 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:10:55.658983 [info ] [MainThread]: 
14:10:55.659120 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:10:55.659241 [info ] [MainThread]: 
14:10:55.659346 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:10:55.659450 [error] [MainThread]:   missing FROM-clause entry for table "accounts"
14:10:55.659548 [error] [MainThread]:   LINE 26:         accounts.account_name
14:10:55.659646 [error] [MainThread]:                    ^
14:10:55.659743 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:10:55.659848 [info ] [MainThread]: 
14:10:55.659948 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:10:55.660091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c79ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c79cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a3730>]}


============================== 2022-05-27 14:11:36.423331 | 00703ebb-977d-42ea-ae7a-4aaee7bd5e4e ==============================
14:11:36.423353 [info ] [MainThread]: Running with dbt=1.1.0
14:11:36.423865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:11:36.423969 [debug] [MainThread]: Tracking: tracking
14:11:36.440460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588bee0>]}
14:11:36.457271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:11:36.457575 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:11:36.463443 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:11:36.471115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:11:36.473570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b96f10>]}
14:11:36.476298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105875fd0>]}
14:11:36.476455 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:11:36.476599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2eee0>]}
14:11:36.477329 [info ] [MainThread]: 
14:11:36.477560 [debug] [MainThread]: Acquiring new postgres connection "master"
14:11:36.478050 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:11:36.483134 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:11:36.483291 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:11:36.483376 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:11:36.512662 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:11:36.513716 [debug] [ThreadPool]: On list_demo_destination: Close
14:11:36.514367 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:11:36.537726 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:11:36.537898 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:11:36.537984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:11:36.542024 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:11:36.542136 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:11:36.542209 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:11:36.547816 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:11:36.548458 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:11:36.548712 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:11:36.550845 [debug] [MainThread]: Using postgres connection "master"
14:11:36.550963 [debug] [MainThread]: On master: BEGIN
14:11:36.551030 [debug] [MainThread]: Opening a new connection, currently in state init
14:11:36.554539 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:11:36.554663 [debug] [MainThread]: Using postgres connection "master"
14:11:36.554730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:11:36.585122 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:11:36.585813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059662e0>]}
14:11:36.585987 [debug] [MainThread]: On master: ROLLBACK
14:11:36.586216 [debug] [MainThread]: Using postgres connection "master"
14:11:36.586295 [debug] [MainThread]: On master: BEGIN
14:11:36.586602 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:11:36.586684 [debug] [MainThread]: On master: COMMIT
14:11:36.586753 [debug] [MainThread]: Using postgres connection "master"
14:11:36.586818 [debug] [MainThread]: On master: COMMIT
14:11:36.586990 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:11:36.587069 [debug] [MainThread]: On master: Close
14:11:36.587230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:11:36.587372 [info ] [MainThread]: 
14:11:36.588992 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:11:36.589156 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:11:36.589395 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:11:36.589483 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:11:36.589573 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:11:36.590370 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:11:36.590743 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.590840 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:11:36.602474 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:11:36.602831 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:11:36.602911 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:11:36.602975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:11:36.605561 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:11:36.605695 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:11:36.605765 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:11:36.606586 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:11:36.609751 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:11:36.609922 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:11:36.610197 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.611244 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:11:36.611325 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:11:36.611564 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.614491 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:11:36.614591 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:11:36.614654 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:11:36.615088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:11:36.617151 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:11:36.617233 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:11:36.617737 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:11:36.618232 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.618323 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:11:36.618528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f5fac0>]}
14:11:36.618714 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:11:36.618952 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:11:36.619080 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:11:36.619193 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:11:36.619503 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:11:36.619605 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:11:36.619679 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:11:36.620351 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:11:36.620649 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.620721 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:11:36.621753 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:11:36.621971 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:11:36.622040 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:11:36.622104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:11:36.626424 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:11:36.626613 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:11:36.626683 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:11:36.628458 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:11:36.629812 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:11:36.629928 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:11:36.630630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.631606 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:11:36.631681 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:11:36.631967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.633254 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:11:36.633326 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:11:36.633389 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:11:36.634152 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:11:36.634771 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:11:36.634844 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:11:36.635775 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:11:36.636288 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.636382 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:11:36.636597 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105500970>]}
14:11:36.636908 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:11:36.637116 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:11:36.637205 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:11:36.637298 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:11:36.637497 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:11:36.637570 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:11:36.637638 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:11:36.638251 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:11:36.638505 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.638582 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:11:36.639551 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:11:36.639758 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:11:36.639832 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:11:36.639901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:11:36.643995 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:11:36.644149 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:11:36.644218 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:11:36.645895 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:11:36.647081 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:11:36.647158 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:11:36.647476 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.648388 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:11:36.648454 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:11:36.648852 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.649361 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:11:36.649428 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:11:36.649491 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:11:36.649851 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:11:36.650470 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:11:36.650546 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:11:36.651989 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:11:36.652522 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.652632 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:11:36.652850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c48700>]}
14:11:36.653028 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:11:36.653228 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:11:36.653322 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:11:36.653530 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:11:36.653745 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:11:36.653822 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:11:36.653890 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:11:36.654547 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:11:36.654818 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.654891 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:11:36.655844 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:11:36.656047 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:11:36.656109 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:11:36.656166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:11:36.660054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:11:36.660127 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:11:36.660183 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:11:36.662146 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:11:36.663148 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:11:36.663221 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:11:36.663591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.664482 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:11:36.664551 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:11:36.664833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.665313 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:11:36.665394 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:11:36.665464 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:11:36.665876 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:11:36.666490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:11:36.666554 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:11:36.667683 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:11:36.668144 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.668226 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:11:36.668379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c480a0>]}
14:11:36.668516 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.01s]
14:11:36.668678 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:11:36.668762 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:11:36.668882 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:11:36.669066 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:11:36.669135 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:11:36.669197 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:11:36.669694 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:11:36.669923 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.669992 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:11:36.670965 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:11:36.671149 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:11:36.671213 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:11:36.671270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:11:36.676048 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:11:36.676122 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:11:36.676181 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:11:36.679216 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:11:36.680321 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:11:36.680420 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:11:36.680936 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.682557 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:11:36.682627 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:11:36.682977 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:11:36.683475 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:11:36.683541 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:11:36.683599 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:11:36.684248 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:11:36.684918 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:11:36.684986 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:11:36.686116 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:11:36.686539 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.686618 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:11:36.686784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca8ca0>]}
14:11:36.686928 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:11:36.687092 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:11:36.687180 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:11:36.687275 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:11:36.687489 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:11:36.687560 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:11:36.687623 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:11:36.688945 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:11:36.689208 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.689281 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:11:36.698794 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:11:36.699001 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:11:36.699088 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:11:36.699155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:11:36.707998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:11:36.708151 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:11:36.708213 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON accounts.account_id = payments.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT
        accounts.account_name
        , lifetime_value
)

SELECT * FROM final
  );
14:11:36.710145 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "accounts"
LINE 26:         accounts.account_name
                 ^

14:11:36.710233 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:11:36.710502 [debug] [Thread-1  ]: finished collecting timing info
14:11:36.710577 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:11:36.710725 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "accounts"
  LINE 26:         accounts.account_name
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:11:36.710847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00703ebb-977d-42ea-ae7a-4aaee7bd5e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c49730>]}
14:11:36.711001 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:11:36.711184 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:11:36.711695 [debug] [MainThread]: Acquiring new postgres connection "master"
14:11:36.711802 [debug] [MainThread]: Using postgres connection "master"
14:11:36.711869 [debug] [MainThread]: On master: BEGIN
14:11:36.711927 [debug] [MainThread]: Opening a new connection, currently in state closed
14:11:36.721931 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:11:36.722061 [debug] [MainThread]: On master: COMMIT
14:11:36.722128 [debug] [MainThread]: Using postgres connection "master"
14:11:36.722192 [debug] [MainThread]: On master: COMMIT
14:11:36.722357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:11:36.722431 [debug] [MainThread]: On master: Close
14:11:36.722618 [info ] [MainThread]: 
14:11:36.722743 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:11:36.722850 [debug] [MainThread]: Connection 'master' was properly closed.
14:11:36.722909 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:11:36.725422 [info ] [MainThread]: 
14:11:36.725575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:11:36.725696 [info ] [MainThread]: 
14:11:36.725800 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:11:36.725903 [error] [MainThread]:   missing FROM-clause entry for table "accounts"
14:11:36.726015 [error] [MainThread]:   LINE 26:         accounts.account_name
14:11:36.726112 [error] [MainThread]:                    ^
14:11:36.726211 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:11:36.726314 [info ] [MainThread]: 
14:11:36.726415 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:11:36.726562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058707f0>]}


============================== 2022-05-27 14:12:30.693722 | a90a5128-3638-49e3-abd6-d4976e9e0a17 ==============================
14:12:30.693740 [info ] [MainThread]: Running with dbt=1.1.0
14:12:30.694102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:12:30.694199 [debug] [MainThread]: Tracking: tracking
14:12:30.708831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e1ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e32130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e320d0>]}
14:12:30.724563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:12:30.724836 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:12:30.732971 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:12:30.740404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:12:30.742688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411a0d0>]}
14:12:30.745230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f9efa0>]}
14:12:30.745395 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:12:30.745529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f9efd0>]}
14:12:30.746293 [info ] [MainThread]: 
14:12:30.746526 [debug] [MainThread]: Acquiring new postgres connection "master"
14:12:30.746986 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:12:30.751746 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:12:30.751911 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:12:30.751988 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:12:30.792411 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
14:12:30.793503 [debug] [ThreadPool]: On list_demo_destination: Close
14:12:30.794186 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:12:30.817901 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:12:30.818071 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:12:30.818142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:12:30.825907 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:12:30.825999 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:12:30.826066 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:12:30.829649 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:12:30.830290 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:12:30.830487 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:12:30.832556 [debug] [MainThread]: Using postgres connection "master"
14:12:30.832646 [debug] [MainThread]: On master: BEGIN
14:12:30.832713 [debug] [MainThread]: Opening a new connection, currently in state init
14:12:30.837010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:12:30.837088 [debug] [MainThread]: Using postgres connection "master"
14:12:30.837153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:12:30.882231 [debug] [MainThread]: SQL status: SELECT 5 in 0.05 seconds
14:12:30.883123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dec6a0>]}
14:12:30.883312 [debug] [MainThread]: On master: ROLLBACK
14:12:30.883543 [debug] [MainThread]: Using postgres connection "master"
14:12:30.883646 [debug] [MainThread]: On master: BEGIN
14:12:30.883967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:12:30.884060 [debug] [MainThread]: On master: COMMIT
14:12:30.884144 [debug] [MainThread]: Using postgres connection "master"
14:12:30.884220 [debug] [MainThread]: On master: COMMIT
14:12:30.884394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:12:30.884529 [debug] [MainThread]: On master: Close
14:12:30.884748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:12:30.884910 [info ] [MainThread]: 
14:12:30.886593 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:12:30.886748 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:12:30.886990 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:12:30.887072 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:12:30.887150 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:12:30.887897 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:12:30.888218 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.888304 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:12:30.900205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:12:30.900480 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:30.900556 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:12:30.900622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:30.904498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:30.904619 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:30.904685 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:12:30.906520 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:30.909570 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:30.909705 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:12:30.910190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.911264 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:30.911352 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:12:30.911861 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.914994 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:12:30.915081 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:30.915148 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:12:30.916434 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:30.918548 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:30.918638 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:12:30.919637 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:30.920139 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.920229 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:12:30.920426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11351d220>]}
14:12:30.920597 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:12:30.920789 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:12:30.920879 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:12:30.921023 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:12:30.921237 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:12:30.921313 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:12:30.921383 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:12:30.922004 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:12:30.922280 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.922353 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:12:30.923361 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:12:30.923571 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:30.923638 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:12:30.923698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:30.927038 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:30.927122 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:30.927185 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:12:30.928835 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:30.929882 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:30.929958 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:12:30.930247 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.931134 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:30.931202 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:12:30.931568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.932818 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:12:30.932895 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:30.932955 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:12:30.933582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:30.934218 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:30.934294 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:12:30.935136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:30.935616 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.935704 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:12:30.935879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141e2970>]}
14:12:30.936029 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:12:30.936204 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:12:30.936291 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:12:30.936431 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:12:30.936641 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:12:30.936720 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:12:30.936791 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:12:30.937445 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:12:30.937731 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.937822 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:12:30.938897 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:12:30.939167 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:30.939237 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:12:30.939297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:30.944856 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:12:30.944967 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:30.945027 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:12:30.946999 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:30.948114 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:30.948203 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:12:30.948536 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.949608 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:30.949714 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:12:30.950146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.950728 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:12:30.950798 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:30.950863 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:12:30.951517 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:30.952219 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:30.952294 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:12:30.954024 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:30.954516 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.954603 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:12:30.954788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141c7f40>]}
14:12:30.954948 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:12:30.955132 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:12:30.955219 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:12:30.955358 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:12:30.955588 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:12:30.955663 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:12:30.955731 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:12:30.956345 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:12:30.956624 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.956694 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:12:30.957646 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:12:30.957826 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:30.957889 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:12:30.957950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:30.961929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:30.962010 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:30.962069 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:12:30.964993 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:30.966043 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:30.966119 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:12:30.966726 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.967662 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:30.967729 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:12:30.968162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.968739 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:12:30.968810 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:30.968870 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:12:30.970317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:30.971011 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:30.971077 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:12:30.974521 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:30.975031 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.975111 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:12:30.975280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141be250>]}
14:12:30.975430 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:12:30.975606 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:12:30.975698 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:12:30.975792 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:12:30.975963 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:12:30.976037 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:12:30.976103 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:12:30.976619 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:12:30.976916 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.976991 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:12:30.977983 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:12:30.978157 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:30.978220 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:12:30.978275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:30.983596 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:12:30.983673 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:30.983732 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:12:30.988216 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:30.989461 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:30.989539 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:12:30.990099 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.991806 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:30.991906 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:12:30.992372 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:30.992944 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:12:30.993014 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:30.993073 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:12:30.993622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:30.994375 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:30.994451 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:12:30.996316 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:30.996793 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.996877 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:12:30.997050 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114229f70>]}
14:12:30.997208 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:12:30.997385 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:12:30.997473 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:12:30.997568 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:12:30.997741 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:12:30.997809 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:12:30.997873 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:12:30.999190 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:12:30.999466 [debug] [Thread-1  ]: finished collecting timing info
14:12:30.999559 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:12:31.009082 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:12:31.009479 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:12:31.009591 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:12:31.009673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:31.014233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:31.014346 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:12:31.014411 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON accounts.account_id = payments.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT  
        accounts.account_name
        , lifetime_value
    FROM accounts
)

SELECT * FROM final
  );
14:12:31.015611 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "lifetime_value" does not exist
LINE 27:         , lifetime_value
                   ^

14:12:31.015692 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:12:31.015867 [debug] [Thread-1  ]: finished collecting timing info
14:12:31.015932 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:12:31.016077 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "lifetime_value" does not exist
  LINE 27:         , lifetime_value
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:12:31.016192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a90a5128-3638-49e3-abd6-d4976e9e0a17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141f6370>]}
14:12:31.016341 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:12:31.016521 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:12:31.016964 [debug] [MainThread]: Acquiring new postgres connection "master"
14:12:31.017050 [debug] [MainThread]: Using postgres connection "master"
14:12:31.017112 [debug] [MainThread]: On master: BEGIN
14:12:31.017172 [debug] [MainThread]: Opening a new connection, currently in state closed
14:12:31.021764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:12:31.021852 [debug] [MainThread]: On master: COMMIT
14:12:31.021911 [debug] [MainThread]: Using postgres connection "master"
14:12:31.021965 [debug] [MainThread]: On master: COMMIT
14:12:31.022161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:12:31.022227 [debug] [MainThread]: On master: Close
14:12:31.022366 [info ] [MainThread]: 
14:12:31.022479 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.28s.
14:12:31.022586 [debug] [MainThread]: Connection 'master' was properly closed.
14:12:31.022647 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:12:31.024865 [info ] [MainThread]: 
14:12:31.024995 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:12:31.025111 [info ] [MainThread]: 
14:12:31.025215 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:12:31.025315 [error] [MainThread]:   column "lifetime_value" does not exist
14:12:31.025412 [error] [MainThread]:   LINE 27:         , lifetime_value
14:12:31.025506 [error] [MainThread]:                      ^
14:12:31.025601 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:12:31.025705 [info ] [MainThread]: 
14:12:31.025804 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:12:31.025938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bda970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141e2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113df5880>]}


============================== 2022-05-27 14:12:59.637406 | cd529476-a25a-4258-8094-39447991aa8d ==============================
14:12:59.637583 [info ] [MainThread]: Running with dbt=1.1.0
14:12:59.637997 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:12:59.638100 [debug] [MainThread]: Tracking: tracking
14:12:59.652016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571acd0>]}
14:12:59.667786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:12:59.668043 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:12:59.674079 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:12:59.681878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:12:59.684506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1d0d0>]}
14:12:59.686977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bbe50>]}
14:12:59.687121 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:12:59.687262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bbf10>]}
14:12:59.687992 [info ] [MainThread]: 
14:12:59.688205 [debug] [MainThread]: Acquiring new postgres connection "master"
14:12:59.688752 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:12:59.694039 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:12:59.694166 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:12:59.694250 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:12:59.720705 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:12:59.721665 [debug] [ThreadPool]: On list_demo_destination: Close
14:12:59.722323 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:12:59.745342 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:12:59.745517 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:12:59.745590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:12:59.750539 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:12:59.750683 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:12:59.750763 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:12:59.756503 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:12:59.757230 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:12:59.757461 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:12:59.759494 [debug] [MainThread]: Using postgres connection "master"
14:12:59.759586 [debug] [MainThread]: On master: BEGIN
14:12:59.759651 [debug] [MainThread]: Opening a new connection, currently in state init
14:12:59.763532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:12:59.763611 [debug] [MainThread]: Using postgres connection "master"
14:12:59.763676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:12:59.795206 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:12:59.795909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f2d3a0>]}
14:12:59.796074 [debug] [MainThread]: On master: ROLLBACK
14:12:59.796378 [debug] [MainThread]: Using postgres connection "master"
14:12:59.796458 [debug] [MainThread]: On master: BEGIN
14:12:59.796800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:12:59.796915 [debug] [MainThread]: On master: COMMIT
14:12:59.797007 [debug] [MainThread]: Using postgres connection "master"
14:12:59.797080 [debug] [MainThread]: On master: COMMIT
14:12:59.797273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:12:59.797362 [debug] [MainThread]: On master: Close
14:12:59.797552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:12:59.797699 [info ] [MainThread]: 
14:12:59.799329 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:12:59.799489 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:12:59.799731 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:12:59.799816 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:12:59.799897 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:12:59.800620 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:12:59.800981 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.801071 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:12:59.812722 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:12:59.813054 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:59.813137 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:12:59.813205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.815839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:59.815961 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:59.816025 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:12:59.816910 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:59.819961 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:59.820085 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:12:59.820412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.821586 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:59.821719 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:12:59.821991 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.825104 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:12:59.825218 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:59.825285 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:12:59.825916 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:59.828003 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:12:59.828088 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:12:59.828674 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:59.829240 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.829348 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:12:59.829587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472dc70>]}
14:12:59.829851 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:12:59.830110 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:12:59.830210 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:12:59.830312 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:12:59.830527 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:12:59.830605 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:12:59.830678 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:12:59.831292 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:12:59.831550 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.831627 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:12:59.832695 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:12:59.832911 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:59.832988 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:12:59.833047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.835681 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:59.835829 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:59.835902 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:12:59.837703 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:59.838766 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:59.838842 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:12:59.839136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.840328 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:59.840413 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:12:59.840715 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.842136 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:12:59.842223 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:59.842287 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:12:59.842905 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:59.843575 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:12:59.843650 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:12:59.844784 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:59.845385 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.845493 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:12:59.845670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105486c40>]}
14:12:59.845816 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:12:59.845987 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:12:59.846070 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:12:59.846163 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:12:59.846338 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:12:59.846409 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:12:59.846474 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:12:59.847064 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:12:59.847469 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.847615 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:12:59.848817 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:12:59.849066 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:59.849143 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:12:59.849213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.853104 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:59.853267 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:59.853349 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:12:59.855499 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:59.856779 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:59.856864 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:12:59.857207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.858144 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:59.858234 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:12:59.858514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.859032 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:12:59.859104 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:59.859168 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:12:59.859683 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:59.860342 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:12:59.860407 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:12:59.861549 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:59.862070 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.862171 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:12:59.862384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4f40>]}
14:12:59.862559 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:12:59.862758 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:12:59.862867 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:12:59.862989 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:12:59.863318 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:12:59.863402 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:12:59.863471 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:12:59.864095 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:12:59.864341 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.864414 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:12:59.865357 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:12:59.865542 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:59.865608 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:12:59.865670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.869914 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:12:59.870078 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:59.870145 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:12:59.872342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:59.873597 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:59.873681 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:12:59.874101 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.875145 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:59.875243 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:12:59.875606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.876161 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:12:59.876234 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:59.876297 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:12:59.876715 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:59.877397 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:12:59.877468 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:12:59.878748 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:59.879346 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.879432 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:12:59.879601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ae730>]}
14:12:59.879745 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:12:59.879912 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:12:59.879993 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:12:59.880086 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:12:59.880254 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:12:59.880324 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:12:59.880390 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:12:59.880885 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:12:59.881260 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.881384 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:12:59.882630 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:12:59.882962 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:59.883034 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:12:59.883097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.889882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:12:59.890011 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:59.890071 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:12:59.893356 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:12:59.894796 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:59.894913 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:12:59.895571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.897546 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:59.897630 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:12:59.898125 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:12:59.898684 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:12:59.898761 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:59.898824 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:12:59.899710 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:12:59.900433 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:12:59.900509 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:12:59.902626 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:12:59.903143 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.903249 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:12:59.903461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0b430>]}
14:12:59.903638 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:12:59.903835 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:12:59.903926 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:12:59.904073 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:12:59.904272 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:12:59.904344 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:12:59.904412 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:12:59.905867 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:12:59.906183 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.906264 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:12:59.916123 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:12:59.916415 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:12:59.916489 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:12:59.916551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:12:59.923097 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:12:59.923187 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:12:59.923252 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON accounts.account_id = payments.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT  
        accounts.account_name
        , lifetime_value
    FROM accounts
        LEFT OUTER JOIN lifetime_value
)

SELECT * FROM final
  );
14:12:59.923707 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 30: )
         ^

14:12:59.923782 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:12:59.924014 [debug] [Thread-1  ]: finished collecting timing info
14:12:59.924087 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:12:59.924230 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near ")"
  LINE 30: )
           ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:12:59.924357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd529476-a25a-4258-8094-39447991aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0f40>]}
14:12:59.924508 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:12:59.924685 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:12:59.925201 [debug] [MainThread]: Acquiring new postgres connection "master"
14:12:59.925307 [debug] [MainThread]: Using postgres connection "master"
14:12:59.925379 [debug] [MainThread]: On master: BEGIN
14:12:59.925445 [debug] [MainThread]: Opening a new connection, currently in state closed
14:12:59.929293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:12:59.929379 [debug] [MainThread]: On master: COMMIT
14:12:59.929441 [debug] [MainThread]: Using postgres connection "master"
14:12:59.929499 [debug] [MainThread]: On master: COMMIT
14:12:59.929642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:12:59.929709 [debug] [MainThread]: On master: Close
14:12:59.929859 [info ] [MainThread]: 
14:12:59.929973 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:12:59.930083 [debug] [MainThread]: Connection 'master' was properly closed.
14:12:59.930142 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:12:59.932438 [info ] [MainThread]: 
14:12:59.932567 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:12:59.932690 [info ] [MainThread]: 
14:12:59.932799 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:12:59.932906 [error] [MainThread]:   syntax error at or near ")"
14:12:59.933009 [error] [MainThread]:   LINE 30: )
14:12:59.933106 [error] [MainThread]:            ^
14:12:59.933203 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:12:59.933307 [info ] [MainThread]: 
14:12:59.933409 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:12:59.933550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fa2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fa610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ef190>]}


============================== 2022-05-27 14:13:53.157051 | b0b760ca-b0b2-4927-b3a9-933ebc95d918 ==============================
14:13:53.157074 [info ] [MainThread]: Running with dbt=1.1.0
14:13:53.157460 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:13:53.157572 [debug] [MainThread]: Tracking: tracking
14:13:53.172756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109dad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109dae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109dae50>]}
14:13:53.188699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:13:53.188981 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:13:53.195193 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:13:53.202477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:13:53.204772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cdb0d0>]}
14:13:53.207100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7a850>]}
14:13:53.207237 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:13:53.207371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7a820>]}
14:13:53.208078 [info ] [MainThread]: 
14:13:53.208293 [debug] [MainThread]: Acquiring new postgres connection "master"
14:13:53.208765 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:13:53.213352 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:13:53.213444 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:13:53.213518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:13:53.246832 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:13:53.247705 [debug] [ThreadPool]: On list_demo_destination: Close
14:13:53.248463 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:13:53.271450 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:13:53.271598 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:13:53.271664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:13:53.275905 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:13:53.275998 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:13:53.276066 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:13:53.280626 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:13:53.281243 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:13:53.281445 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:13:53.283547 [debug] [MainThread]: Using postgres connection "master"
14:13:53.283651 [debug] [MainThread]: On master: BEGIN
14:13:53.283726 [debug] [MainThread]: Opening a new connection, currently in state init
14:13:53.287203 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:13:53.287316 [debug] [MainThread]: Using postgres connection "master"
14:13:53.287380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:13:53.322190 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:13:53.322941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107730d0>]}
14:13:53.323109 [debug] [MainThread]: On master: ROLLBACK
14:13:53.323339 [debug] [MainThread]: Using postgres connection "master"
14:13:53.323417 [debug] [MainThread]: On master: BEGIN
14:13:53.323708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:13:53.323788 [debug] [MainThread]: On master: COMMIT
14:13:53.323863 [debug] [MainThread]: Using postgres connection "master"
14:13:53.323931 [debug] [MainThread]: On master: COMMIT
14:13:53.324101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:13:53.324184 [debug] [MainThread]: On master: Close
14:13:53.324352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:13:53.324498 [info ] [MainThread]: 
14:13:53.326084 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:13:53.326241 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:13:53.326474 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:13:53.326557 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:13:53.326637 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:13:53.327366 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:13:53.327698 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.327789 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:13:53.339536 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:13:53.339946 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:13:53.340031 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:13:53.340098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:53.344028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:13:53.344147 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:13:53.344211 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:13:53.347029 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:13:53.350055 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:13:53.350170 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:13:53.350568 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.351550 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:13:53.351624 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:13:53.351961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.354887 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:13:53.354973 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:13:53.355049 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:13:53.360960 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:13:53.363164 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:13:53.363247 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:13:53.371003 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:13:53.371527 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.371619 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:13:53.371812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7a490>]}
14:13:53.371985 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.05s]
14:13:53.372182 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:13:53.372277 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:13:53.372427 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:13:53.372666 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:13:53.372750 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:13:53.372826 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:13:53.373469 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:13:53.373732 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.373810 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:13:53.374895 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:13:53.375125 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:13:53.375198 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:13:53.375262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:53.378866 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:13:53.378957 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:13:53.379023 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:13:53.380624 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:13:53.381761 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:13:53.381845 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:13:53.382201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.383238 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:13:53.383313 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:13:53.383598 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.385036 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:13:53.385127 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:13:53.385201 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:13:53.385762 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:13:53.386441 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:13:53.386518 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:13:53.387481 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:13:53.388108 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.388231 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:13:53.388432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110738d90>]}
14:13:53.388601 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:13:53.388790 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:13:53.388881 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:13:53.389024 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:13:53.389220 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:13:53.389297 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:13:53.389368 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:13:53.390031 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:13:53.390320 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.390396 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:13:53.391419 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:13:53.391641 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:13:53.391718 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:13:53.391783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:53.396079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:13:53.396227 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:13:53.396300 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:13:53.399281 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:13:53.400495 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:13:53.400573 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:13:53.400987 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.402000 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:13:53.402077 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:13:53.402440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.403137 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:13:53.403223 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:13:53.403303 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:13:53.403815 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:13:53.404536 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:13:53.404621 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:13:53.405858 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:13:53.406498 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.406602 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:13:53.406802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100956a0>]}
14:13:53.406967 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:13:53.407161 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:13:53.407251 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:13:53.407348 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:13:53.407530 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:13:53.407605 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:13:53.407675 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:13:53.408361 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:13:53.408667 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.408751 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:13:53.409872 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:13:53.410188 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:13:53.410264 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:13:53.410326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:53.413894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:13:53.413985 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:13:53.414046 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:13:53.415638 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:13:53.416798 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:13:53.416878 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:13:53.417147 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.418118 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:13:53.418201 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:13:53.418545 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.419335 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:13:53.419485 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:13:53.419569 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:13:53.420097 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:13:53.420940 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:13:53.421033 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:13:53.422348 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:13:53.423083 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.423187 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:13:53.423402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110738910>]}
14:13:53.423575 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:13:53.423765 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:13:53.423854 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:13:53.423993 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:13:53.424180 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:13:53.424248 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:13:53.424318 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:13:53.424892 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:13:53.425171 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.425243 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:13:53.426360 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:13:53.426631 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:13:53.426702 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:13:53.426761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:53.430465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:13:53.430541 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:13:53.430600 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:13:53.437172 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:13:53.438460 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:13:53.438543 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:13:53.439065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.441117 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:13:53.441229 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:13:53.441528 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:13:53.442136 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:13:53.442222 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:13:53.442287 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:13:53.442974 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:13:53.443760 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:13:53.443831 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:13:53.444840 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:13:53.445392 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.445494 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:13:53.445697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110edd5b0>]}
14:13:53.445863 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:13:53.446057 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:13:53.446146 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:13:53.446246 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:13:53.446496 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:13:53.446580 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:13:53.446655 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:13:53.448143 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:13:53.448448 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.448530 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:13:53.459085 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:13:53.459454 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:13:53.459534 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:13:53.459601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:13:53.463486 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:13:53.463641 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:13:53.463713 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON accounts.account_id = payments.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT  
        accounts.account_name
        , lifetime_value
    FROM accounts
        LEFT OUTER JOIN lifetime_value ON lifetime_value.account_id = accounts.account_id
)

SELECT * FROM final
  );
14:13:53.465112 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column lifetime_value.account_id does not exist
LINE 29:         LEFT OUTER JOIN lifetime_value ON lifetime_value.acc...
                                                   ^

14:13:53.465225 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:13:53.465503 [debug] [Thread-1  ]: finished collecting timing info
14:13:53.465612 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:13:53.465785 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column lifetime_value.account_id does not exist
  LINE 29:         LEFT OUTER JOIN lifetime_value ON lifetime_value.acc...
                                                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:13:53.465920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0b760ca-b0b2-4927-b3a9-933ebc95d918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e929d0>]}
14:13:53.466095 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:13:53.466298 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:13:53.466880 [debug] [MainThread]: Acquiring new postgres connection "master"
14:13:53.466976 [debug] [MainThread]: Using postgres connection "master"
14:13:53.467040 [debug] [MainThread]: On master: BEGIN
14:13:53.467099 [debug] [MainThread]: Opening a new connection, currently in state closed
14:13:53.471161 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:13:53.471316 [debug] [MainThread]: On master: COMMIT
14:13:53.471386 [debug] [MainThread]: Using postgres connection "master"
14:13:53.471455 [debug] [MainThread]: On master: COMMIT
14:13:53.471609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:13:53.471712 [debug] [MainThread]: On master: Close
14:13:53.471908 [info ] [MainThread]: 
14:13:53.472038 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
14:13:53.472172 [debug] [MainThread]: Connection 'master' was properly closed.
14:13:53.472231 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:13:53.474574 [info ] [MainThread]: 
14:13:53.474733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:13:53.474853 [info ] [MainThread]: 
14:13:53.474957 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:13:53.475058 [error] [MainThread]:   column lifetime_value.account_id does not exist
14:13:53.475156 [error] [MainThread]:   LINE 29:         LEFT OUTER JOIN lifetime_value ON lifetime_value.acc...
14:13:53.475251 [error] [MainThread]:                                                      ^
14:13:53.475348 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:13:53.475451 [info ] [MainThread]: 
14:13:53.475548 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:13:53.475689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110738a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110738be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c03d0>]}


============================== 2022-05-27 14:14:09.635583 | 113bb764-6419-4aa7-b635-c00b96903f58 ==============================
14:14:09.635625 [info ] [MainThread]: Running with dbt=1.1.0
14:14:09.636037 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:14:09.636134 [debug] [MainThread]: Tracking: tracking
14:14:09.652156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dad90>]}
14:14:09.668332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:14:09.668559 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:14:09.674679 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:14:09.681947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:14:09.684241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc80d0>]}
14:14:09.686497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67e50>]}
14:14:09.686636 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:14:09.686772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67ee0>]}
14:14:09.687469 [info ] [MainThread]: 
14:14:09.687678 [debug] [MainThread]: Acquiring new postgres connection "master"
14:14:09.688159 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:14:09.693053 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:14:09.693227 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:14:09.693308 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:14:09.718239 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:14:09.719202 [debug] [ThreadPool]: On list_demo_destination: Close
14:14:09.719834 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:14:09.743111 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:14:09.743310 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:14:09.743383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:14:09.747951 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:14:09.748056 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:14:09.748125 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:14:09.751028 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:14:09.751615 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:14:09.751826 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:14:09.753782 [debug] [MainThread]: Using postgres connection "master"
14:14:09.753880 [debug] [MainThread]: On master: BEGIN
14:14:09.753948 [debug] [MainThread]: Opening a new connection, currently in state init
14:14:09.759125 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:14:09.759206 [debug] [MainThread]: Using postgres connection "master"
14:14:09.759272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:14:09.793974 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:14:09.794680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106029d30>]}
14:14:09.794844 [debug] [MainThread]: On master: ROLLBACK
14:14:09.795064 [debug] [MainThread]: Using postgres connection "master"
14:14:09.795144 [debug] [MainThread]: On master: BEGIN
14:14:09.795448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:14:09.795526 [debug] [MainThread]: On master: COMMIT
14:14:09.795601 [debug] [MainThread]: Using postgres connection "master"
14:14:09.795670 [debug] [MainThread]: On master: COMMIT
14:14:09.795846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:14:09.795924 [debug] [MainThread]: On master: Close
14:14:09.796089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:14:09.796233 [info ] [MainThread]: 
14:14:09.797759 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:14:09.797922 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:14:09.798163 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:14:09.798250 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:14:09.798334 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:14:09.799064 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:14:09.799395 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.799486 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:14:09.811943 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:14:09.812359 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:14:09.812445 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:14:09.812518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:09.815091 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:14:09.815246 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:14:09.815328 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:14:09.816226 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:14:09.819654 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:14:09.819788 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:14:09.820126 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.821365 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:14:09.821466 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:14:09.821732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.825087 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:14:09.825187 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:14:09.825259 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:14:09.825791 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:14:09.828093 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:14:09.828195 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:14:09.828763 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:14:09.829292 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.829397 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:14:09.829607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb17c0>]}
14:14:09.829779 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:14:09.829983 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:14:09.830081 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:14:09.830244 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:14:09.830518 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:14:09.830628 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:14:09.830701 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:14:09.831362 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:14:09.831602 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.831678 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:14:09.832728 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:14:09.832938 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:14:09.833006 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:14:09.833072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:09.837331 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:14:09.837442 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:14:09.837510 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:14:09.839385 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:14:09.840659 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:14:09.840772 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:14:09.841159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.842214 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:14:09.842290 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:14:09.842593 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.843986 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:14:09.844085 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:14:09.844150 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:14:09.844485 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:14:09.845206 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:14:09.845302 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:14:09.846284 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:14:09.846828 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.846919 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:14:09.847114 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108778700>]}
14:14:09.847276 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:14:09.847464 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:14:09.847553 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:14:09.847696 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:14:09.847923 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:14:09.848004 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:14:09.848075 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:14:09.848746 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:14:09.849052 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.849128 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:14:09.850164 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:14:09.850374 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:14:09.850442 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:14:09.850509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:09.854286 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:14:09.854401 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:14:09.854465 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:14:09.855962 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:14:09.857224 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:14:09.857350 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:14:09.857662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.858884 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:14:09.859008 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:14:09.859612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.860206 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:14:09.860282 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:14:09.860343 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:14:09.860984 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:14:09.861748 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:14:09.861832 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:14:09.862836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:14:09.863426 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.863535 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:14:09.863740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087785b0>]}
14:14:09.863911 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:14:09.864114 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:14:09.864206 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:14:09.864361 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:14:09.864654 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:14:09.864762 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:14:09.864830 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:14:09.865567 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:14:09.865895 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.866013 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:14:09.867159 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:14:09.867417 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:14:09.867494 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:14:09.867557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:09.871296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:14:09.871404 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:14:09.871473 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:14:09.873116 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:14:09.874329 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:14:09.874427 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:14:09.874890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.876231 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:14:09.876340 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:14:09.876729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.877319 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:14:09.877398 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:14:09.877460 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:14:09.878313 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:14:09.879007 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:14:09.879092 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:14:09.880569 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:14:09.881296 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.881407 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:14:09.881617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbd550>]}
14:14:09.881783 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:14:09.881990 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:14:09.882082 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:14:09.882230 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:14:09.882429 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:14:09.882500 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:14:09.882568 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:14:09.883118 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:14:09.883408 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.883483 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:14:09.884506 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:14:09.884724 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:14:09.884795 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:14:09.884856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:09.889854 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:14:09.889954 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:14:09.890013 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:14:09.893308 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:14:09.894633 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:14:09.894764 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:14:09.895330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.897124 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:14:09.897208 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:14:09.897725 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:14:09.898302 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:14:09.898393 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:14:09.898458 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:14:09.899051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:14:09.899839 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:14:09.899920 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:14:09.901452 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:14:09.901973 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.902071 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:14:09.902266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd5cd0>]}
14:14:09.902427 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:14:09.902631 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:14:09.902724 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:14:09.902828 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:14:09.903100 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:14:09.903178 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:14:09.903249 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:14:09.904628 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:14:09.904926 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.905008 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:14:09.915314 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:14:09.915722 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:14:09.915800 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:14:09.915866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:14:09.922572 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:14:09.922706 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:14:09.922775 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

WITH accounts AS (
    SELECT * FROM "demo_destination"."public"."stg_accounts"
),

payments AS (
    SELECT * FROM "demo_destination"."public"."stg_payments"
),

plans as (
    SELECT * FROM "demo_destination"."public"."stg_plans"
),

lifetime_value as (
    SELECT sum(payments.amount) FROM payments INNER JOIN accounts ON accounts.account_id = payments.account_id GROUP BY accounts.account_id
),

final AS (
    SELECT  
        accounts.account_name
        , lifetime_value
    FROM accounts
        LEFT OUTER JOIN lifetime_value ON accounts.account_id
)

SELECT * FROM final
  );
14:14:09.924844 [debug] [Thread-1  ]: Postgres adapter: Postgres error: argument of JOIN/ON must be type boolean, not type double precision
LINE 29:         LEFT OUTER JOIN lifetime_value ON accounts.account_i...
                                                   ^

14:14:09.924929 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:14:09.925190 [debug] [Thread-1  ]: finished collecting timing info
14:14:09.925274 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:14:09.925430 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  argument of JOIN/ON must be type boolean, not type double precision
  LINE 29:         LEFT OUTER JOIN lifetime_value ON accounts.account_i...
                                                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:14:09.925569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113bb764-6419-4aa7-b635-c00b96903f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c75100>]}
14:14:09.925743 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:14:09.925959 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:14:09.926518 [debug] [MainThread]: Acquiring new postgres connection "master"
14:14:09.926607 [debug] [MainThread]: Using postgres connection "master"
14:14:09.926670 [debug] [MainThread]: On master: BEGIN
14:14:09.926731 [debug] [MainThread]: Opening a new connection, currently in state closed
14:14:09.932312 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:14:09.932394 [debug] [MainThread]: On master: COMMIT
14:14:09.932460 [debug] [MainThread]: Using postgres connection "master"
14:14:09.932519 [debug] [MainThread]: On master: COMMIT
14:14:09.932690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:14:09.932761 [debug] [MainThread]: On master: Close
14:14:09.932915 [info ] [MainThread]: 
14:14:09.933032 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:14:09.933141 [debug] [MainThread]: Connection 'master' was properly closed.
14:14:09.933200 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:14:09.935745 [info ] [MainThread]: 
14:14:09.935869 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:14:09.935991 [info ] [MainThread]: 
14:14:09.936095 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:14:09.936198 [error] [MainThread]:   argument of JOIN/ON must be type boolean, not type double precision
14:14:09.936296 [error] [MainThread]:   LINE 29:         LEFT OUTER JOIN lifetime_value ON accounts.account_i...
14:14:09.936401 [error] [MainThread]:                                                      ^
14:14:09.936500 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:14:09.936607 [info ] [MainThread]: 
14:14:09.936728 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:14:09.936874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087788b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087787c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781d400>]}


============================== 2022-05-27 14:28:03.832090 | c35d857a-c2b9-49e6-b304-aaaf5769f209 ==============================
14:28:03.832105 [info ] [MainThread]: Running with dbt=1.1.0
14:28:03.832496 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:28:03.832592 [debug] [MainThread]: Tracking: tracking
14:28:03.849713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5beb0>]}
14:28:03.865223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:28:03.865447 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:28:03.871260 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:28:03.879493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:28:03.882004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113143ee0>]}
14:28:03.884862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130daeb0>]}
14:28:03.885039 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:28:03.885183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f2ebe0>]}
14:28:03.885926 [info ] [MainThread]: 
14:28:03.886166 [debug] [MainThread]: Acquiring new postgres connection "master"
14:28:03.886684 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:28:03.891767 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:28:03.891922 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:28:03.892009 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:28:03.922247 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:28:03.923110 [debug] [ThreadPool]: On list_demo_destination: Close
14:28:03.923853 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:28:03.946806 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:28:03.947007 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:28:03.947076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:28:03.953064 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:28:03.953180 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:28:03.953249 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:28:03.958857 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:28:03.959593 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:28:03.959844 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:28:03.962162 [debug] [MainThread]: Using postgres connection "master"
14:28:03.962320 [debug] [MainThread]: On master: BEGIN
14:28:03.962395 [debug] [MainThread]: Opening a new connection, currently in state init
14:28:03.965780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:28:03.965919 [debug] [MainThread]: Using postgres connection "master"
14:28:03.965998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:28:03.990345 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
14:28:03.991260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f752b0>]}
14:28:03.991453 [debug] [MainThread]: On master: ROLLBACK
14:28:03.991722 [debug] [MainThread]: Using postgres connection "master"
14:28:03.991799 [debug] [MainThread]: On master: BEGIN
14:28:03.992205 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:28:03.992296 [debug] [MainThread]: On master: COMMIT
14:28:03.992368 [debug] [MainThread]: Using postgres connection "master"
14:28:03.992433 [debug] [MainThread]: On master: COMMIT
14:28:03.992624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:28:03.992729 [debug] [MainThread]: On master: Close
14:28:03.992908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:28:03.993045 [info ] [MainThread]: 
14:28:03.994659 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:28:03.994850 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:28:03.995087 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:28:03.995167 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:28:03.995251 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:28:03.995899 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:28:03.996189 [debug] [Thread-1  ]: finished collecting timing info
14:28:03.996265 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:28:04.007510 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:28:04.007895 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:28:04.007976 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:28:04.008042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:04.012001 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:28:04.012114 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:28:04.012180 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:28:04.013155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:28:04.016286 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:28:04.016384 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:28:04.016681 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.017682 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:28:04.017776 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:28:04.018377 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.021752 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:28:04.021881 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:28:04.021954 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:28:04.022847 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:28:04.025276 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:28:04.025411 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:28:04.026613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:28:04.027262 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.027375 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:28:04.027589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131437f0>]}
14:28:04.027770 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:28:04.027978 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:28:04.028070 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:28:04.028236 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:28:04.028491 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:28:04.028588 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:28:04.028692 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:28:04.029398 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:28:04.029689 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.029765 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:28:04.030891 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:28:04.031095 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:28:04.031164 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:28:04.031225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:04.036197 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:28:04.036302 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:28:04.036368 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:28:04.038208 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:28:04.039428 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:28:04.039510 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:28:04.041331 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.042455 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:28:04.042545 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:28:04.042978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.044442 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:28:04.044542 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:28:04.044604 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:28:04.045112 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:28:04.045809 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:28:04.045878 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:28:04.047061 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:28:04.047591 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.047684 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:28:04.047866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf8c40>]}
14:28:04.048046 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:28:04.048263 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:28:04.048359 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:28:04.048462 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:28:04.048815 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:28:04.048900 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:28:04.048969 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:28:04.049620 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:28:04.049877 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.049951 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:28:04.050923 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:28:04.051126 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:28:04.051191 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:28:04.051248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:04.056093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:28:04.056225 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:28:04.056330 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:28:04.059693 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:28:04.060905 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:28:04.060989 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:28:04.061420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.062429 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:28:04.062511 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:28:04.062958 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.063529 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:28:04.063601 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:28:04.063664 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:28:04.064349 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:28:04.065202 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:28:04.065283 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:28:04.066351 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:28:04.066972 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.067109 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:28:04.067333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131da280>]}
14:28:04.067517 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:28:04.067768 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:28:04.067882 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:28:04.068004 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:28:04.068214 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:28:04.068287 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:28:04.068479 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:28:04.069268 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:28:04.069588 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.069668 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:28:04.070739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:28:04.070995 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:28:04.071064 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:28:04.071126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:04.075165 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:28:04.075296 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:28:04.075364 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:28:04.078032 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:28:04.079129 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:28:04.079205 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:28:04.079829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.081077 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:28:04.081185 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:28:04.081474 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.082164 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:28:04.082248 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:28:04.082312 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:28:04.082708 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:28:04.083503 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:28:04.083585 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:28:04.085482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:28:04.086050 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.086136 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:28:04.086335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c0490>]}
14:28:04.086506 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:28:04.086699 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:28:04.086788 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:28:04.086885 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:28:04.087075 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:28:04.087150 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:28:04.087222 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:28:04.087767 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:28:04.088059 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.088136 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:28:04.089251 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:28:04.089533 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:28:04.089602 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:28:04.089663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:04.094655 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:28:04.094734 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:28:04.094794 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:28:04.098351 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:28:04.099472 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:28:04.099565 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:28:04.100178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.101917 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:28:04.101990 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:28:04.102387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:28:04.102890 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:28:04.102957 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:28:04.103015 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:28:04.103693 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:28:04.104368 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:28:04.104435 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:28:04.105815 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:28:04.106258 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.106337 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:28:04.106502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113237ac0>]}
14:28:04.106651 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:28:04.106822 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:28:04.106907 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:28:04.107036 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:28:04.107245 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:28:04.107318 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:28:04.107384 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:28:04.108760 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:28:04.109028 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.109103 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:28:04.118831 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:28:04.119068 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:28:04.119136 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:28:04.119201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:28:04.124696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:28:04.124792 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:28:04.124865 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select

),

final as (
    select  
        accounts.account_name
        , customer_payments
    from accounts

)

select * from final
  );
14:28:04.125470 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "customer_payments" does not exist
LINE 28:         , customer_payments
                   ^

14:28:04.125552 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:28:04.125754 [debug] [Thread-1  ]: finished collecting timing info
14:28:04.125830 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:28:04.125974 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "customer_payments" does not exist
  LINE 28:         , customer_payments
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:28:04.126085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c35d857a-c2b9-49e6-b304-aaaf5769f209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131da9a0>]}
14:28:04.126230 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:28:04.126405 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:28:04.126858 [debug] [MainThread]: Acquiring new postgres connection "master"
14:28:04.126954 [debug] [MainThread]: Using postgres connection "master"
14:28:04.127017 [debug] [MainThread]: On master: BEGIN
14:28:04.127075 [debug] [MainThread]: Opening a new connection, currently in state closed
14:28:04.131008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:28:04.131102 [debug] [MainThread]: On master: COMMIT
14:28:04.131163 [debug] [MainThread]: Using postgres connection "master"
14:28:04.131219 [debug] [MainThread]: On master: COMMIT
14:28:04.131410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:28:04.131476 [debug] [MainThread]: On master: Close
14:28:04.131623 [info ] [MainThread]: 
14:28:04.131736 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:28:04.131859 [debug] [MainThread]: Connection 'master' was properly closed.
14:28:04.131938 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:28:04.134291 [info ] [MainThread]: 
14:28:04.134422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:28:04.134544 [info ] [MainThread]: 
14:28:04.134649 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:28:04.134754 [error] [MainThread]:   column "customer_payments" does not exist
14:28:04.134854 [error] [MainThread]:   LINE 28:         , customer_payments
14:28:04.134953 [error] [MainThread]:                      ^
14:28:04.135051 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:28:04.135191 [info ] [MainThread]: 
14:28:04.135309 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:28:04.135487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cf8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f401f0>]}


============================== 2022-05-27 14:30:00.918033 | a6e23304-3a38-4e3d-9a8c-924b9fba9714 ==============================
14:30:00.918075 [info ] [MainThread]: Running with dbt=1.1.0
14:30:00.918516 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:00.918754 [debug] [MainThread]: Tracking: tracking
14:30:00.933383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1ad60>]}
14:30:00.949402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:00.949652 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:30:00.955478 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:30:00.962679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:30:00.965157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d090d0>]}
14:30:00.967784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca7e50>]}
14:30:00.967969 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:00.968125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca7ee0>]}
14:30:00.968908 [info ] [MainThread]: 
14:30:00.969162 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:00.969718 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:30:00.974648 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:30:00.974810 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:30:00.974891 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:00.995811 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:30:00.996782 [debug] [ThreadPool]: On list_demo_destination: Close
14:30:00.997421 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:30:01.019719 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:30:01.019872 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:30:01.019945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:30:01.026809 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:30:01.026913 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:30:01.026983 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:01.032488 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:30:01.033112 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:30:01.033397 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:30:01.035655 [debug] [MainThread]: Using postgres connection "master"
14:30:01.035805 [debug] [MainThread]: On master: BEGIN
14:30:01.035878 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:01.039309 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:01.039451 [debug] [MainThread]: Using postgres connection "master"
14:30:01.039533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:01.069963 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:30:01.070810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486c760>]}
14:30:01.070976 [debug] [MainThread]: On master: ROLLBACK
14:30:01.071222 [debug] [MainThread]: Using postgres connection "master"
14:30:01.071318 [debug] [MainThread]: On master: BEGIN
14:30:01.071646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:01.071728 [debug] [MainThread]: On master: COMMIT
14:30:01.071801 [debug] [MainThread]: Using postgres connection "master"
14:30:01.071864 [debug] [MainThread]: On master: COMMIT
14:30:01.072037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:01.072120 [debug] [MainThread]: On master: Close
14:30:01.072297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:30:01.072433 [info ] [MainThread]: 
14:30:01.074010 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:30:01.074157 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:30:01.074385 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:30:01.074468 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:30:01.074540 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:30:01.075241 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:30:01.075544 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.075622 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:30:01.087414 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:30:01.087830 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:01.087909 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:30:01.087978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:01.092020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:01.092176 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:01.092264 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:30:01.094084 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:01.097173 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:01.097275 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:30:01.097680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.098933 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:01.099042 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:30:01.099368 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.102682 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:30:01.102775 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:01.102845 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:30:01.103430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:01.105611 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:01.105695 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:30:01.106760 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:01.107248 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.107338 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:30:01.107520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7ce20>]}
14:30:01.107694 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:30:01.107890 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:30:01.107985 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:30:01.108086 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:30:01.108316 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:30:01.108397 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:30:01.108469 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:30:01.109191 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:30:01.109549 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.109633 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:30:01.110726 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:30:01.110940 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:01.111026 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:30:01.111090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:01.114939 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:01.115059 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:01.115126 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:30:01.117589 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:01.118883 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:01.118961 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:30:01.119697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.120625 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:01.120701 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:30:01.121039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.122387 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:30:01.122461 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:01.122524 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:30:01.123243 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:01.123891 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:01.123960 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:30:01.125258 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:01.125712 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.125800 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:30:01.125987 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b9670>]}
14:30:01.126156 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:30:01.126369 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:30:01.126465 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:30:01.126619 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:30:01.126855 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:30:01.126933 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:30:01.127006 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:30:01.127696 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:30:01.127985 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.128062 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:30:01.129091 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:30:01.129368 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:01.129440 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:30:01.129504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:01.133998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:01.134127 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:01.134207 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:30:01.136631 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:01.137867 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:01.137961 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:30:01.138370 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.139376 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:01.139447 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:30:01.139788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.140322 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:30:01.140393 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:01.140454 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:30:01.140902 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:01.141750 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:01.141851 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:30:01.143434 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:01.144135 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.144239 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:30:01.144448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b99a0>]}
14:30:01.144620 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:30:01.144823 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:30:01.144920 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:30:01.145090 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:30:01.145351 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:30:01.145424 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:30:01.145496 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:30:01.146217 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:30:01.146509 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.146594 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:30:01.147686 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:30:01.147889 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:01.147958 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:30:01.148019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:01.153946 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:01.154059 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:01.154128 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:30:01.157477 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:01.158777 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:01.158866 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:30:01.159509 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.160678 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:01.160794 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:30:01.161343 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.161934 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:30:01.162011 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:01.162077 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:30:01.162639 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:01.163364 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:01.163462 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:30:01.164412 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:01.165033 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.165130 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:30:01.165326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b9b20>]}
14:30:01.165492 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:30:01.165686 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:30:01.165811 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:30:01.165968 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:30:01.166174 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:30:01.166248 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:30:01.166319 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:30:01.166889 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:30:01.167174 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.167250 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:30:01.168322 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:30:01.168575 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:01.168716 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:30:01.168795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:01.181008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:01.181173 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:01.181245 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:30:01.183678 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:01.185100 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:01.185219 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:30:01.185619 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.187480 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:01.187597 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:30:01.187892 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:01.188485 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:30:01.188563 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:01.188627 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:30:01.189219 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:01.190084 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:01.190175 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:30:01.191218 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:01.191740 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.191847 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:30:01.192054 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0b4c0>]}
14:30:01.192225 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.03s]
14:30:01.192419 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:30:01.192652 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:30:01.192794 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:30:01.193030 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:30:01.193171 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:30:01.193295 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:30:01.194855 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:30:01.195225 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.195317 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:30:01.205468 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:30:01.205759 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:30:01.205831 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:30:01.205896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:01.211343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:01.211436 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:30:01.211499 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id
    , sum( amount ) as total_payment

    from payments
),

final as (
    select  
        accounts.account_name
        , customer_payments
    from accounts

)

select * from final
  );
14:30:01.212717 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "payments.account_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 21:     select account_id
                    ^

14:30:01.212814 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:30:01.213075 [debug] [Thread-1  ]: finished collecting timing info
14:30:01.213159 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:30:01.213326 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "payments.account_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 21:     select account_id
                      ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:30:01.213456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e23304-3a38-4e3d-9a8c-924b9fba9714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da3130>]}
14:30:01.213620 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:30:01.213825 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:30:01.214638 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:01.214753 [debug] [MainThread]: Using postgres connection "master"
14:30:01.214823 [debug] [MainThread]: On master: BEGIN
14:30:01.214886 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:01.218491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:01.218612 [debug] [MainThread]: On master: COMMIT
14:30:01.218682 [debug] [MainThread]: Using postgres connection "master"
14:30:01.218746 [debug] [MainThread]: On master: COMMIT
14:30:01.218897 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:01.218989 [debug] [MainThread]: On master: Close
14:30:01.219162 [info ] [MainThread]: 
14:30:01.219289 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:30:01.219501 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:01.219567 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:30:01.221894 [info ] [MainThread]: 
14:30:01.222026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:30:01.222150 [info ] [MainThread]: 
14:30:01.222256 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:30:01.222360 [error] [MainThread]:   column "payments.account_id" must appear in the GROUP BY clause or be used in an aggregate function
14:30:01.222461 [error] [MainThread]:   LINE 21:     select account_id
14:30:01.222559 [error] [MainThread]:                       ^
14:30:01.222658 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:30:01.222763 [info ] [MainThread]: 
14:30:01.222864 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:30:01.223002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b004f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10070d6d0>]}


============================== 2022-05-27 14:30:46.224460 | c85f9430-42e2-4012-9f7f-0fff960b809f ==============================
14:30:46.224497 [info ] [MainThread]: Running with dbt=1.1.0
14:30:46.224939 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:46.225026 [debug] [MainThread]: Tracking: tracking
14:30:46.239809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8ca0>]}
14:30:46.256265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:46.256522 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:30:46.262656 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:30:46.270335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:30:46.272710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db90d0>]}
14:30:46.275066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d58e50>]}
14:30:46.275208 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:46.275341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9d520>]}
14:30:46.276058 [info ] [MainThread]: 
14:30:46.276286 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:46.276770 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:30:46.281922 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:30:46.282098 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:30:46.282192 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:46.320710 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
14:30:46.321770 [debug] [ThreadPool]: On list_demo_destination: Close
14:30:46.322487 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:30:46.346418 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:30:46.346569 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:30:46.346640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:30:46.351856 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:30:46.351957 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:30:46.352022 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:46.354937 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:30:46.355582 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:30:46.355832 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:30:46.357884 [debug] [MainThread]: Using postgres connection "master"
14:30:46.357993 [debug] [MainThread]: On master: BEGIN
14:30:46.358061 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:46.361270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:46.361355 [debug] [MainThread]: Using postgres connection "master"
14:30:46.361419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:46.387408 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:30:46.388193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104626b50>]}
14:30:46.388367 [debug] [MainThread]: On master: ROLLBACK
14:30:46.388647 [debug] [MainThread]: Using postgres connection "master"
14:30:46.388761 [debug] [MainThread]: On master: BEGIN
14:30:46.389068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:46.389152 [debug] [MainThread]: On master: COMMIT
14:30:46.389228 [debug] [MainThread]: Using postgres connection "master"
14:30:46.389293 [debug] [MainThread]: On master: COMMIT
14:30:46.389472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:46.389554 [debug] [MainThread]: On master: Close
14:30:46.389728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:30:46.389872 [info ] [MainThread]: 
14:30:46.391479 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:30:46.391683 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:30:46.391938 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:30:46.392027 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:30:46.392109 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:30:46.392898 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:30:46.393289 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.393380 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:30:46.405127 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:30:46.405489 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:46.405570 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:30:46.405634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.410292 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:46.410384 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:46.410445 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:30:46.413124 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:46.416470 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:46.416592 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:30:46.416997 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.418027 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:46.418103 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:30:46.418431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.421582 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:30:46.421671 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:46.421738 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:30:46.422360 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:46.424703 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:30:46.424848 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:30:46.425865 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:46.426538 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.426649 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:30:46.426884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936fa0>]}
14:30:46.427068 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:30:46.427294 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:30:46.427401 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:30:46.427571 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:30:46.427788 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:30:46.427863 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:30:46.427934 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:30:46.428624 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:30:46.428929 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.429011 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:30:46.430107 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:30:46.430341 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:46.430413 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:30:46.430474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.434811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:46.434941 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:46.435007 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:30:46.438594 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:46.439820 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:46.439927 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:30:46.440352 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.441287 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:46.441367 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:30:46.442162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.443561 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:30:46.443637 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:46.443698 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:30:46.444339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:46.445031 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:30:46.445109 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:30:46.446534 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:46.446994 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.447079 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:30:46.447257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7cfd0>]}
14:30:46.447415 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:30:46.447598 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:30:46.447684 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:30:46.447824 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:30:46.448016 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:30:46.448088 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:30:46.448154 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:30:46.448763 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:30:46.449012 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.449084 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:30:46.450065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:30:46.450268 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:46.450331 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:30:46.450392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.454632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:46.454774 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:46.454836 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:30:46.457153 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:46.458316 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:46.458402 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:30:46.458846 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.459879 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:46.459958 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:30:46.460413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.460949 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:30:46.461014 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:46.461071 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:30:46.461572 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:46.462223 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:30:46.462292 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:30:46.463452 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:46.463940 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.464032 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:30:46.464225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1eb50>]}
14:30:46.464393 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:30:46.464596 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:30:46.464710 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:30:46.464876 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:30:46.465116 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:30:46.465187 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:30:46.465256 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:30:46.465900 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:30:46.466149 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.466225 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:30:46.467266 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:30:46.467598 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:46.467669 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:30:46.467730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.471759 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:46.471903 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:46.471965 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:30:46.474900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:46.476149 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:46.476228 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:30:46.477091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.478140 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:46.478231 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:30:46.478540 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.479242 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:30:46.479330 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:46.479393 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:30:46.480012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:46.480876 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:30:46.481002 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:30:46.483044 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:46.483671 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.483768 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:30:46.483962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4ddc0>]}
14:30:46.484128 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:30:46.484322 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:30:46.484419 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:30:46.484517 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:30:46.484743 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:30:46.484815 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:30:46.484881 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:30:46.485408 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:30:46.485699 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.485770 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:30:46.486794 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:30:46.486992 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:46.487057 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:30:46.487113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.492666 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:46.492741 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:46.492805 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:30:46.496586 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:46.497674 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:46.497764 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:30:46.498312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.500005 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:46.500078 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:30:46.500451 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:46.500977 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:30:46.501048 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:46.501108 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:30:46.501580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:30:46.502271 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:30:46.502341 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:30:46.503482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:46.504054 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.504159 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:30:46.504341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069365b0>]}
14:30:46.504500 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:30:46.504760 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:30:46.504877 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:30:46.505036 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:30:46.505279 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:30:46.505359 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:30:46.505428 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:30:46.506985 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:30:46.507363 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.507453 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:30:46.517619 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:30:46.517928 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:30:46.517995 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:30:46.518053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.523740 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:46.523893 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:30:46.523964 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id
    , sum( amount ) as total_payment
    from payments

    group by account_id
),

final as (
    select  
        accounts.account_name
        , customer_payments
    from accounts

)

select * from final
  );
14:30:46.525492 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "customer_payments" does not exist
LINE 31:         , customer_payments
                   ^

14:30:46.525591 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:30:46.525856 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.525945 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:30:46.526099 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "customer_payments" does not exist
  LINE 31:         , customer_payments
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:30:46.526225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85f9430-42e2-4012-9f7f-0fff960b809f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9cfa0>]}
14:30:46.526417 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:30:46.526615 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:30:46.527126 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:46.527227 [debug] [MainThread]: Using postgres connection "master"
14:30:46.527293 [debug] [MainThread]: On master: BEGIN
14:30:46.527352 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:46.532908 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:46.533015 [debug] [MainThread]: On master: COMMIT
14:30:46.533079 [debug] [MainThread]: Using postgres connection "master"
14:30:46.533136 [debug] [MainThread]: On master: COMMIT
14:30:46.533335 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:46.533405 [debug] [MainThread]: On master: Close
14:30:46.533589 [info ] [MainThread]: 
14:30:46.533724 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
14:30:46.533853 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:46.533922 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:30:46.536236 [info ] [MainThread]: 
14:30:46.536374 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:30:46.536496 [info ] [MainThread]: 
14:30:46.536600 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:30:46.536702 [error] [MainThread]:   column "customer_payments" does not exist
14:30:46.536800 [error] [MainThread]:   LINE 31:         , customer_payments
14:30:46.536895 [error] [MainThread]:                      ^
14:30:46.536990 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:30:46.537093 [info ] [MainThread]: 
14:30:46.537192 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:30:46.537341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0220>]}


============================== 2022-05-27 14:31:18.684044 | 8f637ea4-2eaa-4ec5-9522-bba265546f5e ==============================
14:31:18.684089 [info ] [MainThread]: Running with dbt=1.1.0
14:31:18.684562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:31:18.684674 [debug] [MainThread]: Tracking: tracking
14:31:18.699213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068330d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106833070>]}
14:31:18.715420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:31:18.715722 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:31:18.721777 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:31:18.728887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:31:18.731198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b15f40>]}
14:31:18.733426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699ef70>]}
14:31:18.733558 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:31:18.733682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699afa0>]}
14:31:18.734379 [info ] [MainThread]: 
14:31:18.734592 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:18.735069 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:31:18.739565 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:31:18.739659 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:31:18.739752 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:31:18.764573 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:31:18.765454 [debug] [ThreadPool]: On list_demo_destination: Close
14:31:18.766053 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:31:18.788857 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:31:18.789008 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:31:18.789075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:31:18.794519 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:31:18.794610 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:31:18.794672 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:31:18.800130 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:31:18.800730 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:31:18.800979 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:31:18.802892 [debug] [MainThread]: Using postgres connection "master"
14:31:18.802985 [debug] [MainThread]: On master: BEGIN
14:31:18.803049 [debug] [MainThread]: Opening a new connection, currently in state init
14:31:18.806876 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:18.806957 [debug] [MainThread]: Using postgres connection "master"
14:31:18.807022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:31:18.836871 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:31:18.837618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ec250>]}
14:31:18.837787 [debug] [MainThread]: On master: ROLLBACK
14:31:18.838012 [debug] [MainThread]: Using postgres connection "master"
14:31:18.838095 [debug] [MainThread]: On master: BEGIN
14:31:18.838411 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:18.838494 [debug] [MainThread]: On master: COMMIT
14:31:18.838571 [debug] [MainThread]: Using postgres connection "master"
14:31:18.838639 [debug] [MainThread]: On master: COMMIT
14:31:18.838818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:18.838898 [debug] [MainThread]: On master: Close
14:31:18.839062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:31:18.839208 [info ] [MainThread]: 
14:31:18.840725 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:31:18.840892 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:31:18.841140 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:31:18.841227 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:31:18.841308 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:31:18.842034 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:31:18.842335 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.842416 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:31:18.853843 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:31:18.854232 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:18.854308 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:31:18.854373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:18.857008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:18.857109 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:18.857180 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:31:18.858197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:18.861337 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:18.861478 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:31:18.861768 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.862986 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:18.863068 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:31:18.863294 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.866547 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:31:18.866651 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:18.866715 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:31:18.867295 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:18.869424 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:18.869507 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:31:18.876077 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:31:18.876620 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.876712 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:31:18.876913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bee20>]}
14:31:18.877096 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.04s]
14:31:18.877307 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:31:18.877395 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:31:18.877541 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:31:18.877754 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:31:18.877831 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:31:18.877905 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:31:18.878536 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:31:18.878790 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.878865 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:31:18.879893 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:31:18.880076 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:18.880144 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:31:18.880211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:18.885218 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:31:18.885306 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:18.885370 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:31:18.887827 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:18.888949 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:18.889041 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:31:18.890651 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.891634 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:18.891716 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:31:18.892058 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.893549 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:31:18.893648 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:18.893713 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:31:18.894320 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:18.895047 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:18.895119 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:31:18.896118 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:18.896584 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.896668 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:31:18.896848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be3910>]}
14:31:18.897001 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:31:18.897187 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:31:18.897275 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:31:18.897415 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:31:18.897616 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:31:18.897691 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:31:18.897762 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:31:18.898390 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:31:18.898681 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.898760 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:31:18.899743 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:31:18.899974 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:18.900044 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:31:18.900105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:18.912314 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:31:18.912494 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:18.912571 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:31:18.914350 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:18.915681 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:18.915771 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:31:18.916108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.917180 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:18.917265 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:31:18.931016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:31:18.931696 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:31:18.931794 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:18.931865 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:31:18.932569 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:18.933444 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:18.933539 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:31:18.934535 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:18.935076 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.935183 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:31:18.935400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bae3a0>]}
14:31:18.935573 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.04s]
14:31:18.935784 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:31:18.936046 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:31:18.936200 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:31:18.936472 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:31:18.936560 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:31:18.936640 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:31:18.937403 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:31:18.937896 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.938007 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:31:18.939317 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:31:18.939577 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:18.939654 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:31:18.939721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:18.943566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:18.943702 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:18.943779 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:31:18.945677 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:18.946982 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:18.947074 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:31:18.947484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.948545 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:18.948627 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:31:18.948961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.949789 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:31:18.949883 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:18.949953 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:31:18.950626 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:18.951544 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:18.951637 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:31:18.952554 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:18.953315 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.953423 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:31:18.953641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbf4f0>]}
14:31:18.953818 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:31:18.954016 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:31:18.954165 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:31:18.954348 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:31:18.954582 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:31:18.954660 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:31:18.954733 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:31:18.955316 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:31:18.955595 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.955684 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:31:18.956807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:31:18.957017 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:18.957090 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:31:18.957159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:18.961167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:18.961300 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:18.961369 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:31:18.963390 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:18.964592 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:18.964677 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:31:18.965123 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.966878 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:18.966965 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:31:18.967384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:18.967914 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:31:18.967998 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:18.968062 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:31:18.968794 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:18.969538 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:18.969613 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:31:18.970877 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:18.971408 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.971513 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:31:18.971703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c16fd0>]}
14:31:18.971862 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:31:18.972047 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:31:18.972135 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:31:18.972279 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:31:18.972477 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:31:18.972550 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:31:18.972619 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:31:18.974173 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:31:18.974535 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.974626 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:31:18.985055 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:31:18.985431 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:31:18.985507 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:31:18.985572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:18.989259 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:18.989358 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:31:18.989427 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id
    , sum( amount ) as total_payment
    from payments

    group by account_id
),

final as (
    select  
        accounts.account_name
        , customer_payments.total_payment
    from accounts

)

select * from final
  );
14:31:18.990596 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 31:         , customer_payments.total_payment
                   ^

14:31:18.990684 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:31:18.991295 [debug] [Thread-1  ]: finished collecting timing info
14:31:18.991374 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:31:18.991533 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 31:         , customer_payments.total_payment
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:31:18.991664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f637ea4-2eaa-4ec5-9522-bba265546f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be3ee0>]}
14:31:18.991829 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:31:18.992039 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:31:18.992592 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:18.992714 [debug] [MainThread]: Using postgres connection "master"
14:31:18.992781 [debug] [MainThread]: On master: BEGIN
14:31:18.992841 [debug] [MainThread]: Opening a new connection, currently in state closed
14:31:18.996911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:18.997052 [debug] [MainThread]: On master: COMMIT
14:31:18.997117 [debug] [MainThread]: Using postgres connection "master"
14:31:18.997176 [debug] [MainThread]: On master: COMMIT
14:31:18.997311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:18.997387 [debug] [MainThread]: On master: Close
14:31:18.997566 [info ] [MainThread]: 
14:31:18.997694 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
14:31:18.997807 [debug] [MainThread]: Connection 'master' was properly closed.
14:31:18.997874 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:31:19.000264 [info ] [MainThread]: 
14:31:19.000443 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:31:19.000595 [info ] [MainThread]: 
14:31:19.000708 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:31:19.000821 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:31:19.000924 [error] [MainThread]:   LINE 31:         , customer_payments.total_payment
14:31:19.001033 [error] [MainThread]:                      ^
14:31:19.001136 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:31:19.001248 [info ] [MainThread]: 
14:31:19.001353 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:31:19.001507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ee820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ee6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8520>]}


============================== 2022-05-27 14:31:48.508118 | 2d32a618-195c-4c93-a857-3d1c93d019ca ==============================
14:31:48.508140 [info ] [MainThread]: Running with dbt=1.1.0
14:31:48.508575 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:31:48.508674 [debug] [MainThread]: Tracking: tracking
14:31:48.522775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fae80>]}
14:31:48.539380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:31:48.539672 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:31:48.545868 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:31:48.553305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:31:48.555613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad1a0d0>]}
14:31:48.558141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abbb880>]}
14:31:48.558277 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:31:48.558405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abbb850>]}
14:31:48.559141 [info ] [MainThread]: 
14:31:48.559366 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:48.559851 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:31:48.564445 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:31:48.564526 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:31:48.564599 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:31:48.596575 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:31:48.597661 [debug] [ThreadPool]: On list_demo_destination: Close
14:31:48.598303 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:31:48.621852 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:31:48.622010 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:31:48.622076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:31:48.626948 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:31:48.627030 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:31:48.627090 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:31:48.635013 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:31:48.635651 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:31:48.635847 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:31:48.637892 [debug] [MainThread]: Using postgres connection "master"
14:31:48.637993 [debug] [MainThread]: On master: BEGIN
14:31:48.638056 [debug] [MainThread]: Opening a new connection, currently in state init
14:31:48.644510 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:31:48.644592 [debug] [MainThread]: Using postgres connection "master"
14:31:48.644654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:31:48.671896 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:31:48.672566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d61670>]}
14:31:48.672713 [debug] [MainThread]: On master: ROLLBACK
14:31:48.672898 [debug] [MainThread]: Using postgres connection "master"
14:31:48.672974 [debug] [MainThread]: On master: BEGIN
14:31:48.673232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:48.673308 [debug] [MainThread]: On master: COMMIT
14:31:48.673380 [debug] [MainThread]: Using postgres connection "master"
14:31:48.673445 [debug] [MainThread]: On master: COMMIT
14:31:48.673601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:48.673678 [debug] [MainThread]: On master: Close
14:31:48.673833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:31:48.673975 [info ] [MainThread]: 
14:31:48.675527 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:31:48.675695 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:31:48.675940 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:31:48.676026 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:31:48.676108 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:31:48.676825 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:31:48.677173 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.677264 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:31:48.689206 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:31:48.689589 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:48.689665 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:31:48.689729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:48.692033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:48.692128 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:48.692198 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:31:48.693135 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:48.696220 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:48.696318 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:31:48.696563 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.697589 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:48.697662 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:31:48.697866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.700893 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:31:48.700990 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:48.701054 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:31:48.701893 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:48.704066 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:31:48.704154 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:31:48.705480 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:48.705985 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.706084 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:31:48.706273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abbb2b0>]}
14:31:48.706443 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:31:48.706635 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:31:48.706734 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:31:48.706891 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:31:48.707098 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:31:48.707185 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:31:48.707263 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:31:48.707880 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:31:48.708124 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.708197 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:31:48.709187 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:31:48.709372 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:48.709436 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:31:48.709494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:48.715862 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:31:48.715943 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:48.716001 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:31:48.717709 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:48.718874 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:48.718961 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:31:48.719373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.720436 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:48.720510 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:31:48.720771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.722090 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:31:48.722161 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:48.722224 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:31:48.722795 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:48.723460 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:31:48.723545 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:31:48.724537 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:48.725084 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.725191 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:31:48.725397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ade25e0>]}
14:31:48.725571 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:31:48.725769 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:31:48.725864 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:31:48.726105 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:31:48.726403 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:31:48.726491 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:31:48.726569 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:31:48.727284 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:31:48.727601 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.727675 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:31:48.728737 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:31:48.728940 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:48.729004 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:31:48.729062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:48.732972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:48.733087 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:48.733150 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:31:48.735310 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:48.736708 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:48.736843 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:31:48.743918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:31:48.745011 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:48.745088 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:31:48.745490 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.746016 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:31:48.746083 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:48.746143 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:31:48.746600 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:48.747242 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:31:48.747308 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:31:48.748215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:48.748655 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.748739 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:31:48.748924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc3730>]}
14:31:48.749087 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:31:48.749286 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:31:48.749374 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:31:48.749470 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:31:48.749651 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:31:48.749810 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:31:48.749911 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:31:48.750605 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:31:48.750873 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.750950 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:31:48.752016 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:31:48.752228 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:48.752300 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:31:48.752363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:48.756215 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:48.756292 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:48.756351 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:31:48.758480 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:48.759531 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:48.759606 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:31:48.759918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.760877 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:48.760942 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:31:48.761241 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.761726 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:31:48.761790 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:48.761849 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:31:48.762207 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:48.762830 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:31:48.762893 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:31:48.764047 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:48.764585 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.764674 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:31:48.764843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb7d00>]}
14:31:48.764991 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:31:48.765162 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:31:48.765246 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:31:48.765379 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:31:48.765556 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:31:48.765625 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:31:48.765690 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:31:48.766239 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:31:48.766511 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.766586 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:31:48.767667 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:31:48.767984 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:48.768068 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:31:48.768130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:48.772915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:31:48.773039 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:48.773100 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:31:48.775094 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:31:48.776368 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:48.776449 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:31:48.776837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.778605 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:48.778685 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:31:48.778985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:31:48.779500 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:31:48.779565 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:48.779623 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:31:48.780281 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:31:48.780946 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:31:48.781013 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:31:48.782078 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:31:48.782508 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.782602 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:31:48.782777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae0ba30>]}
14:31:48.782928 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:31:48.783104 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:31:48.783187 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:31:48.783317 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:31:48.783493 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:31:48.783560 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:31:48.783625 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:31:48.784960 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:31:48.785214 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.785287 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:31:48.794896 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:31:48.795112 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:31:48.795183 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:31:48.795241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:31:48.818468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:31:48.818553 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:31:48.818617 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    from payments

    group by account_id
),

final as (
    select  
        accounts.account_name,
        customer_payments.total_payment
    from accounts

)

select * from final
  );
14:31:48.819523 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 31:         customer_payments.total_payment
                 ^

14:31:48.819616 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:31:48.819832 [debug] [Thread-1  ]: finished collecting timing info
14:31:48.819914 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:31:48.820064 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 31:         customer_payments.total_payment
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:31:48.820184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32a618-195c-4c93-a857-3d1c93d019ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc30d0>]}
14:31:48.820341 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.04s]
14:31:48.820531 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:31:48.821136 [debug] [MainThread]: Acquiring new postgres connection "master"
14:31:48.821274 [debug] [MainThread]: Using postgres connection "master"
14:31:48.821349 [debug] [MainThread]: On master: BEGIN
14:31:48.821417 [debug] [MainThread]: Opening a new connection, currently in state closed
14:31:48.826394 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:31:48.826528 [debug] [MainThread]: On master: COMMIT
14:31:48.826614 [debug] [MainThread]: Using postgres connection "master"
14:31:48.826692 [debug] [MainThread]: On master: COMMIT
14:31:48.826897 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:31:48.827044 [debug] [MainThread]: On master: Close
14:31:48.827266 [info ] [MainThread]: 
14:31:48.827398 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.27s.
14:31:48.827517 [debug] [MainThread]: Connection 'master' was properly closed.
14:31:48.827579 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:31:48.829928 [info ] [MainThread]: 
14:31:48.830069 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:31:48.830195 [info ] [MainThread]: 
14:31:48.830308 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:31:48.830419 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:31:48.830521 [error] [MainThread]:   LINE 31:         customer_payments.total_payment
14:31:48.830622 [error] [MainThread]:                    ^
14:31:48.830723 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:31:48.830831 [info ] [MainThread]: 
14:31:48.830939 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:31:48.831083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d38670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d387c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc3e80>]}


============================== 2022-05-27 14:43:00.357358 | f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d ==============================
14:43:00.357379 [info ] [MainThread]: Running with dbt=1.1.0
14:43:00.358026 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:43:00.358136 [debug] [MainThread]: Tracking: tracking
14:43:00.379178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591bf10>]}
14:43:00.400002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:43:00.400154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:43:00.400387 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:43:00.403691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aca0d0>]}
14:43:00.406337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a66430>]}
14:43:00.406485 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:43:00.406634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a664c0>]}
14:43:00.407425 [info ] [MainThread]: 
14:43:00.407666 [debug] [MainThread]: Acquiring new postgres connection "master"
14:43:00.408178 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:43:00.413067 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:43:00.413172 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:43:00.413243 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:43:00.454310 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
14:43:00.455363 [debug] [ThreadPool]: On list_demo_destination: Close
14:43:00.456149 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:43:00.459599 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:43:00.459722 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:43:00.459808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:43:00.463714 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:43:00.463884 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:43:00.463982 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:43:00.468517 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:43:00.469393 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:43:00.469636 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:43:00.472333 [debug] [MainThread]: Using postgres connection "master"
14:43:00.472457 [debug] [MainThread]: On master: BEGIN
14:43:00.472536 [debug] [MainThread]: Opening a new connection, currently in state init
14:43:00.481142 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:43:00.481274 [debug] [MainThread]: Using postgres connection "master"
14:43:00.481362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:43:00.518455 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:43:00.519378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a00850>]}
14:43:00.519584 [debug] [MainThread]: On master: ROLLBACK
14:43:00.519862 [debug] [MainThread]: Using postgres connection "master"
14:43:00.519983 [debug] [MainThread]: On master: BEGIN
14:43:00.520327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:43:00.520435 [debug] [MainThread]: On master: COMMIT
14:43:00.520522 [debug] [MainThread]: Using postgres connection "master"
14:43:00.520599 [debug] [MainThread]: On master: COMMIT
14:43:00.520794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:43:00.520884 [debug] [MainThread]: On master: Close
14:43:00.521086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:43:00.521257 [info ] [MainThread]: 
14:43:00.525021 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:43:00.525238 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:43:00.525535 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:43:00.525627 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:43:00.525723 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:43:00.526496 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:43:00.526851 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.526941 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:43:00.539622 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:43:00.540027 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:43:00.540127 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:43:00.540201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:00.543788 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:43:00.543902 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:43:00.543971 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:43:00.544933 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:43:00.548876 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:43:00.549002 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:43:00.549914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.571884 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:43:00.572087 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:43:00.572859 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.576147 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:43:00.576269 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:43:00.576340 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:43:00.577891 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:43:00.580052 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:43:00.580137 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:43:00.582040 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:43:00.582570 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.582668 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:43:00.582884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c1220>]}
14:43:00.583097 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.06s]
14:43:00.583359 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:43:00.583470 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:43:00.583733 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:43:00.584058 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:43:00.584151 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:43:00.584232 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:43:00.584928 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:43:00.585211 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.585284 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:43:00.586249 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:43:00.586439 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:43:00.586505 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:43:00.586563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:00.591119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:43:00.591301 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:43:00.591383 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:43:00.595129 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:43:00.596489 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:43:00.596577 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:43:00.597172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.598377 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:43:00.598495 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:43:00.599898 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.600698 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:43:00.600784 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:43:00.600850 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:43:00.601703 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:43:00.602418 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:43:00.602493 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:43:00.604021 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:43:00.604599 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.604684 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:43:00.604870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105587e20>]}
14:43:00.605037 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:43:00.605230 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:43:00.605317 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:43:00.605412 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:43:00.605592 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:43:00.605666 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:43:00.605736 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:43:00.606313 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:43:00.606611 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.606691 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:43:00.607765 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:43:00.608025 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:43:00.608108 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:43:00.608171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:00.614804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:43:00.614943 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:43:00.615009 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:43:00.618509 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:43:00.619930 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:43:00.620055 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:43:00.620548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.621517 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:43:00.621594 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:43:00.621924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.622440 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:43:00.622510 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:43:00.622574 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:43:00.623112 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:43:00.623895 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:43:00.623973 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:43:00.626179 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:43:00.626684 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.626780 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:43:00.626960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abd310>]}
14:43:00.627140 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:43:00.627324 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:43:00.627413 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:43:00.627509 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:43:00.627687 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:43:00.627756 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:43:00.627825 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:43:00.628350 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:43:00.628610 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.628688 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:43:00.629656 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:43:00.629846 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:43:00.629911 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:43:00.629968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:00.635058 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:43:00.635201 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:43:00.635274 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:43:00.637089 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:43:00.639219 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:43:00.639313 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:43:00.639777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.640843 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:43:00.640955 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:43:00.641468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.642063 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:43:00.642138 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:43:00.642204 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:43:00.644617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:43:00.645360 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:43:00.645453 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:43:00.646714 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:43:00.647167 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.647250 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:43:00.647433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bccd60>]}
14:43:00.647600 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:43:00.647778 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:43:00.647866 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:43:00.647960 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:43:00.648137 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:43:00.648206 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:43:00.648272 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:43:00.648780 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:43:00.649035 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.649106 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:43:00.650083 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:43:00.650266 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:43:00.650335 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:43:00.650399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:00.654070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:43:00.654200 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:43:00.654263 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:43:00.656408 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:43:00.657660 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:43:00.657738 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:43:00.658136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.659024 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:43:00.659092 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:43:00.659446 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:43:00.659952 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:43:00.660019 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:43:00.660079 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:43:00.660708 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:43:00.661389 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:43:00.661462 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:43:00.662723 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:43:00.663142 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.663228 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:43:00.663399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a00af0>]}
14:43:00.663545 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:43:00.663719 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:43:00.663806 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:43:00.663901 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:43:00.664079 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:43:00.664150 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:43:00.664218 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:43:00.665540 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:43:00.665803 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.665885 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:43:00.675504 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:43:00.675751 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:43:00.675831 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:43:00.675894 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:43:00.681527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:43:00.681612 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:43:00.681676 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    from payments

    group by account_id
),

final as (
    select  
        accounts.account_name,
        customer_payments.total_payment
    from accounts

)

select * from final
  );
14:43:00.684065 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 31:         customer_payments.total_payment
                 ^

14:43:00.684201 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:43:00.684409 [debug] [Thread-1  ]: finished collecting timing info
14:43:00.684482 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:43:00.684639 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 31:         customer_payments.total_payment
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:43:00.684773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f584d4fe-6bd3-4b87-a6a9-ebdadc7fed4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c10dc0>]}
14:43:00.684970 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:43:00.685176 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:43:00.685833 [debug] [MainThread]: Acquiring new postgres connection "master"
14:43:00.686005 [debug] [MainThread]: Using postgres connection "master"
14:43:00.686087 [debug] [MainThread]: On master: BEGIN
14:43:00.686159 [debug] [MainThread]: Opening a new connection, currently in state closed
14:43:00.690362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:43:00.690508 [debug] [MainThread]: On master: COMMIT
14:43:00.690568 [debug] [MainThread]: Using postgres connection "master"
14:43:00.690628 [debug] [MainThread]: On master: COMMIT
14:43:00.690774 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:43:00.690843 [debug] [MainThread]: On master: Close
14:43:00.691013 [info ] [MainThread]: 
14:43:00.691132 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.28s.
14:43:00.691243 [debug] [MainThread]: Connection 'master' was properly closed.
14:43:00.691303 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:43:00.693489 [info ] [MainThread]: 
14:43:00.693619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:43:00.693740 [info ] [MainThread]: 
14:43:00.693844 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:43:00.693947 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:43:00.694045 [error] [MainThread]:   LINE 31:         customer_payments.total_payment
14:43:00.694143 [error] [MainThread]:                    ^
14:43:00.694241 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:43:00.694346 [info ] [MainThread]: 
14:43:00.694446 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:43:00.694591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0f250>]}


============================== 2022-05-27 14:48:01.860268 | 05f527b1-1805-4b83-ac55-a73c5b2c51bd ==============================
14:48:01.860291 [info ] [MainThread]: Running with dbt=1.1.0
14:48:01.860684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
14:48:01.860791 [debug] [MainThread]: Tracking: tracking
14:48:01.875171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221dab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221dac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221dac70>]}
14:48:01.875921 [info ] [MainThread]: Start parsing.
14:48:01.882558 [info ] [MainThread]: Dependencies loaded
14:48:01.886227 [info ] [MainThread]: ManifestLoader created
14:48:01.892149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:48:01.892408 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:48:01.899650 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:48:01.907076 [info ] [MainThread]: Manifest loaded
14:48:01.907403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:48:01.907536 [info ] [MainThread]: Manifest checked
14:48:01.907715 [info ] [MainThread]: Flat graph built
14:48:01.907837 [info ] [MainThread]: Manifest loaded
14:48:01.908589 [info ] [MainThread]: Performance info: target/perf_info.json
14:48:01.908802 [info ] [MainThread]: Done.
14:48:01.908971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223b1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223b1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223b1a30>]}


============================== 2022-05-27 14:49:12.573831 | 0d12ab70-714a-422c-9071-51ec85eb0d46 ==============================
14:49:12.573862 [info ] [MainThread]: Running with dbt=1.1.0
14:49:12.574251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
14:49:12.574345 [debug] [MainThread]: Tracking: tracking
14:49:12.588584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e37eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0f070>]}
14:49:12.589353 [info ] [MainThread]: Start parsing.
14:49:12.595756 [info ] [MainThread]: Dependencies loaded
14:49:12.599333 [info ] [MainThread]: ManifestLoader created
14:49:12.604991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:49:12.605126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:49:12.605199 [info ] [MainThread]: Manifest loaded
14:49:12.605526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:49:12.605668 [info ] [MainThread]: Manifest checked
14:49:12.605877 [info ] [MainThread]: Flat graph built
14:49:12.606019 [info ] [MainThread]: Manifest loaded
14:49:12.606450 [info ] [MainThread]: Performance info: target/perf_info.json
14:49:12.606558 [info ] [MainThread]: Done.
14:49:12.606697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc9070>]}


============================== 2022-05-27 14:49:45.567424 | dc596b3a-3587-49de-aa95-3b850844e805 ==============================
14:49:45.567429 [info ] [MainThread]: Running with dbt=1.1.0
14:49:45.567665 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
14:49:45.567760 [debug] [MainThread]: Tracking: tracking
14:49:45.583924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac79d0>]}
14:49:45.623592 [debug] [MainThread]: Executing "git --help"
14:49:45.631409 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
14:49:45.631778 [debug] [MainThread]: STDERR: "b''"
14:49:45.634762 [debug] [MainThread]: Acquiring new postgres connection "debug"
14:49:45.635345 [debug] [MainThread]: Using postgres connection "debug"
14:49:45.635431 [debug] [MainThread]: On debug: select 1 as id
14:49:45.635519 [debug] [MainThread]: Opening a new connection, currently in state init
14:49:45.662616 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
14:49:45.663802 [debug] [MainThread]: On debug: Close
14:49:45.664057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d71f10>]}
14:49:45.789141 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-05-27 14:49:50.374313 | d7e4555d-30cd-4460-994d-fef5b87839dc ==============================
14:49:50.374333 [info ] [MainThread]: Running with dbt=1.1.0
14:49:50.374781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:49:50.374882 [debug] [MainThread]: Tracking: tracking
14:49:50.389601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edbf10>]}
14:49:50.405697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:49:50.405828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:49:50.406080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:49:50.409003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708a0d0>]}
14:49:50.411631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107025430>]}
14:49:50.411787 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:49:50.411925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070254c0>]}
14:49:50.412780 [info ] [MainThread]: 
14:49:50.413027 [debug] [MainThread]: Acquiring new postgres connection "master"
14:49:50.413532 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:49:50.418180 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:49:50.418376 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:49:50.418452 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:49:50.424977 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:49:50.425860 [debug] [ThreadPool]: On list_demo_destination: Close
14:49:50.426464 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:49:50.429205 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:49:50.429328 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:49:50.429407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:49:50.433004 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:49:50.433095 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:49:50.433158 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:49:50.437557 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:49:50.438144 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:49:50.439168 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:49:50.441013 [debug] [MainThread]: Using postgres connection "master"
14:49:50.441101 [debug] [MainThread]: On master: BEGIN
14:49:50.441164 [debug] [MainThread]: Opening a new connection, currently in state init
14:49:50.444715 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:49:50.444797 [debug] [MainThread]: Using postgres connection "master"
14:49:50.444863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:49:50.492063 [debug] [MainThread]: SQL status: SELECT 5 in 0.05 seconds
14:49:50.493025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107060e20>]}
14:49:50.493197 [debug] [MainThread]: On master: ROLLBACK
14:49:50.493450 [debug] [MainThread]: Using postgres connection "master"
14:49:50.493540 [debug] [MainThread]: On master: BEGIN
14:49:50.493865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:49:50.493960 [debug] [MainThread]: On master: COMMIT
14:49:50.494040 [debug] [MainThread]: Using postgres connection "master"
14:49:50.494113 [debug] [MainThread]: On master: COMMIT
14:49:50.494328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:49:50.494459 [debug] [MainThread]: On master: Close
14:49:50.494673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:49:50.494841 [info ] [MainThread]: 
14:49:50.496591 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:49:50.496746 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:49:50.497077 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:49:50.497165 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:49:50.497258 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:49:50.497947 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:49:50.498264 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.498357 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:49:50.511311 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:49:50.511744 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:49:50.511833 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:49:50.511902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:49:50.514740 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:49:50.514872 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:49:50.514945 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:49:50.516010 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:49:50.519908 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:49:50.520013 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:49:50.520316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.542257 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:49:50.542430 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:49:50.543129 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.546228 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:49:50.546315 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:49:50.546378 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:49:50.547505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:49:50.549535 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:49:50.549640 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:49:50.551380 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:49:50.551877 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.551969 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:49:50.552149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071503a0>]}
14:49:50.552303 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.06s]
14:49:50.552487 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:49:50.552576 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:49:50.552673 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:49:50.552920 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:49:50.553004 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:49:50.553075 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:49:50.553661 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:49:50.553930 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.554002 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:49:50.554981 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:49:50.555177 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:49:50.555240 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:49:50.555299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:49:50.559823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:49:50.559923 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:49:50.559988 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:49:50.563330 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:49:50.564465 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:49:50.564541 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:49:50.565789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.566816 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:49:50.566892 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:49:50.567280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.567800 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:49:50.567871 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:49:50.567932 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:49:50.568653 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:49:50.569479 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:49:50.569560 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:49:50.570645 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:49:50.571186 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.571274 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:49:50.571462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eac1c0>]}
14:49:50.571643 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:49:50.571829 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:49:50.571932 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:49:50.572037 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:49:50.572286 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:49:50.572368 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:49:50.572439 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:49:50.572962 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:49:50.573257 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.573333 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:49:50.574345 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:49:50.574544 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:49:50.574631 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:49:50.574692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:49:50.580318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:49:50.580445 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:49:50.580513 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:49:50.586578 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:49:50.587910 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:49:50.587996 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:49:50.588588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.589658 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:49:50.589735 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:49:50.590177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.590812 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:49:50.590891 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:49:50.590968 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:49:50.591588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:49:50.592294 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:49:50.592363 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:49:50.594015 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:49:50.594506 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.594610 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:49:50.594800 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107140b50>]}
14:49:50.594982 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:49:50.595189 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:49:50.595292 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:49:50.595501 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:49:50.595868 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:49:50.595956 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:49:50.596027 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:49:50.596628 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:49:50.596908 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.596988 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:49:50.598027 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:49:50.598226 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:49:50.598294 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:49:50.598355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:49:50.604266 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:49:50.604396 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:49:50.604458 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:49:50.607294 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:49:50.609349 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:49:50.609440 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:49:50.609859 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.610828 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:49:50.610910 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:49:50.612460 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.613051 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:49:50.613124 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:49:50.613187 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:49:50.614549 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:49:50.615262 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:49:50.615329 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:49:50.616557 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:49:50.617022 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.617107 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:49:50.617289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718ed60>]}
14:49:50.617465 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:49:50.617659 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:49:50.617748 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:49:50.617894 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:49:50.618092 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:49:50.618165 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:49:50.618235 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:49:50.618752 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:49:50.619020 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.619091 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:49:50.620102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:49:50.620296 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:49:50.620366 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:49:50.620427 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:49:50.624185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:49:50.624264 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:49:50.624326 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:49:50.626199 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:49:50.627241 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:49:50.627326 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:49:50.627796 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.628718 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:49:50.628791 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:49:50.629088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:49:50.629620 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:49:50.629701 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:49:50.629762 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:49:50.630174 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:49:50.630911 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:49:50.630997 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:49:50.632385 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:49:50.632841 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.632927 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:49:50.633093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071abbb0>]}
14:49:50.633248 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:49:50.633430 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:49:50.633514 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:49:50.633646 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:49:50.633829 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:49:50.633901 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:49:50.633968 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:49:50.635576 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:49:50.636019 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.636122 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:49:50.646900 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:49:50.647314 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:49:50.647387 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:49:50.647450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:49:50.652726 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:49:50.652817 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:49:50.652879 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        customer_payments.total_payment

    from accounts

)

select * from final
  );
14:49:50.654507 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 33:         customer_payments.total_payment
                 ^

14:49:50.654585 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:49:50.654827 [debug] [Thread-1  ]: finished collecting timing info
14:49:50.654900 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:49:50.655039 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 33:         customer_payments.total_payment
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:49:50.655157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e4555d-30cd-4460-994d-fef5b87839dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cfdf0>]}
14:49:50.655321 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:49:50.655512 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:49:50.655998 [debug] [MainThread]: Acquiring new postgres connection "master"
14:49:50.656084 [debug] [MainThread]: Using postgres connection "master"
14:49:50.656147 [debug] [MainThread]: On master: BEGIN
14:49:50.656205 [debug] [MainThread]: Opening a new connection, currently in state closed
14:49:50.659618 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:49:50.659712 [debug] [MainThread]: On master: COMMIT
14:49:50.659782 [debug] [MainThread]: Using postgres connection "master"
14:49:50.659852 [debug] [MainThread]: On master: COMMIT
14:49:50.659997 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:49:50.660080 [debug] [MainThread]: On master: Close
14:49:50.660238 [info ] [MainThread]: 
14:49:50.660368 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:49:50.660578 [debug] [MainThread]: Connection 'master' was properly closed.
14:49:50.660655 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:49:50.663108 [info ] [MainThread]: 
14:49:50.663253 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:49:50.663376 [info ] [MainThread]: 
14:49:50.663485 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:49:50.663588 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:49:50.663687 [error] [MainThread]:   LINE 33:         customer_payments.total_payment
14:49:50.663784 [error] [MainThread]:                    ^
14:49:50.663881 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:49:50.663984 [info ] [MainThread]: 
14:49:50.664084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:49:50.664226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107060eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ce2b0>]}


============================== 2022-05-27 14:50:02.540240 | 93c5ee9a-d2a1-4c07-8a77-201688256ea2 ==============================
14:50:02.540280 [info ] [MainThread]: Running with dbt=1.1.0
14:50:02.540725 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:50:02.540819 [debug] [MainThread]: Tracking: tracking
14:50:02.555921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795ae80>]}
14:50:02.572393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:02.572645 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:50:02.578781 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:50:02.586073 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:50:02.588396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b470d0>]}
14:50:02.591125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7880>]}
14:50:02.591317 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:50:02.591464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7850>]}
14:50:02.592253 [info ] [MainThread]: 
14:50:02.592489 [debug] [MainThread]: Acquiring new postgres connection "master"
14:50:02.592985 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:50:02.597895 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:50:02.598013 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:50:02.598092 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:02.604774 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:50:02.605729 [debug] [ThreadPool]: On list_demo_destination: Close
14:50:02.606352 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:50:02.629839 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:50:02.630012 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:50:02.630081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:50:02.635964 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:50:02.636065 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:50:02.636130 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:50:02.639835 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:50:02.640445 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:50:02.640704 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:50:02.642725 [debug] [MainThread]: Using postgres connection "master"
14:50:02.642815 [debug] [MainThread]: On master: BEGIN
14:50:02.642880 [debug] [MainThread]: Opening a new connection, currently in state init
14:50:02.646279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:02.646376 [debug] [MainThread]: Using postgres connection "master"
14:50:02.646445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:50:02.699009 [debug] [MainThread]: SQL status: SELECT 5 in 0.05 seconds
14:50:02.699835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107721670>]}
14:50:02.700019 [debug] [MainThread]: On master: ROLLBACK
14:50:02.701500 [debug] [MainThread]: Using postgres connection "master"
14:50:02.701728 [debug] [MainThread]: On master: BEGIN
14:50:02.702157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:02.702312 [debug] [MainThread]: On master: COMMIT
14:50:02.702402 [debug] [MainThread]: Using postgres connection "master"
14:50:02.702467 [debug] [MainThread]: On master: COMMIT
14:50:02.702697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:02.702986 [debug] [MainThread]: On master: Close
14:50:02.703217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:50:02.703360 [info ] [MainThread]: 
14:50:02.705194 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:50:02.705393 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:50:02.705633 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:50:02.705721 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:50:02.705796 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:50:02.706535 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:50:02.706890 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.706974 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:50:02.718042 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:50:02.718444 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:02.718533 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:50:02.718600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.721732 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:02.721855 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:02.721928 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:50:02.722893 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:02.726004 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:02.726116 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:50:02.726455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.727442 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:02.727516 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:50:02.727703 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.730798 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:50:02.730914 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:02.730981 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:50:02.731528 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:02.733651 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:02.733735 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:50:02.735050 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:02.735533 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.735619 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:50:02.735812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7460>]}
14:50:02.735978 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:50:02.736166 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:50:02.736253 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:50:02.736403 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:50:02.736622 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:50:02.736700 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:50:02.736772 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:50:02.737399 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:50:02.737668 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.737743 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:50:02.738751 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:50:02.738937 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:02.739004 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:50:02.739064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.742749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:02.742832 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:02.742891 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:50:02.745050 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:02.746153 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:02.746228 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:50:02.746619 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.747511 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:02.747601 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:50:02.747884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.749170 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:50:02.749264 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:02.749328 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:50:02.749747 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:02.750482 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:02.750553 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:50:02.751424 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:02.751909 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.751997 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:50:02.752172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e22610>]}
14:50:02.752327 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:50:02.752503 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:50:02.752590 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:50:02.752726 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:50:02.752925 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:50:02.753003 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:50:02.753071 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:50:02.753729 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:50:02.754094 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.754203 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:50:02.755271 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:50:02.755508 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:02.755577 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:50:02.755637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.759071 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:02.759154 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:02.759214 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:50:02.760654 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:02.761877 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:02.761963 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:50:02.765059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.766305 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:02.766442 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:50:02.766789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.767509 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:50:02.767588 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:02.767721 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:50:02.768292 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:02.769078 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:02.769183 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:50:02.770280 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:02.770866 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.770964 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:50:02.771180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e047f0>]}
14:50:02.771353 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:50:02.771535 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:50:02.771626 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:50:02.771725 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:50:02.771911 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:50:02.772077 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:50:02.772158 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:50:02.772820 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:50:02.773125 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.773197 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:50:02.774152 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:50:02.774337 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:02.774399 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:50:02.774456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.778199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:02.778321 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:02.778387 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:50:02.780401 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:02.781640 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:02.781731 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:50:02.782141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.783225 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:02.783368 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:50:02.783757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.784329 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:50:02.784399 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:02.784462 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:50:02.785339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:02.786009 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:02.786075 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:50:02.787198 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:02.787758 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.787858 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:50:02.788056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be3bb0>]}
14:50:02.788227 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:50:02.788405 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:50:02.788493 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:50:02.788592 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:50:02.788767 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:50:02.788838 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:50:02.788907 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:50:02.789426 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:50:02.789713 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.789794 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:50:02.790797 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:50:02.790990 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:02.791054 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:50:02.791110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.795281 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:02.795415 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:02.795473 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:50:02.797685 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:02.798910 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:02.798987 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:50:02.799386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.801019 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:02.801102 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:50:02.801581 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:02.802088 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:50:02.802152 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:02.802213 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:50:02.802902 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:02.803577 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:02.803643 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:50:02.804644 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:02.805063 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.805140 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:50:02.805305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4b610>]}
14:50:02.805454 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:50:02.805625 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:50:02.805710 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:50:02.805803 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:50:02.805977 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:50:02.806044 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:50:02.806108 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:50:02.807473 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:50:02.807734 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.807809 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:50:02.817332 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:50:02.817551 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:50:02.817623 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:50:02.817681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:02.823518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:50:02.823605 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:50:02.823663 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment

    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,

    from accounts

)

select * from final
  );
14:50:02.823934 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 34:     from accounts
             ^

14:50:02.823999 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:50:02.824176 [debug] [Thread-1  ]: finished collecting timing info
14:50:02.824244 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:50:02.824378 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "from"
  LINE 34:     from accounts
               ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:50:02.824484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93c5ee9a-d2a1-4c07-8a77-201688256ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e15910>]}
14:50:02.824624 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:50:02.824796 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:50:02.825252 [debug] [MainThread]: Acquiring new postgres connection "master"
14:50:02.825337 [debug] [MainThread]: Using postgres connection "master"
14:50:02.825397 [debug] [MainThread]: On master: BEGIN
14:50:02.825454 [debug] [MainThread]: Opening a new connection, currently in state closed
14:50:02.828706 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:02.828782 [debug] [MainThread]: On master: COMMIT
14:50:02.828841 [debug] [MainThread]: Using postgres connection "master"
14:50:02.828896 [debug] [MainThread]: On master: COMMIT
14:50:02.829035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:02.829098 [debug] [MainThread]: On master: Close
14:50:02.829236 [info ] [MainThread]: 
14:50:02.829348 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:50:02.829460 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:02.829516 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:50:02.831692 [info ] [MainThread]: 
14:50:02.831815 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:50:02.831929 [info ] [MainThread]: 
14:50:02.832032 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:50:02.832138 [error] [MainThread]:   syntax error at or near "from"
14:50:02.832253 [error] [MainThread]:   LINE 34:     from accounts
14:50:02.832351 [error] [MainThread]:                ^
14:50:02.832447 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:50:02.832550 [info ] [MainThread]: 
14:50:02.832650 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:50:02.832788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792f040>]}


============================== 2022-05-27 14:50:42.864790 | 1826abde-a453-43ba-8e07-b24e3f24dcdf ==============================
14:50:42.864810 [info ] [MainThread]: Running with dbt=1.1.0
14:50:42.865290 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:50:42.865390 [debug] [MainThread]: Tracking: tracking
14:50:42.879634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721ac70>]}
14:50:42.895555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:42.895851 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:50:42.901649 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:50:42.909004 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:50:42.911323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751b0d0>]}
14:50:42.914112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a7eb0>]}
14:50:42.914320 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:50:42.914460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072005e0>]}
14:50:42.915242 [info ] [MainThread]: 
14:50:42.915476 [debug] [MainThread]: Acquiring new postgres connection "master"
14:50:42.915988 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:50:42.920982 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:50:42.921173 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:50:42.921292 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:42.951656 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:50:42.952712 [debug] [ThreadPool]: On list_demo_destination: Close
14:50:42.953381 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:50:42.977443 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:50:42.977621 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:50:42.977690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:50:42.982202 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:50:42.982287 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:50:42.982347 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:50:42.989884 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
14:50:42.990503 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:50:42.990751 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:50:42.992819 [debug] [MainThread]: Using postgres connection "master"
14:50:42.992921 [debug] [MainThread]: On master: BEGIN
14:50:42.992990 [debug] [MainThread]: Opening a new connection, currently in state init
14:50:42.997548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:42.997628 [debug] [MainThread]: Using postgres connection "master"
14:50:42.997693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:50:43.024626 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:50:43.025318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10243f670>]}
14:50:43.025487 [debug] [MainThread]: On master: ROLLBACK
14:50:43.025681 [debug] [MainThread]: Using postgres connection "master"
14:50:43.025761 [debug] [MainThread]: On master: BEGIN
14:50:43.026007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:43.026086 [debug] [MainThread]: On master: COMMIT
14:50:43.026156 [debug] [MainThread]: Using postgres connection "master"
14:50:43.026222 [debug] [MainThread]: On master: COMMIT
14:50:43.026367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:43.026446 [debug] [MainThread]: On master: Close
14:50:43.026603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:50:43.026748 [info ] [MainThread]: 
14:50:43.028366 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:50:43.028518 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:50:43.028751 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:50:43.028835 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:50:43.028916 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:50:43.029627 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:50:43.029969 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.030056 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:50:43.041518 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:50:43.041896 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:43.041973 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:50:43.042037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:43.047545 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:50:43.047659 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:43.047724 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:50:43.049557 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:43.052428 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:43.052516 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:50:43.056464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.057532 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:43.057612 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:50:43.057957 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.061056 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:50:43.061143 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:43.061208 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:50:43.061749 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:43.063801 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:43.063882 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:50:43.065000 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:43.065485 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.065587 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:50:43.065775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a7460>]}
14:50:43.065937 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.04s]
14:50:43.066126 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:50:43.066215 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:50:43.066359 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:50:43.066582 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:50:43.066658 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:50:43.066732 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:50:43.067341 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:50:43.067625 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.067700 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:50:43.068776 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:50:43.068963 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:43.069031 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:50:43.069092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:43.072665 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:43.072750 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:43.072813 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:50:43.074532 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:43.075666 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:43.075754 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:50:43.076110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.077141 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:43.077214 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:50:43.077525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.078800 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:50:43.078875 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:43.078936 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:50:43.079701 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:43.080392 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:43.080467 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:50:43.083112 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:43.083575 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.083661 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:50:43.083842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e0f70>]}
14:50:43.083995 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:50:43.084174 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:50:43.084262 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:50:43.084357 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:50:43.084588 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:50:43.084669 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:50:43.084739 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:50:43.085353 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:50:43.085619 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.085702 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:50:43.086698 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:50:43.086907 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:43.086973 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:50:43.087032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:43.091253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:43.091339 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:43.091403 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:50:43.093973 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:43.095067 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:43.095141 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:50:43.095788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.096727 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:43.096796 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:50:43.097158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.097669 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:50:43.097740 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:43.097814 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:50:43.098333 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:43.098964 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:43.099030 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:50:43.100303 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:43.100732 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.100813 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:50:43.100984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b8e80>]}
14:50:43.101133 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:50:43.101325 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:50:43.101412 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:50:43.101601 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:50:43.101811 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:50:43.101886 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:50:43.101955 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:50:43.102592 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:50:43.102839 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.102912 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:50:43.103902 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:50:43.104122 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:43.104193 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:50:43.104253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:43.108668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:43.108782 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:43.108845 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:50:43.111666 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:43.112831 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:43.112913 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:50:43.113760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.114682 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:43.114754 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:50:43.115112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.115623 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:50:43.115693 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:43.115755 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:50:43.116229 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:43.116844 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:43.116909 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:50:43.118059 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:43.118551 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.118640 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:50:43.118822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b3790>]}
14:50:43.118995 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:50:43.119206 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:50:43.119405 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:50:43.119670 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:50:43.120002 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:50:43.120121 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:50:43.120227 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:50:43.120975 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:50:43.121326 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.121417 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:50:43.122550 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:50:43.122759 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:43.122837 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:50:43.122904 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:43.130781 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:50:43.130943 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:43.131013 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:50:43.133612 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:43.134971 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:43.135056 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:50:43.140967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:50:43.142902 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:43.143022 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:50:43.146972 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:43.147566 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:50:43.147644 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:43.147705 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:50:43.148297 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:43.149016 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:43.149083 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:50:43.150639 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:43.151090 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.151173 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:50:43.151363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761d4c0>]}
14:50:43.151533 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.03s]
14:50:43.151722 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:50:43.151808 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:50:43.151950 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:50:43.152161 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:50:43.152237 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:50:43.152308 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:50:43.153688 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:50:43.153999 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.154076 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:50:43.163746 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:50:43.163964 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:50:43.164037 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:50:43.164098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:43.168718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:43.168801 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:50:43.168860 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        customer_payments.total_payment

    from accounts

)

select * from final
  );
14:50:43.169727 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 34:         customer_payments.total_payment
                 ^

14:50:43.169858 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:50:43.170047 [debug] [Thread-1  ]: finished collecting timing info
14:50:43.170119 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:50:43.170272 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 34:         customer_payments.total_payment
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:50:43.170398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826abde-a453-43ba-8e07-b24e3f24dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e69a0>]}
14:50:43.170564 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:50:43.170756 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:50:43.171244 [debug] [MainThread]: Acquiring new postgres connection "master"
14:50:43.171351 [debug] [MainThread]: Using postgres connection "master"
14:50:43.171423 [debug] [MainThread]: On master: BEGIN
14:50:43.171487 [debug] [MainThread]: Opening a new connection, currently in state closed
14:50:43.174807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:43.174921 [debug] [MainThread]: On master: COMMIT
14:50:43.174985 [debug] [MainThread]: Using postgres connection "master"
14:50:43.175047 [debug] [MainThread]: On master: COMMIT
14:50:43.175217 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:43.175326 [debug] [MainThread]: On master: Close
14:50:43.175504 [info ] [MainThread]: 
14:50:43.175620 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
14:50:43.175733 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:43.175792 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:50:43.178034 [info ] [MainThread]: 
14:50:43.178168 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:50:43.178291 [info ] [MainThread]: 
14:50:43.178434 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:50:43.178550 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:50:43.178652 [error] [MainThread]:   LINE 34:         customer_payments.total_payment
14:50:43.178753 [error] [MainThread]:                    ^
14:50:43.178850 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:50:43.178956 [info ] [MainThread]: 
14:50:43.179058 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:50:43.179203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc9fd0>]}


============================== 2022-05-27 14:50:48.734073 | bcc46d41-1ade-4ed6-b50e-ac078873ab64 ==============================
14:50:48.734101 [info ] [MainThread]: Running with dbt=1.1.0
14:50:48.734447 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:50:48.734548 [debug] [MainThread]: Tracking: tracking
14:50:48.748471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e99c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e99d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e99d90>]}
14:50:48.764151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:50:48.764384 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:50:48.770047 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:50:48.777847 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:50:48.780259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a19b0d0>]}
14:50:48.782856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a13ce50>]}
14:50:48.783000 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:50:48.783148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a13cee0>]}
14:50:48.783843 [info ] [MainThread]: 
14:50:48.784090 [debug] [MainThread]: Acquiring new postgres connection "master"
14:50:48.784917 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:50:48.790101 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:50:48.790251 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:50:48.790331 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:50:48.796512 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:50:48.797453 [debug] [ThreadPool]: On list_demo_destination: Close
14:50:48.798061 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:50:48.820857 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:50:48.821027 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:50:48.821092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:50:48.825520 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:50:48.825628 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:50:48.825693 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:50:48.829411 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:50:48.829996 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:50:48.830189 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:50:48.832239 [debug] [MainThread]: Using postgres connection "master"
14:50:48.832370 [debug] [MainThread]: On master: BEGIN
14:50:48.832433 [debug] [MainThread]: Opening a new connection, currently in state init
14:50:48.836291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:48.836375 [debug] [MainThread]: Using postgres connection "master"
14:50:48.836436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:50:48.876986 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:50:48.877724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a01d90>]}
14:50:48.877891 [debug] [MainThread]: On master: ROLLBACK
14:50:48.878102 [debug] [MainThread]: Using postgres connection "master"
14:50:48.878184 [debug] [MainThread]: On master: BEGIN
14:50:48.878442 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:48.878524 [debug] [MainThread]: On master: COMMIT
14:50:48.878597 [debug] [MainThread]: Using postgres connection "master"
14:50:48.878663 [debug] [MainThread]: On master: COMMIT
14:50:48.878816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:48.878898 [debug] [MainThread]: On master: Close
14:50:48.879060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:50:48.879207 [info ] [MainThread]: 
14:50:48.880774 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:50:48.880935 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:50:48.881170 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:50:48.881258 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:50:48.881337 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:50:48.882074 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:50:48.882392 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.882504 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:50:48.894423 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:50:48.894819 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:48.894901 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:50:48.894973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:48.897659 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:48.897769 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:48.897840 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:50:48.899442 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:48.902472 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:48.902567 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:50:48.902872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.903972 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:48.904050 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:50:48.904279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.907432 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:50:48.907535 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:48.907601 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:50:48.908200 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:48.910320 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:50:48.910403 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:50:48.910960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:48.911477 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.911566 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:50:48.911752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119696190>]}
14:50:48.911923 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:50:48.912124 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:50:48.912217 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:50:48.912319 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:50:48.912573 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:50:48.912658 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:50:48.912731 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:50:48.913359 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:50:48.913611 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.913686 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:50:48.914711 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:50:48.914904 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:48.914969 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:50:48.915029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:48.918818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:48.918894 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:48.918953 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:50:48.921033 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:48.922079 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:48.922153 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:50:48.922484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.923410 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:48.923484 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:50:48.923777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.925106 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:50:48.925199 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:48.925263 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:50:48.925890 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:48.926666 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:50:48.926741 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:50:48.927713 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:48.928204 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.928288 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:50:48.928460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c3a700>]}
14:50:48.928614 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:50:48.928787 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:50:48.928871 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:50:48.929009 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:50:48.929182 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:50:48.929252 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:50:48.929318 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:50:48.929955 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:50:48.930229 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.930304 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:50:48.931269 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:50:48.931504 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:48.931567 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:50:48.931645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:48.936169 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:50:48.936239 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:48.936295 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:50:48.938771 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:48.939962 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:48.940051 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:50:48.940581 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.941559 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:48.941654 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:50:48.941932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.942483 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:50:48.942586 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:48.942652 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:50:48.943088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:48.943761 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:50:48.943825 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:50:48.944886 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:48.945357 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.945438 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:50:48.945613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c3a5b0>]}
14:50:48.945765 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:50:48.945946 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:50:48.946034 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:50:48.946135 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:50:48.946326 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:50:48.946401 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:50:48.946469 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:50:48.947118 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:50:48.947482 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.947577 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:50:48.948664 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:50:48.948856 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:48.948926 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:50:48.948984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:48.958400 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:50:48.958575 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:48.958641 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:50:48.960894 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:48.962149 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:48.962249 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:50:48.962657 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.963662 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:48.963740 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:50:48.964014 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.964566 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:50:48.964634 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:48.964720 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:50:48.965814 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:48.966440 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:50:48.966505 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:50:48.967397 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:48.967877 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.967963 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:50:48.968127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dd6c70>]}
14:50:48.968276 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:50:48.968448 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:50:48.968534 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:50:48.968679 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:50:48.968869 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:50:48.968942 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:50:48.969009 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:50:48.969514 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:50:48.969743 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.969810 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:50:48.970766 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:50:48.970951 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:48.971014 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:50:48.971069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:48.980318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:50:48.980468 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:48.980528 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:50:48.983504 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:50:48.984720 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:48.984792 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:50:48.989530 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.991215 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:48.991300 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:50:48.991544 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:50:48.992078 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:50:48.992147 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:48.992208 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:50:48.992632 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:50:48.993324 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:50:48.993390 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:50:48.997974 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:50:48.998429 [debug] [Thread-1  ]: finished collecting timing info
14:50:48.998511 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:50:48.998690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2a9cd0>]}
14:50:48.998848 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.03s]
14:50:48.999030 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:50:48.999117 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:50:48.999259 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:50:48.999455 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:50:48.999534 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:50:48.999602 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:50:49.000992 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:50:49.001248 [debug] [Thread-1  ]: finished collecting timing info
14:50:49.001326 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:50:49.011065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:50:49.011291 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:50:49.011359 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:50:49.011418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:50:49.018323 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:50:49.018398 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:50:49.018459 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,

    from accounts

)

select * from final
  );
14:50:49.018730 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 35:     from accounts
             ^

14:50:49.018801 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:50:49.018979 [debug] [Thread-1  ]: finished collecting timing info
14:50:49.019049 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:50:49.019176 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "from"
  LINE 35:     from accounts
               ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:50:49.019285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc46d41-1ade-4ed6-b50e-ac078873ab64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2491c0>]}
14:50:49.019423 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:50:49.019595 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:50:49.020038 [debug] [MainThread]: Acquiring new postgres connection "master"
14:50:49.020131 [debug] [MainThread]: Using postgres connection "master"
14:50:49.020193 [debug] [MainThread]: On master: BEGIN
14:50:49.020250 [debug] [MainThread]: Opening a new connection, currently in state closed
14:50:49.023791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:50:49.023880 [debug] [MainThread]: On master: COMMIT
14:50:49.023939 [debug] [MainThread]: Using postgres connection "master"
14:50:49.023996 [debug] [MainThread]: On master: COMMIT
14:50:49.024129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:50:49.024193 [debug] [MainThread]: On master: Close
14:50:49.024329 [info ] [MainThread]: 
14:50:49.024444 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:50:49.024552 [debug] [MainThread]: Connection 'master' was properly closed.
14:50:49.024609 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:50:49.026753 [info ] [MainThread]: 
14:50:49.026877 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:50:49.026995 [info ] [MainThread]: 
14:50:49.027097 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:50:49.027198 [error] [MainThread]:   syntax error at or near "from"
14:50:49.027294 [error] [MainThread]:   LINE 35:     from accounts
14:50:49.027390 [error] [MainThread]:                ^
14:50:49.027485 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:50:49.027588 [info ] [MainThread]: 
14:50:49.027687 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:50:49.027820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c3a6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c3a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11969e8b0>]}


============================== 2022-05-27 14:51:00.772645 | cb930da4-fb67-4111-b386-9a7da93f4d45 ==============================
14:51:00.772673 [info ] [MainThread]: Running with dbt=1.1.0
14:51:00.773145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:51:00.773239 [debug] [MainThread]: Tracking: tracking
14:51:00.788098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441ad00>]}
14:51:00.803924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:51:00.804168 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:51:00.809811 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:51:00.816812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:51:00.819088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471d0d0>]}
14:51:00.821333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bbe50>]}
14:51:00.821468 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:51:00.821598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bbeb0>]}
14:51:00.822286 [info ] [MainThread]: 
14:51:00.822502 [debug] [MainThread]: Acquiring new postgres connection "master"
14:51:00.822975 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:51:00.827434 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:51:00.827521 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:51:00.827630 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:51:00.834536 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:51:00.835474 [debug] [ThreadPool]: On list_demo_destination: Close
14:51:00.836036 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:51:00.858381 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:51:00.858557 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:51:00.858624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:51:00.862443 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:51:00.862522 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:51:00.862580 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:51:00.867453 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
14:51:00.868121 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:51:00.868319 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:51:00.870355 [debug] [MainThread]: Using postgres connection "master"
14:51:00.870456 [debug] [MainThread]: On master: BEGIN
14:51:00.870523 [debug] [MainThread]: Opening a new connection, currently in state init
14:51:00.873805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:51:00.873894 [debug] [MainThread]: Using postgres connection "master"
14:51:00.873958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:51:00.915778 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:51:00.916532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c2a60>]}
14:51:00.916711 [debug] [MainThread]: On master: ROLLBACK
14:51:00.916941 [debug] [MainThread]: Using postgres connection "master"
14:51:00.917028 [debug] [MainThread]: On master: BEGIN
14:51:00.917342 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:51:00.917441 [debug] [MainThread]: On master: COMMIT
14:51:00.917522 [debug] [MainThread]: Using postgres connection "master"
14:51:00.917595 [debug] [MainThread]: On master: COMMIT
14:51:00.917773 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:51:00.917858 [debug] [MainThread]: On master: Close
14:51:00.918030 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:51:00.918175 [info ] [MainThread]: 
14:51:00.919752 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:51:00.919901 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:51:00.920130 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:51:00.920212 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:51:00.920294 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:51:00.921012 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:51:00.921328 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.921417 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:51:00.933339 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:51:00.933712 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:51:00.933794 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:51:00.933863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:00.936547 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:51:00.936703 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:51:00.936784 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:51:00.937657 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:51:00.940981 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:51:00.941076 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:51:00.941361 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.942414 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:51:00.942496 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:51:00.942696 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.945737 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:51:00.945844 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:51:00.945911 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:51:00.946669 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:51:00.948804 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:51:00.948891 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:51:00.949931 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:51:00.950436 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.950530 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:51:00.950725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b34fa0>]}
14:51:00.950894 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:51:00.951090 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:51:00.951183 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:51:00.951284 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:51:00.951533 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:51:00.951618 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:51:00.951691 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:51:00.952313 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:51:00.952613 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.952688 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:51:00.953713 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:51:00.953920 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:51:00.953988 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:51:00.954050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:00.957370 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:51:00.957446 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:51:00.957506 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:51:00.959426 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:51:00.960461 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:51:00.960535 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:51:00.960841 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.961743 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:51:00.961815 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:51:00.962058 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.963321 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:51:00.963399 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:51:00.963462 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:51:00.963812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:51:00.964540 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:51:00.964666 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:51:00.965715 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:51:00.966207 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.966289 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:51:00.966460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e2460>]}
14:51:00.966606 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:51:00.966786 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:51:00.966876 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:51:00.967029 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:51:00.967267 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:51:00.967352 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:51:00.967424 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:51:00.968078 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:51:00.968358 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.968434 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:51:00.969399 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:51:00.969595 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:51:00.969665 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:51:00.969725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:00.974199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:51:00.974286 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:51:00.974348 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:51:00.976035 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:51:00.977161 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:51:00.977239 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:51:00.977579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.978524 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:51:00.978613 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:51:00.978884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.979387 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:51:00.979456 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:51:00.979519 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:51:00.980187 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:51:00.980963 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:51:00.981038 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:51:00.981822 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:51:00.982299 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.982384 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:51:00.982563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c3820>]}
14:51:00.982724 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:51:00.982906 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:51:00.982997 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:51:00.983146 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:51:00.983495 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:51:00.983605 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:51:00.983702 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:51:00.984415 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:51:00.984680 [debug] [Thread-1  ]: finished collecting timing info
14:51:00.984769 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:51:00.985764 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:51:00.985964 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:51:00.986030 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:51:00.986089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:00.991152 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:51:00.991244 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:51:00.991306 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:51:00.992949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:51:00.994028 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:51:00.994101 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:51:00.995617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.996542 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:51:00.996613 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:51:00.996921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:00.997432 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:51:00.997503 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:51:00.997565 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:51:00.997999 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:51:00.998637 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:51:00.998707 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:51:00.999769 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:51:01.000254 [debug] [Thread-1  ]: finished collecting timing info
14:51:01.000336 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:51:01.000504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c3dc0>]}
14:51:01.000656 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:51:01.000834 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:51:01.000926 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:51:01.001070 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:51:01.001250 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:51:01.001319 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:51:01.001389 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:51:01.001929 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:51:01.002164 [debug] [Thread-1  ]: finished collecting timing info
14:51:01.002236 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:51:01.003211 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:51:01.003391 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:51:01.003456 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:51:01.003515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:01.007078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:51:01.007149 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:51:01.007208 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:51:01.009070 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:51:01.010135 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:51:01.010214 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:51:01.010515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:01.012178 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:51:01.012250 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:51:01.012797 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:01.013333 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:51:01.013404 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:51:01.013468 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:51:01.013835 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:51:01.014534 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:51:01.014605 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:51:01.015395 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:51:01.015840 [debug] [Thread-1  ]: finished collecting timing info
14:51:01.015922 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:51:01.016084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105009e80>]}
14:51:01.016225 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.01s]
14:51:01.016400 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:51:01.016487 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:51:01.016609 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:51:01.016785 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:51:01.016857 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:51:01.016925 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:51:01.018331 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:51:01.018595 [debug] [Thread-1  ]: finished collecting timing info
14:51:01.018672 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:51:01.028545 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:51:01.028840 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:51:01.028915 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:51:01.028978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:51:01.036706 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:51:01.036803 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:51:01.036865 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id
        
    from accounts

)

select * from final
  );
14:51:01.041643 [debug] [Thread-1  ]: SQL status: SELECT 50 in 0.0 seconds
14:51:01.042778 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:51:01.042861 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers__dbt_tmp" rename to "customers"
14:51:01.043387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:51:01.046007 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
14:51:01.046097 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:51:01.046168 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
14:51:01.046617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:51:01.047335 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:51:01.047407 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
drop table if exists "demo_destination"."public"."customers__dbt_backup" cascade
14:51:01.047677 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
14:51:01.048217 [debug] [Thread-1  ]: finished collecting timing info
14:51:01.048334 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:51:01.048530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb930da4-fb67-4111-b386-9a7da93f4d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b7f40>]}
14:51:01.048692 [info ] [Thread-1  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 50[0m in 0.03s]
14:51:01.048882 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:51:01.049435 [debug] [MainThread]: Acquiring new postgres connection "master"
14:51:01.049539 [debug] [MainThread]: Using postgres connection "master"
14:51:01.049607 [debug] [MainThread]: On master: BEGIN
14:51:01.049672 [debug] [MainThread]: Opening a new connection, currently in state closed
14:51:01.054273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:51:01.054388 [debug] [MainThread]: On master: COMMIT
14:51:01.054453 [debug] [MainThread]: Using postgres connection "master"
14:51:01.054516 [debug] [MainThread]: On master: COMMIT
14:51:01.054710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:51:01.054785 [debug] [MainThread]: On master: Close
14:51:01.054958 [info ] [MainThread]: 
14:51:01.055083 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.23s.
14:51:01.055193 [debug] [MainThread]: Connection 'master' was properly closed.
14:51:01.055254 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:51:01.057516 [info ] [MainThread]: 
14:51:01.057648 [info ] [MainThread]: [32mCompleted successfully[0m
14:51:01.057773 [info ] [MainThread]: 
14:51:01.057878 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
14:51:01.058021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043fa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043fa520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b7070>]}


============================== 2022-05-27 14:52:27.090605 | 302088ef-61c5-4aee-b36a-8483bf710442 ==============================
14:52:27.090740 [info ] [MainThread]: Running with dbt=1.1.0
14:52:27.091251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:52:27.091365 [debug] [MainThread]: Tracking: tracking
14:52:27.105217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555ad60>]}
14:52:27.120720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:52:27.120954 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:52:27.127025 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:52:27.134869 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:52:27.137371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057460d0>]}
14:52:27.139841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e9e50>]}
14:52:27.139985 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:52:27.140115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e9ee0>]}
14:52:27.140858 [info ] [MainThread]: 
14:52:27.141088 [debug] [MainThread]: Acquiring new postgres connection "master"
14:52:27.141591 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:52:27.146199 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:52:27.146303 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:52:27.146385 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:27.182565 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
14:52:27.183651 [debug] [ThreadPool]: On list_demo_destination: Close
14:52:27.184289 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:52:27.207942 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:52:27.208103 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:52:27.208172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:52:27.213251 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:52:27.213343 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:52:27.213405 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:52:27.222087 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
14:52:27.222778 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:52:27.223214 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:52:27.225200 [debug] [MainThread]: Using postgres connection "master"
14:52:27.225285 [debug] [MainThread]: On master: BEGIN
14:52:27.225350 [debug] [MainThread]: Opening a new connection, currently in state init
14:52:27.246402 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
14:52:27.246537 [debug] [MainThread]: Using postgres connection "master"
14:52:27.246608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:52:27.274880 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:52:27.275764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101bc5f10>]}
14:52:27.275970 [debug] [MainThread]: On master: ROLLBACK
14:52:27.276220 [debug] [MainThread]: Using postgres connection "master"
14:52:27.276313 [debug] [MainThread]: On master: BEGIN
14:52:27.276635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:52:27.276728 [debug] [MainThread]: On master: COMMIT
14:52:27.276814 [debug] [MainThread]: Using postgres connection "master"
14:52:27.276887 [debug] [MainThread]: On master: COMMIT
14:52:27.277073 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:52:27.277174 [debug] [MainThread]: On master: Close
14:52:27.277361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:52:27.277515 [info ] [MainThread]: 
14:52:27.279192 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:52:27.279361 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:52:27.279603 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:52:27.279685 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:52:27.279766 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:52:27.280512 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:52:27.280839 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.280923 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:52:27.292916 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:52:27.293312 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:27.293391 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:52:27.293456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:27.295833 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:27.295929 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:27.296001 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:52:27.296917 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:27.299960 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:27.300053 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:52:27.300306 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.301337 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:27.301415 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:52:27.301640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.304750 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:52:27.304856 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:27.304919 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:52:27.305289 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:27.307500 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:27.307587 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:52:27.308320 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:27.308815 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.308898 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:52:27.309075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb18b0>]}
14:52:27.309246 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:52:27.309442 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:52:27.309535 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:52:27.309635 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:52:27.309819 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:52:27.309887 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:52:27.309953 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:52:27.310581 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:52:27.310854 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.310952 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:52:27.312020 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:52:27.312223 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:27.312292 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:52:27.312353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:27.315198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:27.315349 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:27.315420 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:52:27.316256 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:27.317482 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:27.317568 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:52:27.317779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.318696 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:27.318768 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:52:27.318983 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.320327 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:52:27.320408 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:27.320472 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:52:27.320758 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:27.321489 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:27.321574 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:52:27.322387 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:27.322962 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.323059 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:52:27.323241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580e7c0>]}
14:52:27.323404 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:52:27.323593 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:52:27.323681 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:52:27.323865 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:52:27.324083 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:52:27.324158 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:52:27.324227 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:52:27.324879 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:52:27.325130 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.325201 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:52:27.326191 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:52:27.326371 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:27.326434 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:52:27.326490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:27.330123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:27.330253 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:27.330323 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:52:27.332276 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:27.333519 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:27.333606 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:52:27.333918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.334923 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:27.335010 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:52:27.335345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.335902 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:52:27.335971 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:27.336031 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:52:27.336396 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:27.337118 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:27.337208 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:52:27.338710 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:27.339351 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.339480 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:52:27.339703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f9a90>]}
14:52:27.339869 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:52:27.340059 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:52:27.340154 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:52:27.340347 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:52:27.340577 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:52:27.340657 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:52:27.340730 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:52:27.341425 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:52:27.341724 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.341799 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:52:27.342845 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:52:27.343066 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:27.343152 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:52:27.343219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:27.347319 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:27.347453 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:27.347518 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:52:27.349347 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:27.350581 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:27.350661 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:52:27.351002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.351940 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:27.352029 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:52:27.352349 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.352882 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:52:27.352954 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:27.353014 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:52:27.353413 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:27.354259 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:27.354359 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:52:27.355744 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:27.356489 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.356601 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:52:27.356797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057dff10>]}
14:52:27.356962 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:52:27.357155 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:52:27.357245 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:52:27.357385 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:52:27.357570 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:52:27.357646 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:52:27.357717 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:52:27.358273 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:52:27.358497 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.358566 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:52:27.359546 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:52:27.359727 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:27.359788 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:52:27.359842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:27.364042 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:27.364172 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:27.364239 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:52:27.366680 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:27.367996 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:27.368076 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:52:27.368485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.370436 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:27.370534 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:52:27.371135 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:27.371704 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:52:27.371770 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:27.371828 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:52:27.372658 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:27.373621 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:27.373706 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:52:27.375063 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:27.375592 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.375687 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:52:27.375906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105854dc0>]}
14:52:27.376112 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:52:27.376319 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:52:27.376419 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:52:27.376726 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:52:27.377091 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:52:27.377178 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:52:27.377263 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:52:27.378795 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:52:27.379088 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.379168 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:52:27.389336 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:52:27.389560 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:52:27.389626 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:52:27.389684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:27.394846 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:52:27.395038 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:52:27.395103 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        customer_payments.total_payment

    from accounts

)

select * from final
  );
14:52:27.396671 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 34:         customer_payments.total_payment
                 ^

14:52:27.396759 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:52:27.397026 [debug] [Thread-1  ]: finished collecting timing info
14:52:27.397132 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:52:27.397304 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 34:         customer_payments.total_payment
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:52:27.397439 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '302088ef-61c5-4aee-b36a-8483bf710442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582bbb0>]}
14:52:27.397613 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:52:27.397817 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:52:27.398349 [debug] [MainThread]: Acquiring new postgres connection "master"
14:52:27.398443 [debug] [MainThread]: Using postgres connection "master"
14:52:27.398507 [debug] [MainThread]: On master: BEGIN
14:52:27.398567 [debug] [MainThread]: Opening a new connection, currently in state closed
14:52:27.404848 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:52:27.404977 [debug] [MainThread]: On master: COMMIT
14:52:27.405040 [debug] [MainThread]: Using postgres connection "master"
14:52:27.405099 [debug] [MainThread]: On master: COMMIT
14:52:27.405312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:52:27.405389 [debug] [MainThread]: On master: Close
14:52:27.405570 [info ] [MainThread]: 
14:52:27.405692 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
14:52:27.405801 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:27.405860 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:52:27.408334 [info ] [MainThread]: 
14:52:27.408464 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:52:27.408585 [info ] [MainThread]: 
14:52:27.408690 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:52:27.408793 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:52:27.408891 [error] [MainThread]:   LINE 34:         customer_payments.total_payment
14:52:27.408990 [error] [MainThread]:                    ^
14:52:27.409087 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:52:27.409193 [info ] [MainThread]: 
14:52:27.409294 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:52:27.409445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105552580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105552b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058227f0>]}


============================== 2022-05-27 14:52:55.692607 | a84809a4-a49b-4797-b4a2-71d02bde0c4a ==============================
14:52:55.692632 [info ] [MainThread]: Running with dbt=1.1.0
14:52:55.693073 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:52:55.693174 [debug] [MainThread]: Tracking: tracking
14:52:55.710277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11265bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11265bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11265bf70>]}
14:52:55.728125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:52:55.728426 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:52:55.734321 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:52:55.742164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:52:55.744695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112843f70>]}
14:52:55.747283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127defa0>]}
14:52:55.747444 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:52:55.747594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127daf40>]}
14:52:55.748378 [info ] [MainThread]: 
14:52:55.748613 [debug] [MainThread]: Acquiring new postgres connection "master"
14:52:55.749091 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:52:55.754139 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:52:55.754307 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:52:55.754384 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:52:55.789449 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
14:52:55.790516 [debug] [ThreadPool]: On list_demo_destination: Close
14:52:55.791187 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:52:55.815192 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:52:55.815349 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:52:55.815419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:52:55.821263 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:52:55.821363 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:52:55.821428 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:52:55.827128 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
14:52:55.827736 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:52:55.827992 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:52:55.830041 [debug] [MainThread]: Using postgres connection "master"
14:52:55.830131 [debug] [MainThread]: On master: BEGIN
14:52:55.830197 [debug] [MainThread]: Opening a new connection, currently in state init
14:52:55.833674 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:52:55.833761 [debug] [MainThread]: Using postgres connection "master"
14:52:55.833826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:52:55.873784 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:52:55.874581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126641c0>]}
14:52:55.874752 [debug] [MainThread]: On master: ROLLBACK
14:52:55.874953 [debug] [MainThread]: Using postgres connection "master"
14:52:55.875034 [debug] [MainThread]: On master: BEGIN
14:52:55.875294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:52:55.875374 [debug] [MainThread]: On master: COMMIT
14:52:55.875451 [debug] [MainThread]: Using postgres connection "master"
14:52:55.875519 [debug] [MainThread]: On master: COMMIT
14:52:55.875672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:52:55.875751 [debug] [MainThread]: On master: Close
14:52:55.875937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:52:55.876084 [info ] [MainThread]: 
14:52:55.877673 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:52:55.877838 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:52:55.878077 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:52:55.878159 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:52:55.878238 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:52:55.878977 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:52:55.879304 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.879389 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:52:55.891353 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:52:55.891753 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:55.891830 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:52:55.891897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:55.894401 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:55.894506 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:55.894578 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:52:55.895430 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:55.898529 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:55.898623 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:52:55.898896 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.899996 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:55.900081 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:52:55.900342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.903470 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:52:55.903597 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:55.903667 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:52:55.904214 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:55.906322 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:52:55.906410 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:52:55.906917 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:55.907411 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.907501 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:52:55.907697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d96b50>]}
14:52:55.907873 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:52:55.908084 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:52:55.908203 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:52:55.908358 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:52:55.908594 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:52:55.908668 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:52:55.908746 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:52:55.909373 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:52:55.909602 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.909678 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:52:55.910700 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:52:55.910890 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:55.910957 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:52:55.911016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:55.913294 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:55.913381 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:55.913446 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:52:55.914133 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:55.915245 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:55.915326 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:52:55.915804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.916703 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:55.916771 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:52:55.917039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.918483 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:52:55.918624 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:55.918692 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:52:55.919286 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:55.919997 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:52:55.920071 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:52:55.920976 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:55.921509 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.921601 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:52:55.921780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11262d730>]}
14:52:55.921930 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:52:55.922122 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:52:55.922206 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:52:55.922339 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:52:55.922514 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:52:55.922584 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:52:55.922652 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:52:55.923258 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:52:55.923516 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.923588 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:52:55.924528 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:52:55.924713 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:55.924778 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:52:55.924836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:55.928404 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:55.928520 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:55.928592 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:52:55.930724 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:55.931855 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:55.931936 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:52:55.932275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.933280 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:55.933356 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:52:55.933679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.934214 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:52:55.934311 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:55.934376 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:52:55.934984 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:55.935741 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:52:55.935820 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:52:55.936625 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:55.937108 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.937199 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:52:55.937377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11262d0a0>]}
14:52:55.937527 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
14:52:55.937708 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:52:55.937792 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:52:55.937987 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:52:55.938183 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:52:55.938257 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:52:55.938324 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:52:55.938974 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:52:55.939249 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.939319 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:52:55.940272 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:52:55.940462 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:55.940531 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:52:55.940589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:55.944718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:55.944814 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:55.944882 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:52:55.947274 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:55.948637 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:55.948745 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:52:55.949162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.950226 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:55.950321 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:52:55.954516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.955257 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:52:55.955359 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:55.955424 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:52:55.955966 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:55.956739 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:52:55.956823 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:52:55.957944 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:55.958521 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.958621 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:52:55.958817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11262d730>]}
14:52:55.958981 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:52:55.959176 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:52:55.959267 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:52:55.959412 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:52:55.959609 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:52:55.959682 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:52:55.959753 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:52:55.960283 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:52:55.960550 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.960628 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:52:55.961755 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:52:55.962094 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:55.962169 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:52:55.962232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:55.965863 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:52:55.965969 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:55.966038 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:52:55.967652 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:52:55.968851 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:55.968929 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:52:55.969233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.970915 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:55.970996 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:52:55.971268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:52:55.971798 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:52:55.971871 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:55.971933 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:52:55.972516 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:52:55.973268 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:52:55.973348 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:52:55.974475 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:52:55.975005 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.975108 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:52:55.975300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b68df0>]}
14:52:55.975465 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:52:55.975656 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:52:55.975746 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:52:55.975853 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:52:55.976078 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:52:55.976150 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:52:55.976218 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:52:55.977591 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:52:55.977842 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.977917 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:52:55.987535 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:52:55.987785 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:52:55.987858 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:52:55.987921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:52:55.993518 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:52:55.993615 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:52:55.993681 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

customer_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        customer_payments.total_payment as customer_lifetime_value

    from accounts

)

select * from final
  );
14:52:55.995261 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 34:         customer_payments.total_payment as customer_lifetime...
                 ^

14:52:55.995340 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:52:55.995595 [debug] [Thread-1  ]: finished collecting timing info
14:52:55.995681 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:52:55.995830 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 34:         customer_payments.total_payment as customer_lifetime...
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:52:55.995946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84809a4-a49b-4797-b4a2-71d02bde0c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b36280>]}
14:52:55.996095 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:52:55.996279 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:52:55.996781 [debug] [MainThread]: Acquiring new postgres connection "master"
14:52:55.996879 [debug] [MainThread]: Using postgres connection "master"
14:52:55.996946 [debug] [MainThread]: On master: BEGIN
14:52:55.997010 [debug] [MainThread]: Opening a new connection, currently in state closed
14:52:56.000298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:52:56.000378 [debug] [MainThread]: On master: COMMIT
14:52:56.000437 [debug] [MainThread]: Using postgres connection "master"
14:52:56.000496 [debug] [MainThread]: On master: COMMIT
14:52:56.000618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:52:56.000685 [debug] [MainThread]: On master: Close
14:52:56.000844 [info ] [MainThread]: 
14:52:56.000961 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:52:56.001072 [debug] [MainThread]: Connection 'master' was properly closed.
14:52:56.001135 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:52:56.003470 [info ] [MainThread]: 
14:52:56.003612 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:52:56.003731 [info ] [MainThread]: 
14:52:56.003838 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:52:56.003945 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:52:56.004043 [error] [MainThread]:   LINE 34:         customer_payments.total_payment as customer_lifetime...
14:52:56.004143 [error] [MainThread]:                    ^
14:52:56.004243 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:52:56.004347 [info ] [MainThread]: 
14:52:56.004448 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:52:56.004593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112641c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126417c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b7bc70>]}


============================== 2022-05-27 14:53:54.170661 | 6f29ce29-a9a1-4817-8a94-b0964c9228ac ==============================
14:53:54.170678 [info ] [MainThread]: Running with dbt=1.1.0
14:53:54.171083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:53:54.171178 [debug] [MainThread]: Tracking: tracking
14:53:54.184948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534040>]}
14:53:54.200227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:53:54.200450 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:53:54.206166 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:53:54.213773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:53:54.216015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107754fd0>]}
14:53:54.218561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107404a60>]}
14:53:54.218750 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:53:54.218895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dafd0>]}
14:53:54.219683 [info ] [MainThread]: 
14:53:54.219940 [debug] [MainThread]: Acquiring new postgres connection "master"
14:53:54.220434 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:53:54.225310 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:53:54.225419 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:53:54.225501 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:53:54.250761 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:53:54.251816 [debug] [ThreadPool]: On list_demo_destination: Close
14:53:54.252450 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:53:54.275571 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:53:54.275746 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:53:54.275812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:53:54.281851 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:53:54.282003 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:53:54.282074 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:53:54.287126 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
14:53:54.287791 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:53:54.288011 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:53:54.290210 [debug] [MainThread]: Using postgres connection "master"
14:53:54.290299 [debug] [MainThread]: On master: BEGIN
14:53:54.290363 [debug] [MainThread]: Opening a new connection, currently in state init
14:53:54.294268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:53:54.294358 [debug] [MainThread]: Using postgres connection "master"
14:53:54.294424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:53:54.325111 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:53:54.325916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106569b50>]}
14:53:54.326123 [debug] [MainThread]: On master: ROLLBACK
14:53:54.326376 [debug] [MainThread]: Using postgres connection "master"
14:53:54.326458 [debug] [MainThread]: On master: BEGIN
14:53:54.326808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:53:54.326889 [debug] [MainThread]: On master: COMMIT
14:53:54.326964 [debug] [MainThread]: Using postgres connection "master"
14:53:54.327032 [debug] [MainThread]: On master: COMMIT
14:53:54.327229 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:53:54.327314 [debug] [MainThread]: On master: Close
14:53:54.327491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:53:54.327686 [info ] [MainThread]: 
14:53:54.329432 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:53:54.329646 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:53:54.329933 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:53:54.330024 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:53:54.330108 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:53:54.330933 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:53:54.331260 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.331353 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:53:54.343156 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:53:54.343562 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:53:54.343636 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:53:54.343700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:54.346812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:53:54.346946 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:53:54.347014 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:53:54.347927 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:53:54.351044 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:53:54.351172 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:53:54.351525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.352631 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:53:54.352711 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:53:54.352926 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.355984 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:53:54.356103 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:53:54.356166 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:53:54.356958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:53:54.359050 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:53:54.359132 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:53:54.360327 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:53:54.360834 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.360934 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:53:54.361127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d4640>]}
14:53:54.361286 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:53:54.361475 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:53:54.361568 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:53:54.361666 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:53:54.361845 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:53:54.361914 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:53:54.362032 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:53:54.362664 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:53:54.362918 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.362994 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:53:54.364008 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:53:54.364199 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:53:54.364267 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:53:54.364326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:54.369111 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:53:54.369192 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:53:54.369253 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:53:54.371078 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:53:54.372139 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:53:54.372210 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:53:54.372685 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.373587 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:53:54.373657 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:53:54.374179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.375501 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:53:54.375591 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:53:54.375663 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:53:54.376758 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:53:54.377503 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:53:54.377585 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:53:54.379100 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:53:54.379678 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.379773 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:53:54.379965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078228b0>]}
14:53:54.380130 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:53:54.380318 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:53:54.380404 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:53:54.380593 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:53:54.380885 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:53:54.380966 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:53:54.381036 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:53:54.381702 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:53:54.381950 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.382029 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:53:54.383020 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:53:54.383205 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:53:54.383271 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:53:54.383331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:54.389410 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:53:54.389560 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:53:54.389630 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:53:54.391313 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:53:54.392571 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:53:54.392666 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:53:54.393199 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.394181 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:53:54.394256 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:53:54.396291 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.397010 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:53:54.397093 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:53:54.397160 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:53:54.399433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:53:54.400268 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:53:54.400368 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:53:54.401788 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:53:54.402303 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.402397 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:53:54.402589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ee040>]}
14:53:54.402769 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:53:54.402971 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:53:54.403063 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:53:54.403163 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:53:54.403347 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:53:54.403423 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:53:54.403496 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:53:54.404142 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:53:54.404557 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.404650 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:53:54.405713 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:53:54.405912 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:53:54.405984 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:53:54.406045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:54.411394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:53:54.411494 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:53:54.411562 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:53:54.414142 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:53:54.415502 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:53:54.415609 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:53:54.416180 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.417426 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:53:54.417533 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:53:54.418067 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.418634 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:53:54.418704 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:53:54.418765 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:53:54.419604 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:53:54.420378 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:53:54.420457 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:53:54.423037 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:53:54.423593 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.423680 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:53:54.423872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077546d0>]}
14:53:54.424039 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:53:54.424225 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:53:54.424314 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:53:54.424410 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:53:54.424650 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:53:54.424725 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:53:54.424797 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:53:54.425318 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:53:54.425576 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.425654 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:53:54.426717 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:53:54.426978 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:53:54.427049 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:53:54.427111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:54.432598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:53:54.432701 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:53:54.432764 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:53:54.436085 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:53:54.437290 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:53:54.437373 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:53:54.438342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.440061 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:53:54.440132 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:53:54.440765 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:53:54.441281 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:53:54.441350 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:53:54.441412 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:53:54.442238 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:53:54.442969 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:53:54.443043 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:53:54.444867 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:53:54.445485 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.445581 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:53:54.445787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107869eb0>]}
14:53:54.445955 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:53:54.446145 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:53:54.446235 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:53:54.446333 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:53:54.446561 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:53:54.446636 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:53:54.446704 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:53:54.448166 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:53:54.448480 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.448564 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:53:54.458892 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:53:54.459268 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:53:54.459362 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:53:54.459422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:53:54.464463 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:53:54.464631 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:53:54.464705 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        customer_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on account.account_id = account_payments.account_id

)

select * from final
  );
14:53:54.466939 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "account"
LINE 39:         on account.account_id = account_payments.account_id
                    ^

14:53:54.467039 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:53:54.467307 [debug] [Thread-1  ]: finished collecting timing info
14:53:54.467394 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:53:54.467577 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "account"
  LINE 39:         on account.account_id = account_payments.account_id
                      ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:53:54.467716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f29ce29-a9a1-4817-8a94-b0964c9228ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787cfa0>]}
14:53:54.467903 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:53:54.468123 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:53:54.468637 [debug] [MainThread]: Acquiring new postgres connection "master"
14:53:54.468739 [debug] [MainThread]: Using postgres connection "master"
14:53:54.468808 [debug] [MainThread]: On master: BEGIN
14:53:54.468870 [debug] [MainThread]: Opening a new connection, currently in state closed
14:53:54.474783 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:53:54.474907 [debug] [MainThread]: On master: COMMIT
14:53:54.474975 [debug] [MainThread]: Using postgres connection "master"
14:53:54.475036 [debug] [MainThread]: On master: COMMIT
14:53:54.475201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:53:54.475280 [debug] [MainThread]: On master: Close
14:53:54.475489 [info ] [MainThread]: 
14:53:54.475632 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
14:53:54.475783 [debug] [MainThread]: Connection 'master' was properly closed.
14:53:54.475857 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:53:54.478341 [info ] [MainThread]: 
14:53:54.478499 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:53:54.478624 [info ] [MainThread]: 
14:53:54.478731 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:53:54.478837 [error] [MainThread]:   missing FROM-clause entry for table "account"
14:53:54.478933 [error] [MainThread]:   LINE 39:         on account.account_id = account_payments.account_id
14:53:54.479029 [error] [MainThread]:                       ^
14:53:54.479124 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:53:54.479236 [info ] [MainThread]: 
14:53:54.479343 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:53:54.479507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ee700>]}


============================== 2022-05-27 14:54:31.728292 | b89d449b-6896-43f3-967d-b24de34c91c9 ==============================
14:54:31.728310 [info ] [MainThread]: Running with dbt=1.1.0
14:54:31.728760 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:54:31.728867 [debug] [MainThread]: Tracking: tracking
14:54:31.744187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1daca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1dadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1dadf0>]}
14:54:31.760322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:54:31.760578 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:54:31.766313 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:54:31.773641 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:54:31.775975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4da0d0>]}
14:54:31.778292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47ce50>]}
14:54:31.778431 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:54:31.778571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47cee0>]}
14:54:31.779259 [info ] [MainThread]: 
14:54:31.779479 [debug] [MainThread]: Acquiring new postgres connection "master"
14:54:31.779939 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:54:31.784508 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:54:31.784632 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:54:31.784703 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:54:31.810536 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:54:31.811449 [debug] [ThreadPool]: On list_demo_destination: Close
14:54:31.812046 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:54:31.835486 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:54:31.835665 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:54:31.835738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:54:31.839564 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:54:31.839652 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:54:31.839713 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:54:31.842676 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
14:54:31.843282 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:54:31.843456 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:54:31.845454 [debug] [MainThread]: Using postgres connection "master"
14:54:31.845556 [debug] [MainThread]: On master: BEGIN
14:54:31.845623 [debug] [MainThread]: Opening a new connection, currently in state init
14:54:31.848857 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:54:31.848931 [debug] [MainThread]: Using postgres connection "master"
14:54:31.848992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:54:31.886748 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:54:31.887476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105066eb0>]}
14:54:31.887635 [debug] [MainThread]: On master: ROLLBACK
14:54:31.887853 [debug] [MainThread]: Using postgres connection "master"
14:54:31.887938 [debug] [MainThread]: On master: BEGIN
14:54:31.888269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:54:31.888348 [debug] [MainThread]: On master: COMMIT
14:54:31.888420 [debug] [MainThread]: Using postgres connection "master"
14:54:31.888487 [debug] [MainThread]: On master: COMMIT
14:54:31.888660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:54:31.888749 [debug] [MainThread]: On master: Close
14:54:31.888920 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:54:31.889064 [info ] [MainThread]: 
14:54:31.890651 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:54:31.890826 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:54:31.891182 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:54:31.891403 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:54:31.891541 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:54:31.892373 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:54:31.892725 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.892819 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:54:31.905084 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:54:31.905480 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:31.905567 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:54:31.905640 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:31.908670 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:31.908791 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:31.908860 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:54:31.909759 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:31.912773 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:31.912865 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:54:31.913176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.914182 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:31.914257 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:54:31.914500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.917546 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:54:31.917655 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:31.917725 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:54:31.918336 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:31.920441 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:31.920524 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:54:31.922034 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:31.922539 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.922629 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:54:31.922825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7f82e0>]}
14:54:31.922993 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:54:31.923186 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:54:31.923276 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:54:31.923425 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:54:31.923635 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:54:31.923712 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:54:31.923784 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:54:31.924414 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:54:31.924631 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.924702 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:54:31.925700 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:54:31.925889 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:31.925954 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:54:31.926015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:31.929502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:31.929594 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:31.929654 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:54:31.931589 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:31.932674 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:31.932753 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:54:31.933081 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.933973 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:31.934042 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:54:31.934304 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.935581 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:54:31.935665 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:31.935731 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:54:31.936133 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:31.936808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:31.936880 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:54:31.938062 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:31.938605 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.938692 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:54:31.938880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af87f70>]}
14:54:31.939040 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:54:31.939225 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:54:31.939313 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:54:31.939408 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:54:31.939606 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:54:31.939701 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:54:31.939774 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:54:31.940441 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:54:31.940725 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.940817 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:54:31.941864 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:54:31.942062 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:31.942133 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:54:31.942195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:31.946046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:31.946160 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:31.946224 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:54:31.948159 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:31.949274 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:31.949347 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:54:31.949626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.950561 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:31.950629 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:54:31.950980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.951493 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:54:31.951560 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:31.951620 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:54:31.951894 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:31.952501 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:31.952567 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:54:31.954494 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:31.955052 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.955145 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:54:31.955356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b578340>]}
14:54:31.955524 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:54:31.955720 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:54:31.955817 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:54:31.956006 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:54:31.956220 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:54:31.956301 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:54:31.956374 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:54:31.957083 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:54:31.957351 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.957424 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:54:31.958442 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:54:31.958633 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:31.958700 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:54:31.958760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:31.962985 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:31.963087 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:31.963146 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:54:31.965278 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:31.966381 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:31.966452 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:54:31.966761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.967669 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:31.967737 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:54:31.968021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.968511 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:54:31.968592 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:31.968650 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:54:31.969052 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:31.969761 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:31.969840 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:54:31.971664 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:31.972257 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.972360 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:54:31.972562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af875e0>]}
14:54:31.972729 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:54:31.972920 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:54:31.973011 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:54:31.973159 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:54:31.973369 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:54:31.973449 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:54:31.973520 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:54:31.974103 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:54:31.974375 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.974448 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:54:31.975514 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:54:31.975747 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:31.975825 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:54:31.975884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:31.982021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:54:31.982149 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:31.982211 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:54:31.985403 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:31.986777 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:31.986868 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:54:31.987421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.989385 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:31.989522 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:54:31.989861 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:31.990448 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:54:31.990523 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:31.990583 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:54:31.991032 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:31.991761 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:31.991837 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:54:31.992973 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:31.993477 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.993564 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:54:31.993758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d7fd0>]}
14:54:31.993927 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:54:31.994124 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:54:31.994218 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:54:31.994357 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:54:31.994677 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:54:31.994829 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:54:31.994904 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:54:31.996301 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:54:31.996558 [debug] [Thread-1  ]: finished collecting timing info
14:54:31.996643 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:54:32.006521 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:54:32.006838 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:32.006912 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:54:32.006977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:32.010778 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:32.010929 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:32.010998 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        customer_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:54:32.012495 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customer_payments"
LINE 34:         customer_payments.total_payment as account_lifetime_...
                 ^

14:54:32.012610 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:54:32.012836 [debug] [Thread-1  ]: finished collecting timing info
14:54:32.012916 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:54:32.013092 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "customer_payments"
  LINE 34:         customer_payments.total_payment as account_lifetime_...
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:54:32.013231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b89d449b-6896-43f3-967d-b24de34c91c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b6640>]}
14:54:32.013410 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:54:32.013617 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:54:32.014131 [debug] [MainThread]: Acquiring new postgres connection "master"
14:54:32.014239 [debug] [MainThread]: Using postgres connection "master"
14:54:32.014306 [debug] [MainThread]: On master: BEGIN
14:54:32.014365 [debug] [MainThread]: Opening a new connection, currently in state closed
14:54:32.017456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:54:32.017559 [debug] [MainThread]: On master: COMMIT
14:54:32.017618 [debug] [MainThread]: Using postgres connection "master"
14:54:32.017677 [debug] [MainThread]: On master: COMMIT
14:54:32.017951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:54:32.018016 [debug] [MainThread]: On master: Close
14:54:32.018159 [info ] [MainThread]: 
14:54:32.018276 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
14:54:32.018383 [debug] [MainThread]: Connection 'master' was properly closed.
14:54:32.018441 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:54:32.020676 [info ] [MainThread]: 
14:54:32.020800 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:54:32.020923 [info ] [MainThread]: 
14:54:32.021027 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:54:32.021132 [error] [MainThread]:   missing FROM-clause entry for table "customer_payments"
14:54:32.021233 [error] [MainThread]:   LINE 34:         customer_payments.total_payment as account_lifetime_...
14:54:32.021330 [error] [MainThread]:                    ^
14:54:32.021427 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:54:32.021535 [info ] [MainThread]: 
14:54:32.021636 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:54:32.021788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af87f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa1520>]}


============================== 2022-05-27 14:54:47.789484 | 323ae180-77f4-46a2-aadd-8f66c919f13c ==============================
14:54:47.789501 [info ] [MainThread]: Running with dbt=1.1.0
14:54:47.789948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:54:47.790053 [debug] [MainThread]: Tracking: tracking
14:54:47.804339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d8eb0>]}
14:54:47.819927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:54:47.820178 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:54:47.825877 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:54:47.833274 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:54:47.835640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c1ee0>]}
14:54:47.837956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845aeb0>]}
14:54:47.838098 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:54:47.838231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b4be0>]}
14:54:47.838937 [info ] [MainThread]: 
14:54:47.839180 [debug] [MainThread]: Acquiring new postgres connection "master"
14:54:47.839677 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:54:47.844215 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:54:47.844338 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:54:47.844410 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:54:47.876540 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:54:47.877397 [debug] [ThreadPool]: On list_demo_destination: Close
14:54:47.878020 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:54:47.900954 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:54:47.901123 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:54:47.901195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:54:47.905695 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:54:47.905789 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:54:47.905850 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:54:47.909984 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
14:54:47.910639 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:54:47.910863 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:54:47.912849 [debug] [MainThread]: Using postgres connection "master"
14:54:47.912937 [debug] [MainThread]: On master: BEGIN
14:54:47.913005 [debug] [MainThread]: Opening a new connection, currently in state init
14:54:47.917754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:54:47.917872 [debug] [MainThread]: Using postgres connection "master"
14:54:47.917939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:54:47.954191 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:54:47.954966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108282df0>]}
14:54:47.955140 [debug] [MainThread]: On master: ROLLBACK
14:54:47.955335 [debug] [MainThread]: Using postgres connection "master"
14:54:47.955417 [debug] [MainThread]: On master: BEGIN
14:54:47.955671 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:54:47.955750 [debug] [MainThread]: On master: COMMIT
14:54:47.955819 [debug] [MainThread]: Using postgres connection "master"
14:54:47.955887 [debug] [MainThread]: On master: COMMIT
14:54:47.956044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:54:47.956124 [debug] [MainThread]: On master: Close
14:54:47.956297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:54:47.956450 [info ] [MainThread]: 
14:54:47.958043 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:54:47.958195 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:54:47.958422 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:54:47.958509 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:54:47.958589 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:54:47.959351 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:54:47.959695 [debug] [Thread-1  ]: finished collecting timing info
14:54:47.959792 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:54:47.971297 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:54:47.971652 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:47.971734 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:54:47.971800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:47.974632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:47.974727 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:47.974795 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:54:47.975631 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:47.978582 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:47.978672 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:54:47.978925 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:47.979905 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:47.979977 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:54:47.980165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:47.983052 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:54:47.983147 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:47.983209 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:54:47.983530 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:47.985526 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:54:47.985611 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:54:47.986118 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:47.986611 [debug] [Thread-1  ]: finished collecting timing info
14:54:47.986700 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:54:47.986897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ff370>]}
14:54:47.987099 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:54:47.987398 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:54:47.987574 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:54:47.987745 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:54:47.988014 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:54:47.988099 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:54:47.988172 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:54:47.988842 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:54:47.989109 [debug] [Thread-1  ]: finished collecting timing info
14:54:47.989193 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:54:47.990222 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:54:47.990411 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:47.990476 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:54:47.990535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:47.992622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:47.992706 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:47.992767 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:54:47.993418 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:47.994486 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:47.994562 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:54:47.997989 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:47.998975 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:47.999065 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:54:47.999351 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.000645 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:54:48.000721 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:48.000782 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:54:48.001408 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:48.002045 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:54:48.002111 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:54:48.003084 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:48.003621 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.003720 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:54:48.003914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108078b80>]}
14:54:48.004079 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:54:48.004269 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:54:48.004361 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:54:48.004502 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:54:48.004690 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:54:48.004759 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:54:48.004826 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:54:48.005471 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:54:48.005744 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.005824 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:54:48.006922 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:54:48.007213 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:48.007288 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:54:48.007347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:48.011108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:54:48.011239 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:48.011302 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:54:48.014210 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:48.015446 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:48.015548 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:54:48.015967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.016883 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:48.016952 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:54:48.017293 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.017798 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:54:48.017865 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:48.017923 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:54:48.018412 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:48.019026 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:54:48.019092 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:54:48.021687 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:48.022183 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.022267 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:54:48.022447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085754c0>]}
14:54:48.022606 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:54:48.022787 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:54:48.022868 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:54:48.022962 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:54:48.023137 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:54:48.023206 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:54:48.023274 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:54:48.023885 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:54:48.024175 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.024268 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:54:48.025274 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:54:48.025469 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:48.025540 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:54:48.025602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:48.032310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:54:48.032394 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:48.032454 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:54:48.034951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:48.036027 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:48.036105 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:54:48.036644 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.037714 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:48.037838 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:54:48.038587 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.039299 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:54:48.039382 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:48.039446 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:54:48.040131 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:48.040877 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:54:48.040946 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:54:48.042062 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:48.042600 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.042687 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:54:48.042879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108556670>]}
14:54:48.043044 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:54:48.043260 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:54:48.043349 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:54:48.043446 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:54:48.043641 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:54:48.043720 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:54:48.043790 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:54:48.044547 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:54:48.044880 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.044965 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:54:48.046043 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:54:48.046235 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:48.046301 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:54:48.046360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:48.051879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:54:48.052010 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:48.052078 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:54:48.054972 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:54:48.056235 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:48.056313 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:54:48.056734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.058410 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:48.058480 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:54:48.062290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.062929 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:54:48.063009 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:48.063070 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:54:48.063892 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:48.064664 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:54:48.064733 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:54:48.066041 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:54:48.066498 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.066579 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:54:48.066753 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d3d90>]}
14:54:48.066911 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:54:48.067087 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:54:48.067174 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:54:48.067328 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:54:48.067521 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:54:48.067592 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:54:48.067657 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:54:48.069061 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:54:48.069354 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.069443 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:54:48.079817 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:54:48.080175 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:48.080244 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:54:48.080312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:54:48.090134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:54:48.090233 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:48.090301 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:54:48.098268 [debug] [Thread-1  ]: SQL status: SELECT 50 in 0.01 seconds
14:54:48.099583 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:48.099664 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers" rename to "customers__dbt_backup"
14:54:48.099958 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.100943 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:48.101016 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers__dbt_tmp" rename to "customers"
14:54:48.104415 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:54:48.107114 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
14:54:48.107200 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:48.107269 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
14:54:48.107786 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:54:48.108572 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:54:48.108646 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
drop table if exists "demo_destination"."public"."customers__dbt_backup" cascade
14:54:48.111249 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
14:54:48.111773 [debug] [Thread-1  ]: finished collecting timing info
14:54:48.111866 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:54:48.112064 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323ae180-77f4-46a2-aadd-8f66c919f13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c53d0>]}
14:54:48.112239 [info ] [Thread-1  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 50[0m in 0.04s]
14:54:48.112440 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:54:48.112930 [debug] [MainThread]: Acquiring new postgres connection "master"
14:54:48.113025 [debug] [MainThread]: Using postgres connection "master"
14:54:48.113094 [debug] [MainThread]: On master: BEGIN
14:54:48.113158 [debug] [MainThread]: Opening a new connection, currently in state closed
14:54:48.116944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:54:48.117028 [debug] [MainThread]: On master: COMMIT
14:54:48.117094 [debug] [MainThread]: Using postgres connection "master"
14:54:48.117156 [debug] [MainThread]: On master: COMMIT
14:54:48.117304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:54:48.117375 [debug] [MainThread]: On master: Close
14:54:48.117527 [info ] [MainThread]: 
14:54:48.117652 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.28s.
14:54:48.117815 [debug] [MainThread]: Connection 'master' was properly closed.
14:54:48.117885 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:54:48.120149 [info ] [MainThread]: 
14:54:48.120288 [info ] [MainThread]: [32mCompleted successfully[0m
14:54:48.120417 [info ] [MainThread]: 
14:54:48.120523 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
14:54:48.120663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c0490>]}


============================== 2022-05-27 14:56:43.843700 | eb004f3c-db45-4d85-adcf-a09a7ce5785a ==============================
14:56:43.843763 [info ] [MainThread]: Running with dbt=1.1.0
14:56:43.844254 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:56:43.844497 [debug] [MainThread]: Tracking: tracking
14:56:43.861169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109363dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109363ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109363f10>]}
14:56:43.876872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:56:43.877137 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:56:43.883221 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:56:43.890565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:56:43.892895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109657f40>]}
14:56:43.895273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933c5b0>]}
14:56:43.895431 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:56:43.895566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e2f10>]}
14:56:43.896261 [info ] [MainThread]: 
14:56:43.896487 [debug] [MainThread]: Acquiring new postgres connection "master"
14:56:43.896971 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:56:43.902086 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:56:43.902234 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:56:43.902312 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:56:43.932875 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:56:43.933864 [debug] [ThreadPool]: On list_demo_destination: Close
14:56:43.934506 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:56:43.959103 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:56:43.959266 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:56:43.959336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:56:43.964646 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:56:43.964824 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:56:43.964906 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:56:43.971014 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
14:56:43.971773 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:56:43.971997 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:56:43.974290 [debug] [MainThread]: Using postgres connection "master"
14:56:43.974389 [debug] [MainThread]: On master: BEGIN
14:56:43.974460 [debug] [MainThread]: Opening a new connection, currently in state init
14:56:43.978610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:56:43.978690 [debug] [MainThread]: Using postgres connection "master"
14:56:43.978758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:56:44.007809 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:56:44.008649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930bf10>]}
14:56:44.008840 [debug] [MainThread]: On master: ROLLBACK
14:56:44.009082 [debug] [MainThread]: Using postgres connection "master"
14:56:44.009169 [debug] [MainThread]: On master: BEGIN
14:56:44.009487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:56:44.009568 [debug] [MainThread]: On master: COMMIT
14:56:44.009646 [debug] [MainThread]: Using postgres connection "master"
14:56:44.009716 [debug] [MainThread]: On master: COMMIT
14:56:44.009894 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:56:44.009979 [debug] [MainThread]: On master: Close
14:56:44.010157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:56:44.010309 [info ] [MainThread]: 
14:56:44.011971 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:56:44.012129 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:56:44.012366 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:56:44.012444 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:56:44.012519 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:56:44.013212 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:56:44.013557 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.013638 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:56:44.025107 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:56:44.025462 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:56:44.025537 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:56:44.025601 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:44.028021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:56:44.028104 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:56:44.028168 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:56:44.028993 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:56:44.031976 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:56:44.032099 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:56:44.032485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.033697 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:56:44.033794 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:56:44.034046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.037250 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:56:44.037392 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:56:44.037466 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:56:44.038082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:56:44.040272 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:56:44.040363 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:56:44.041633 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:56:44.042150 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.042255 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:56:44.042453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108396b50>]}
14:56:44.042624 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:56:44.042828 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:56:44.042919 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:56:44.043021 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:56:44.043209 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:56:44.043288 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:56:44.043415 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:56:44.044064 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:56:44.044361 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.044440 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:56:44.045447 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:56:44.045658 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:56:44.045725 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:56:44.045789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:44.049687 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:56:44.049778 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:56:44.049845 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:56:44.051709 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:56:44.052861 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:56:44.053017 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:56:44.053823 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.054933 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:56:44.055021 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:56:44.055311 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.056648 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:56:44.056743 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:56:44.056809 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:56:44.057500 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:56:44.058235 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:56:44.058317 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:56:44.059203 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:56:44.059707 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.059802 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:56:44.059987 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bfa30>]}
14:56:44.060149 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:56:44.060330 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:56:44.060421 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:56:44.060524 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:56:44.060700 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:56:44.060811 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:56:44.060899 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:56:44.061514 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:56:44.061759 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.061838 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:56:44.062824 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:56:44.063038 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:56:44.063106 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:56:44.063167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:44.068331 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:56:44.068444 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:56:44.068510 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:56:44.071680 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:56:44.072951 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:56:44.073061 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:56:44.073543 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.074554 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:56:44.074664 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:56:44.075023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.075630 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:56:44.075725 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:56:44.075790 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:56:44.076530 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:56:44.077182 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:56:44.077250 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:56:44.078507 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:56:44.078967 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.079055 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:56:44.079253 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b21670>]}
14:56:44.079419 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:56:44.079615 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:56:44.079715 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:56:44.079813 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:56:44.079997 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:56:44.080073 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:56:44.080148 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:56:44.080993 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:56:44.081368 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.081482 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:56:44.082618 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:56:44.082856 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:56:44.082936 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:56:44.083006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:44.086573 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:56:44.086722 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:56:44.086792 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:56:44.089493 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:56:44.090744 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:56:44.090844 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:56:44.091332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.092369 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:56:44.092450 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:56:44.092830 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.093384 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:56:44.093451 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:56:44.093513 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:56:44.093996 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:56:44.094628 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:56:44.094696 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:56:44.096286 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:56:44.096925 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.097089 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:56:44.097300 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bfa30>]}
14:56:44.097464 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:56:44.097651 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:56:44.097733 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:56:44.097827 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:56:44.098122 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:56:44.098230 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:56:44.098297 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:56:44.098903 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:56:44.099195 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.099274 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:56:44.100374 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:56:44.100636 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:56:44.100701 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:56:44.100758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:44.104937 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:56:44.105094 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:56:44.105159 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:56:44.106913 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:56:44.108092 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:56:44.108178 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:56:44.108547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.110569 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:56:44.110667 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:56:44.111029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:56:44.111566 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:56:44.111640 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:56:44.111699 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:56:44.112322 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:56:44.113049 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:56:44.113123 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:56:44.115504 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:56:44.115986 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.116067 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:56:44.116248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109768dc0>]}
14:56:44.116414 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:56:44.116597 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:56:44.116691 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:56:44.116796 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:56:44.116980 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:56:44.117048 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:56:44.117118 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:56:44.118575 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:56:44.119005 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.119131 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:56:44.129160 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:56:44.129508 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:56:44.129615 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:56:44.129693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:56:44.137619 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:56:44.137750 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:56:44.137821 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount where account_payments.state = "successful" ) as total_payment
    
    from payments

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:56:44.138259 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "where"
LINE 22:     sum( amount where account_payments.state = "successful" ...
                         ^

14:56:44.138353 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:56:44.138609 [debug] [Thread-1  ]: finished collecting timing info
14:56:44.138693 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:56:44.138851 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "where"
  LINE 22:     sum( amount where account_payments.state = "successful" ...
                           ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:56:44.138980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb004f3c-db45-4d85-adcf-a09a7ce5785a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973fee0>]}
14:56:44.139141 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:56:44.139339 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:56:44.139829 [debug] [MainThread]: Acquiring new postgres connection "master"
14:56:44.139922 [debug] [MainThread]: Using postgres connection "master"
14:56:44.139989 [debug] [MainThread]: On master: BEGIN
14:56:44.140063 [debug] [MainThread]: Opening a new connection, currently in state closed
14:56:44.145789 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:56:44.145868 [debug] [MainThread]: On master: COMMIT
14:56:44.145931 [debug] [MainThread]: Using postgres connection "master"
14:56:44.145989 [debug] [MainThread]: On master: COMMIT
14:56:44.146179 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:56:44.146246 [debug] [MainThread]: On master: Close
14:56:44.146391 [info ] [MainThread]: 
14:56:44.146507 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:56:44.146646 [debug] [MainThread]: Connection 'master' was properly closed.
14:56:44.146719 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:56:44.149062 [info ] [MainThread]: 
14:56:44.149198 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:56:44.149322 [info ] [MainThread]: 
14:56:44.149536 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:56:44.149644 [error] [MainThread]:   syntax error at or near "where"
14:56:44.149747 [error] [MainThread]:   LINE 22:     sum( amount where account_payments.state = "successful" ...
14:56:44.149845 [error] [MainThread]:                            ^
14:56:44.149945 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:56:44.150056 [info ] [MainThread]: 
14:56:44.150158 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:56:44.150300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109344940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109344040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109348e20>]}


============================== 2022-05-27 14:58:49.216947 | 0fba3499-8223-498d-98a8-89ee68be414c ==============================
14:58:49.216962 [info ] [MainThread]: Running with dbt=1.1.0
14:58:49.217435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:58:49.217541 [debug] [MainThread]: Tracking: tracking
14:58:49.231948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f16df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f16f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f16f70>]}
14:58:49.247550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:58:49.247810 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:58:49.253768 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:58:49.261303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:58:49.263593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109103f70>]}
14:58:49.266335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909ffa0>]}
14:58:49.266527 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:58:49.266684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909af40>]}
14:58:49.267454 [info ] [MainThread]: 
14:58:49.267703 [debug] [MainThread]: Acquiring new postgres connection "master"
14:58:49.268213 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:58:49.273303 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:58:49.273445 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:58:49.273526 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:58:49.296429 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
14:58:49.297396 [debug] [ThreadPool]: On list_demo_destination: Close
14:58:49.298032 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:58:49.321406 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:58:49.321581 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:58:49.321648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:58:49.327626 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:58:49.327715 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:58:49.327779 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:58:49.333380 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
14:58:49.334025 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:58:49.334238 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:58:49.336246 [debug] [MainThread]: Using postgres connection "master"
14:58:49.336340 [debug] [MainThread]: On master: BEGIN
14:58:49.336408 [debug] [MainThread]: Opening a new connection, currently in state init
14:58:49.346661 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:58:49.346753 [debug] [MainThread]: Using postgres connection "master"
14:58:49.346836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:58:49.373013 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:58:49.373741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f241c0>]}
14:58:49.373916 [debug] [MainThread]: On master: ROLLBACK
14:58:49.374132 [debug] [MainThread]: Using postgres connection "master"
14:58:49.374216 [debug] [MainThread]: On master: BEGIN
14:58:49.374476 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:58:49.374557 [debug] [MainThread]: On master: COMMIT
14:58:49.374631 [debug] [MainThread]: Using postgres connection "master"
14:58:49.374700 [debug] [MainThread]: On master: COMMIT
14:58:49.374860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:58:49.374944 [debug] [MainThread]: On master: Close
14:58:49.375112 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:58:49.375260 [info ] [MainThread]: 
14:58:49.376882 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:58:49.377036 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:58:49.377269 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:58:49.377352 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:58:49.377431 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:58:49.378173 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:58:49.378508 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.378593 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:58:49.390169 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:58:49.390435 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:58:49.390514 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:58:49.390583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:49.393324 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:58:49.393453 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:58:49.393535 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:58:49.394452 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:58:49.397637 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:58:49.397773 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:58:49.398101 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.399336 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:58:49.399426 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:58:49.399679 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.402850 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:58:49.402959 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:58:49.403030 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:58:49.403673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:58:49.405950 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:58:49.406083 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:58:49.406921 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:58:49.407649 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.407755 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:58:49.407952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b9400>]}
14:58:49.408115 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:58:49.408309 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:58:49.408399 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:58:49.408595 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:58:49.408902 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:58:49.408985 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:58:49.409063 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:58:49.409766 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:58:49.410068 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.410143 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:58:49.411217 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:58:49.411415 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:58:49.411480 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:58:49.411543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:49.414029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:58:49.414114 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:58:49.414176 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:58:49.414997 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:58:49.416160 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:58:49.416241 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:58:49.416518 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.417530 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:58:49.417615 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:58:49.417843 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.419207 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:58:49.419289 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:58:49.419355 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:58:49.419616 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:58:49.420245 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:58:49.420321 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:58:49.420960 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:58:49.421474 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.421565 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:58:49.421747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eed6d0>]}
14:58:49.421918 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:58:49.422123 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:58:49.422217 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:58:49.422364 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:58:49.422562 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:58:49.422631 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:58:49.422697 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:58:49.423305 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:58:49.423526 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.423600 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:58:49.424566 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:58:49.424748 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:58:49.424816 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:58:49.424880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:49.428360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:58:49.428490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:58:49.428554 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:58:49.430432 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:58:49.431622 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:58:49.431699 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:58:49.432060 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.432965 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:58:49.433033 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:58:49.433296 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.433795 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:58:49.433884 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:58:49.433943 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:58:49.434292 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:58:49.434892 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:58:49.434957 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:58:49.436097 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:58:49.436546 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.436629 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:58:49.436794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eed070>]}
14:58:49.436938 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
14:58:49.437116 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:58:49.437204 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:58:49.437342 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:58:49.437556 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:58:49.437622 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:58:49.437688 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:58:49.438294 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:58:49.438557 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.438631 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:58:49.439675 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:58:49.439896 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:58:49.439964 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:58:49.440025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:49.443570 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:58:49.443665 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:58:49.443733 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:58:49.445499 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:58:49.446757 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:58:49.446845 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:58:49.447205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.448152 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:58:49.448221 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:58:49.448482 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.449024 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:58:49.449130 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:58:49.449196 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:58:49.449626 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:58:49.450322 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:58:49.450396 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:58:49.451320 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:58:49.451842 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.451928 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:58:49.452102 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eed370>]}
14:58:49.452255 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.01s]
14:58:49.452430 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:58:49.452523 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:58:49.452660 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:58:49.452839 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:58:49.452908 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:58:49.452974 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:58:49.453464 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:58:49.453684 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.453753 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:58:49.454728 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:58:49.454920 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:58:49.454986 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:58:49.455045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:49.460185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:58:49.460334 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:58:49.460417 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:58:49.462209 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:58:49.463434 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:58:49.463526 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:58:49.463903 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.465692 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:58:49.465799 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:58:49.466122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:58:49.466662 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:58:49.466732 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:58:49.466796 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:58:49.467208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:58:49.468007 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:58:49.468091 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:58:49.469013 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:58:49.469436 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.469519 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:58:49.469692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eed0d0>]}
14:58:49.469837 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:58:49.470019 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:58:49.470104 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:58:49.470244 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:58:49.470416 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:58:49.470484 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:58:49.470554 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:58:49.472092 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:58:49.472433 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.472532 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:58:49.482739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:58:49.483138 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:58:49.483224 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:58:49.483290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:58:49.486878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:58:49.486955 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:58:49.487013 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    where account_payments.status = "successful"

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:58:49.488182 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "account_payments"
LINE 26:     where account_payments.status = "successful"
                   ^

14:58:49.488258 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:58:49.488463 [debug] [Thread-1  ]: finished collecting timing info
14:58:49.488538 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:58:49.488678 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "account_payments"
  LINE 26:     where account_payments.status = "successful"
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:58:49.488797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba3499-8223-498d-98a8-89ee68be414c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ebe50>]}
14:58:49.488952 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:58:49.489140 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:58:49.489681 [debug] [MainThread]: Acquiring new postgres connection "master"
14:58:49.489772 [debug] [MainThread]: Using postgres connection "master"
14:58:49.489838 [debug] [MainThread]: On master: BEGIN
14:58:49.489898 [debug] [MainThread]: Opening a new connection, currently in state closed
14:58:49.492990 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:58:49.493087 [debug] [MainThread]: On master: COMMIT
14:58:49.493146 [debug] [MainThread]: Using postgres connection "master"
14:58:49.493203 [debug] [MainThread]: On master: COMMIT
14:58:49.493325 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:58:49.493393 [debug] [MainThread]: On master: Close
14:58:49.493542 [info ] [MainThread]: 
14:58:49.493656 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.23s.
14:58:49.493766 [debug] [MainThread]: Connection 'master' was properly closed.
14:58:49.493827 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:58:49.496176 [info ] [MainThread]: 
14:58:49.496316 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:58:49.496437 [info ] [MainThread]: 
14:58:49.496543 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:58:49.496654 [error] [MainThread]:   missing FROM-clause entry for table "account_payments"
14:58:49.496752 [error] [MainThread]:   LINE 26:     where account_payments.status = "successful"
14:58:49.496854 [error] [MainThread]:                      ^
14:58:49.496954 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:58:49.497065 [info ] [MainThread]: 
14:58:49.497168 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:58:49.497311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eeddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eedbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f017f0>]}


============================== 2022-05-27 14:59:00.241290 | 5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da ==============================
14:59:00.241308 [info ] [MainThread]: Running with dbt=1.1.0
14:59:00.241722 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:59:00.241833 [debug] [MainThread]: Tracking: tracking
14:59:00.257795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3c8e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3c8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3e6070>]}
14:59:00.275234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:59:00.275528 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:59:00.281911 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:59:00.289569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:59:00.291935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5b2fa0>]}
14:59:00.294249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3bc670>]}
14:59:00.294382 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:59:00.294516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a54af70>]}
14:59:00.295212 [info ] [MainThread]: 
14:59:00.295431 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:00.295914 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:59:00.300831 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:59:00.301017 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:59:00.301100 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:59:00.307828 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:59:00.308769 [debug] [ThreadPool]: On list_demo_destination: Close
14:59:00.309385 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:59:00.333073 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:00.333255 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:59:00.333322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:59:00.337406 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:59:00.337483 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:00.337542 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:59:00.342914 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
14:59:00.343570 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:59:00.343779 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:59:00.345827 [debug] [MainThread]: Using postgres connection "master"
14:59:00.345923 [debug] [MainThread]: On master: BEGIN
14:59:00.345988 [debug] [MainThread]: Opening a new connection, currently in state init
14:59:00.350400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:00.350490 [debug] [MainThread]: Using postgres connection "master"
14:59:00.350553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:59:00.382395 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:59:00.383187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3d6220>]}
14:59:00.383373 [debug] [MainThread]: On master: ROLLBACK
14:59:00.383607 [debug] [MainThread]: Using postgres connection "master"
14:59:00.383687 [debug] [MainThread]: On master: BEGIN
14:59:00.383992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:00.384076 [debug] [MainThread]: On master: COMMIT
14:59:00.384156 [debug] [MainThread]: Using postgres connection "master"
14:59:00.384222 [debug] [MainThread]: On master: COMMIT
14:59:00.384393 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:00.384474 [debug] [MainThread]: On master: Close
14:59:00.384640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:59:00.384789 [info ] [MainThread]: 
14:59:00.386423 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:59:00.386586 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:59:00.386832 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:59:00.386918 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:59:00.387000 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:59:00.387755 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:59:00.388111 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.388199 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:59:00.400268 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:59:00.400653 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:00.400738 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:59:00.400807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:00.403460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:00.403620 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:00.403698 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:59:00.404639 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:00.407714 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:00.407833 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:59:00.408183 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.409249 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:00.409328 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:59:00.409609 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.412959 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:00.413055 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:00.413126 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:00.413498 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:00.415770 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:00.415860 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:59:00.416764 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:00.417378 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.417481 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:59:00.417684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e5baf0>]}
14:59:00.417858 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:59:00.418064 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:59:00.418162 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:59:00.418267 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:59:00.418457 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:59:00.418530 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:59:00.418599 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:59:00.419222 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:59:00.419502 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.419573 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:59:00.420563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:59:00.420758 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:00.420839 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:59:00.420900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:00.424927 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:00.425018 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:00.425081 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:59:00.426852 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:00.427931 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:00.428009 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:59:00.428334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.429223 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:00.429293 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:59:00.429613 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.430943 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:00.431034 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:00.431099 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:00.431672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:00.432350 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:00.432426 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:59:00.433414 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:00.433981 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.434076 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:59:00.434258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7a1850>]}
14:59:00.434415 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:59:00.434594 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:59:00.434682 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:59:00.434811 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:59:00.434990 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:59:00.435058 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:59:00.435124 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:59:00.435742 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:59:00.435989 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.436061 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:59:00.437065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:59:00.437362 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:00.437436 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:59:00.437499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:00.441291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:00.441399 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:00.441465 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:59:00.443414 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:00.444566 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:00.444654 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:59:00.445039 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.445961 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:00.446031 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:59:00.446539 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.447109 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:00.447190 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:00.447294 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:00.447798 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:00.448607 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:00.448682 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:59:00.449564 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:00.450089 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.450197 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:59:00.450400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a39e3a0>]}
14:59:00.450595 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:00.450805 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:59:00.450897 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:59:00.451082 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:59:00.451280 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:59:00.451353 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:59:00.451422 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:59:00.452067 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:59:00.452337 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.452410 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:59:00.453416 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:59:00.453611 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:00.453683 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:59:00.453743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:00.462835 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:00.462983 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:00.463055 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:59:00.466084 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:00.467441 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:00.467535 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:59:00.467944 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.469251 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:00.469348 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:59:00.469651 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.470272 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:00.470345 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:00.470408 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:00.470890 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:00.471619 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:00.471717 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:59:00.472851 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:00.473428 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.473529 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:59:00.473724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e2d850>]}
14:59:00.473890 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:59:00.474089 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:59:00.474177 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:59:00.474326 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:59:00.474526 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:59:00.474599 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:59:00.474673 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:59:00.475224 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:59:00.475518 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.475595 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:59:00.476629 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:59:00.476832 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:00.476896 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:59:00.476957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:00.480603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:00.480674 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:00.480733 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:59:00.483617 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:00.484875 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:00.484960 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:59:00.485290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.487021 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:00.487095 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:59:00.487358 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:00.487903 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:00.487988 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:00.488049 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:00.489063 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:00.489864 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:00.489948 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:59:00.490836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:00.491322 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.491407 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:59:00.491589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a39e0a0>]}
14:59:00.491741 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:00.491922 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:59:00.492009 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:59:00.492104 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:59:00.492281 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:59:00.492350 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:59:00.492417 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:59:00.493810 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:59:00.494069 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.494144 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:59:00.504102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:59:00.504455 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:00.504528 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:59:00.504589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:00.510119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:00.510231 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:00.510297 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    where payments.status = "successful"

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:59:00.511045 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column payments.status does not exist
LINE 26:     where payments.status = "successful"
                   ^
HINT:  Perhaps you meant to reference the column "payments.state".

14:59:00.511144 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:59:00.511362 [debug] [Thread-1  ]: finished collecting timing info
14:59:00.511466 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:59:00.511630 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column payments.status does not exist
  LINE 26:     where payments.status = "successful"
                     ^
  HINT:  Perhaps you meant to reference the column "payments.state".
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:59:00.511761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc8c613-77eb-4fa9-97a3-51ac9f5fb5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7b5130>]}
14:59:00.511929 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:59:00.512131 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:59:00.512726 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:00.512840 [debug] [MainThread]: Using postgres connection "master"
14:59:00.512906 [debug] [MainThread]: On master: BEGIN
14:59:00.512967 [debug] [MainThread]: Opening a new connection, currently in state closed
14:59:00.516364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:00.516492 [debug] [MainThread]: On master: COMMIT
14:59:00.516556 [debug] [MainThread]: Using postgres connection "master"
14:59:00.516626 [debug] [MainThread]: On master: COMMIT
14:59:00.516765 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:00.516838 [debug] [MainThread]: On master: Close
14:59:00.517029 [info ] [MainThread]: 
14:59:00.517150 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.22s.
14:59:00.517263 [debug] [MainThread]: Connection 'master' was properly closed.
14:59:00.517324 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:59:00.519803 [info ] [MainThread]: 
14:59:00.519947 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:59:00.520124 [info ] [MainThread]: 
14:59:00.520270 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:59:00.520379 [error] [MainThread]:   column payments.status does not exist
14:59:00.520481 [error] [MainThread]:   LINE 26:     where payments.status = "successful"
14:59:00.520583 [error] [MainThread]:                      ^
14:59:00.520686 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "payments.state".
14:59:00.520785 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:59:00.520894 [info ] [MainThread]: 
14:59:00.521060 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:59:00.521211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a39e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a39e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3a4760>]}


============================== 2022-05-27 14:59:10.304466 | d8458f17-c891-4c86-951c-69ce01081346 ==============================
14:59:10.304501 [info ] [MainThread]: Running with dbt=1.1.0
14:59:10.304903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:59:10.305009 [debug] [MainThread]: Tracking: tracking
14:59:10.319003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735ae20>]}
14:59:10.335162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:59:10.335405 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:59:10.341325 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:59:10.348704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:59:10.351040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075460d0>]}
14:59:10.353648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e8e50>]}
14:59:10.353817 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:59:10.353965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e8ee0>]}
14:59:10.354652 [info ] [MainThread]: 
14:59:10.354884 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:10.355355 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:59:10.360190 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:59:10.360394 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:59:10.360477 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:59:10.367013 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
14:59:10.368005 [debug] [ThreadPool]: On list_demo_destination: Close
14:59:10.368671 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:59:10.392990 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:10.393174 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:59:10.393243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:59:10.397246 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:59:10.397352 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:10.397425 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:59:10.402004 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
14:59:10.402700 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:59:10.402945 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:59:10.405013 [debug] [MainThread]: Using postgres connection "master"
14:59:10.405111 [debug] [MainThread]: On master: BEGIN
14:59:10.405177 [debug] [MainThread]: Opening a new connection, currently in state init
14:59:10.409895 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:10.409982 [debug] [MainThread]: Using postgres connection "master"
14:59:10.410049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:59:10.446001 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:59:10.446855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107104640>]}
14:59:10.447044 [debug] [MainThread]: On master: ROLLBACK
14:59:10.447248 [debug] [MainThread]: Using postgres connection "master"
14:59:10.447332 [debug] [MainThread]: On master: BEGIN
14:59:10.447596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:10.447680 [debug] [MainThread]: On master: COMMIT
14:59:10.447754 [debug] [MainThread]: Using postgres connection "master"
14:59:10.447821 [debug] [MainThread]: On master: COMMIT
14:59:10.447977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:10.448069 [debug] [MainThread]: On master: Close
14:59:10.448256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:59:10.448400 [info ] [MainThread]: 
14:59:10.449988 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:59:10.450154 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:59:10.450390 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:59:10.450476 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:59:10.450563 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:59:10.451304 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:59:10.451603 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.451687 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:59:10.463872 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:59:10.464289 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:10.464376 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:59:10.464445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:10.467022 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:10.467129 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:10.467199 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:59:10.468064 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:10.471192 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:10.471285 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:59:10.471520 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.472514 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:10.472587 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:59:10.472792 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.475829 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:10.475946 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:10.476012 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:10.476619 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:10.478733 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:10.478814 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:59:10.479292 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:10.479797 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.479886 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:59:10.480070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bd0a0>]}
14:59:10.480245 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:59:10.480449 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:59:10.480541 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:59:10.480690 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:59:10.480910 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:59:10.480988 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:59:10.481059 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:59:10.481668 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:59:10.481923 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.481999 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:59:10.483059 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:59:10.483330 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:10.483400 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:59:10.483459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:10.486697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:10.486785 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:10.486846 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:59:10.488791 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:10.489915 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:10.489989 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:59:10.490320 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.491230 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:10.491300 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:59:10.491578 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.492880 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:10.492980 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:10.493053 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:10.493841 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:10.494606 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:10.494701 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:59:10.495581 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:10.496135 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.496228 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:59:10.496415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f8940>]}
14:59:10.496582 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:59:10.496774 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:59:10.496862 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:59:10.496970 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:59:10.497337 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:59:10.497449 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:59:10.497527 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:59:10.498204 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:59:10.498447 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.498521 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:59:10.499565 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:59:10.499783 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:10.499852 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:59:10.499911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:10.503319 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:10.503439 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:10.503506 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:59:10.505348 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:10.506554 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:10.506634 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:59:10.507600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.508715 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:10.508808 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:59:10.509133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.509661 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:10.509731 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:10.509793 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:10.510249 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:10.511160 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:10.511247 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:59:10.512165 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:10.512796 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.512894 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:59:10.513068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f8d30>]}
14:59:10.513223 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:10.513407 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:59:10.513500 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:59:10.513598 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:59:10.513925 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:59:10.514068 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:59:10.514149 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:59:10.514779 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:59:10.514963 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.515031 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:59:10.515977 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:59:10.516170 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:10.516236 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:59:10.516294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:10.519816 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:10.519930 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:10.519991 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:59:10.521911 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:10.523129 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:10.523205 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:59:10.524067 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.525093 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:10.525171 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:59:10.525574 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.526156 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:10.526251 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:10.526323 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:10.527085 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:10.527880 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:10.527953 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:59:10.528988 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:10.529634 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.529730 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:59:10.529935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e7790>]}
14:59:10.530110 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:59:10.530326 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:59:10.530418 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:59:10.530566 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:59:10.530779 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:59:10.530864 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:59:10.530934 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:59:10.531493 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:59:10.531753 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.531827 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:59:10.532854 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:59:10.533059 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:10.533122 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:59:10.533183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:10.536959 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:10.537049 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:10.537110 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:59:10.540759 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:10.541911 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:10.542007 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:59:10.542439 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.544314 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:10.544457 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:59:10.544871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:10.545431 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:10.545500 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:10.545560 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:10.546833 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:10.547594 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:10.547681 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:59:10.548985 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:10.549474 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.549559 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:59:10.549744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107654cd0>]}
14:59:10.549895 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:10.550081 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:59:10.550168 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:59:10.550270 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:59:10.550451 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:59:10.550523 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:59:10.550588 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:59:10.551969 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:59:10.552257 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.552331 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:59:10.562540 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:59:10.562916 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:10.562994 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:59:10.563063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:10.566972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:10.567093 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:10.567156 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    where payments.state = "successful"

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:59:10.567945 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "successful" does not exist
LINE 26:     where payments.state = "successful"
                                    ^

14:59:10.568026 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:59:10.568238 [debug] [Thread-1  ]: finished collecting timing info
14:59:10.568315 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:59:10.568465 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "successful" does not exist
  LINE 26:     where payments.state = "successful"
                                      ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:59:10.568591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8458f17-c891-4c86-951c-69ce01081346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107622490>]}
14:59:10.568756 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:59:10.568950 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:59:10.569491 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:10.569609 [debug] [MainThread]: Using postgres connection "master"
14:59:10.569678 [debug] [MainThread]: On master: BEGIN
14:59:10.569742 [debug] [MainThread]: Opening a new connection, currently in state closed
14:59:10.575085 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:59:10.575201 [debug] [MainThread]: On master: COMMIT
14:59:10.575267 [debug] [MainThread]: Using postgres connection "master"
14:59:10.575327 [debug] [MainThread]: On master: COMMIT
14:59:10.575453 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:10.575521 [debug] [MainThread]: On master: Close
14:59:10.575685 [info ] [MainThread]: 
14:59:10.575805 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.22s.
14:59:10.575915 [debug] [MainThread]: Connection 'master' was properly closed.
14:59:10.575974 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:59:10.578356 [info ] [MainThread]: 
14:59:10.578482 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:59:10.578603 [info ] [MainThread]: 
14:59:10.578711 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:59:10.578817 [error] [MainThread]:   column "successful" does not exist
14:59:10.578917 [error] [MainThread]:   LINE 26:     where payments.state = "successful"
14:59:10.579015 [error] [MainThread]:                                       ^
14:59:10.579111 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:59:10.579217 [info ] [MainThread]: 
14:59:10.579320 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:59:10.579462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107346190>]}


============================== 2022-05-27 14:59:25.806425 | 7638960a-2341-42c1-a5d1-8ab65ee0f512 ==============================
14:59:25.806447 [info ] [MainThread]: Running with dbt=1.1.0
14:59:25.806919 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:59:25.807023 [debug] [MainThread]: Tracking: tracking
14:59:25.820954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481ae50>]}
14:59:25.836937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:59:25.837215 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:59:25.843162 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:59:25.850313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:59:25.852596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1a0d0>]}
14:59:25.854870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a6850>]}
14:59:25.855005 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:59:25.855132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a6820>]}
14:59:25.855794 [info ] [MainThread]: 
14:59:25.856005 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:25.856458 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:59:25.860949 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:59:25.861036 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:59:25.861168 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:59:25.888708 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
14:59:25.889742 [debug] [ThreadPool]: On list_demo_destination: Close
14:59:25.890483 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:59:25.913487 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:25.913679 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:59:25.913749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:59:25.917896 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:59:25.917993 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:25.918059 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:59:25.921709 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
14:59:25.922338 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:59:25.922579 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:59:25.924595 [debug] [MainThread]: Using postgres connection "master"
14:59:25.924681 [debug] [MainThread]: On master: BEGIN
14:59:25.924751 [debug] [MainThread]: Opening a new connection, currently in state init
14:59:25.931258 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:59:25.931336 [debug] [MainThread]: Using postgres connection "master"
14:59:25.931398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:59:25.967539 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
14:59:25.968192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c28e0>]}
14:59:25.968363 [debug] [MainThread]: On master: ROLLBACK
14:59:25.968582 [debug] [MainThread]: Using postgres connection "master"
14:59:25.968670 [debug] [MainThread]: On master: BEGIN
14:59:25.968987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:25.969077 [debug] [MainThread]: On master: COMMIT
14:59:25.969151 [debug] [MainThread]: Using postgres connection "master"
14:59:25.969224 [debug] [MainThread]: On master: COMMIT
14:59:25.969409 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:25.969497 [debug] [MainThread]: On master: Close
14:59:25.969665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:59:25.969821 [info ] [MainThread]: 
14:59:25.971417 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:59:25.971582 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:59:25.971833 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:59:25.971922 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:59:25.972006 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:59:25.972731 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:59:25.973051 [debug] [Thread-1  ]: finished collecting timing info
14:59:25.973137 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:59:25.985228 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:59:25.985597 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:25.985673 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:59:25.985739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:25.988398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:25.988513 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:25.988585 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:59:25.989467 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:25.992685 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:25.992787 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:59:25.993057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:25.994101 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:25.994182 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:59:25.994370 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:25.997531 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:25.997636 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:25.997704 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:25.998061 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:26.000210 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:26.000308 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:59:26.000872 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:26.001379 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.001471 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:59:26.001664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ad9550>]}
14:59:26.001832 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
14:59:26.002036 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:59:26.002125 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:59:26.002271 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:59:26.002476 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:59:26.002550 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:59:26.002619 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:59:26.003235 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:59:26.003476 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.003550 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:59:26.004563 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:59:26.004749 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:26.004816 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:59:26.004880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:26.007139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:26.007221 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:26.007284 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:59:26.008043 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:26.009157 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:26.009240 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:59:26.009736 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.010640 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:26.010714 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:59:26.011035 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.012282 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:26.012352 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:26.012414 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:26.013668 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:26.014310 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:26.014380 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:59:26.016075 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:26.016663 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.016754 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:59:26.016934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b8c10>]}
14:59:26.017088 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
14:59:26.017266 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:59:26.017354 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:59:26.017482 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:59:26.017660 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:59:26.017726 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:59:26.017792 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:59:26.018405 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:59:26.018664 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.018736 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:59:26.019723 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:59:26.020013 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:26.020085 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:59:26.020146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:26.024333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:26.024437 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:26.024502 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:59:26.026385 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:26.027589 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:26.027671 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:59:26.027990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.028924 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:26.029010 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:59:26.031781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.032424 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:26.032546 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:26.032614 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:26.033345 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:26.034065 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:26.034136 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:59:26.035621 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:26.036144 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.036254 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:59:26.036463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039e31f0>]}
14:59:26.036632 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:26.036832 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:59:26.036920 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:59:26.037084 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:59:26.037367 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:59:26.037450 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:59:26.037522 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:59:26.038166 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:59:26.038455 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.038538 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:59:26.039570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:59:26.039805 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:26.039876 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:59:26.039936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:26.052808 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:26.052963 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:26.053037 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:59:26.055283 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:26.056628 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:26.056716 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:59:26.057118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.058145 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:26.058222 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:59:26.058603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.059159 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:26.059230 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:26.059292 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:26.059790 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:26.060441 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:26.060509 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:59:26.061801 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:26.062343 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.062442 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:59:26.062642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f80eb0>]}
14:59:26.062811 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.03s]
14:59:26.063012 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:59:26.063101 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:59:26.063248 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:59:26.063442 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:59:26.063514 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:59:26.063583 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:59:26.064125 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:59:26.064393 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.064464 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:59:26.065483 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:59:26.065658 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:26.065720 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:59:26.065777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:26.073812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:26.073901 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:26.073962 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:59:26.076014 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:26.077386 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:26.077482 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:59:26.077897 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.080070 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:26.080188 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:59:26.080494 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:26.081164 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:26.081246 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:26.081312 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:26.081597 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:26.082502 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:26.082658 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:59:26.083319 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:26.083919 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.084029 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:59:26.084230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c27d00>]}
14:59:26.084396 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:26.084590 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:59:26.084678 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:59:26.084810 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:59:26.084989 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:59:26.085060 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:59:26.085130 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:59:26.086644 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:59:26.087023 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.087136 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:59:26.097768 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:59:26.098140 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:26.098219 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:59:26.098281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:26.102320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:26.102451 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:26.102515 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    where payments.state == "successful"

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:59:26.103258 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "successful" does not exist
LINE 26:     where payments.state == "successful"
                                     ^

14:59:26.103380 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
14:59:26.103603 [debug] [Thread-1  ]: finished collecting timing info
14:59:26.103747 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:59:26.103939 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "successful" does not exist
  LINE 26:     where payments.state == "successful"
                                       ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
14:59:26.104089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7638960a-2341-42c1-a5d1-8ab65ee0f512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbce80>]}
14:59:26.104268 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
14:59:26.104476 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:59:26.104990 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:26.105085 [debug] [MainThread]: Using postgres connection "master"
14:59:26.105148 [debug] [MainThread]: On master: BEGIN
14:59:26.105209 [debug] [MainThread]: Opening a new connection, currently in state closed
14:59:26.109258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:26.109383 [debug] [MainThread]: On master: COMMIT
14:59:26.109448 [debug] [MainThread]: Using postgres connection "master"
14:59:26.109510 [debug] [MainThread]: On master: COMMIT
14:59:26.109635 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:26.109703 [debug] [MainThread]: On master: Close
14:59:26.109868 [info ] [MainThread]: 
14:59:26.109988 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
14:59:26.110097 [debug] [MainThread]: Connection 'master' was properly closed.
14:59:26.110156 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:59:26.112505 [info ] [MainThread]: 
14:59:26.112648 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:59:26.112812 [info ] [MainThread]: 
14:59:26.112946 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
14:59:26.113054 [error] [MainThread]:   column "successful" does not exist
14:59:26.113154 [error] [MainThread]:   LINE 26:     where payments.state == "successful"
14:59:26.113256 [error] [MainThread]:                                        ^
14:59:26.113369 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
14:59:26.113476 [info ] [MainThread]: 
14:59:26.113578 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
14:59:26.113729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ef0d0>]}


============================== 2022-05-27 14:59:55.228930 | 52234277-84ae-465c-a257-7b429a1bfd00 ==============================
14:59:55.228949 [info ] [MainThread]: Running with dbt=1.1.0
14:59:55.229356 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:59:55.229452 [debug] [MainThread]: Tracking: tracking
14:59:55.244785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a88ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a88dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a88df0>]}
14:59:55.260841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:59:55.261088 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
14:59:55.267188 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
14:59:55.275299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

14:59:55.277917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdb0d0>]}
14:59:55.280496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7be50>]}
14:59:55.280680 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:59:55.280824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7bee0>]}
14:59:55.281566 [info ] [MainThread]: 
14:59:55.281802 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:55.282299 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
14:59:55.287216 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
14:59:55.287425 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
14:59:55.287518 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:59:55.327166 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
14:59:55.328076 [debug] [ThreadPool]: On list_demo_destination: Close
14:59:55.328747 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
14:59:55.353994 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:55.354175 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
14:59:55.354248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:59:55.358537 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:59:55.358685 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
14:59:55.358761 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:59:55.364033 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
14:59:55.364821 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
14:59:55.365097 [debug] [ThreadPool]: On list_demo_destination_public: Close
14:59:55.367400 [debug] [MainThread]: Using postgres connection "master"
14:59:55.367520 [debug] [MainThread]: On master: BEGIN
14:59:55.367603 [debug] [MainThread]: Opening a new connection, currently in state init
14:59:55.374172 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:59:55.374349 [debug] [MainThread]: Using postgres connection "master"
14:59:55.374429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:59:55.408467 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
14:59:55.409256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628580>]}
14:59:55.409423 [debug] [MainThread]: On master: ROLLBACK
14:59:55.409612 [debug] [MainThread]: Using postgres connection "master"
14:59:55.409686 [debug] [MainThread]: On master: BEGIN
14:59:55.409959 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:59:55.410029 [debug] [MainThread]: On master: COMMIT
14:59:55.410091 [debug] [MainThread]: Using postgres connection "master"
14:59:55.410176 [debug] [MainThread]: On master: COMMIT
14:59:55.410348 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:55.410421 [debug] [MainThread]: On master: Close
14:59:55.410601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:59:55.410729 [info ] [MainThread]: 
14:59:55.412170 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
14:59:55.412311 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
14:59:55.412511 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
14:59:55.412587 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
14:59:55.412662 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
14:59:55.413359 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
14:59:55.413674 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.413761 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
14:59:55.425205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
14:59:55.425606 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:55.425686 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
14:59:55.425754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:55.433139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:55.433308 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:55.433382 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
14:59:55.434631 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:55.437884 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:55.438015 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
14:59:55.438599 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.439786 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:55.439892 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
14:59:55.440996 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.444331 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:55.444447 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:55.444519 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
14:59:55.445456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:55.448039 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
14:59:55.448214 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
14:59:55.450178 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:55.450892 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.451011 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
14:59:55.451240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f58b0>]}
14:59:55.451432 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.04s]
14:59:55.451644 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
14:59:55.451746 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
14:59:55.451849 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
14:59:55.452109 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
14:59:55.452194 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
14:59:55.452272 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
14:59:55.453009 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
14:59:55.453328 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.453416 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
14:59:55.454723 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
14:59:55.455048 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:55.455132 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
14:59:55.455206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:55.459278 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:55.459426 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:55.459498 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
14:59:55.461161 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:55.462490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:55.462603 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
14:59:55.463665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.464994 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:55.465132 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
14:59:55.466244 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.467964 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:55.468085 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:55.468166 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
14:59:55.468806 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:55.469750 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
14:59:55.469863 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
14:59:55.470937 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:55.471630 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.471740 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
14:59:55.471955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661c730>]}
14:59:55.472132 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
14:59:55.472333 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
14:59:55.472471 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
14:59:55.472697 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
14:59:55.473026 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
14:59:55.473115 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
14:59:55.473196 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
14:59:55.473990 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
14:59:55.474301 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.474427 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
14:59:55.475573 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
14:59:55.475828 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:55.475915 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
14:59:55.475984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:55.480265 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:55.480414 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:55.480496 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
14:59:55.482862 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:55.484269 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:55.484371 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
14:59:55.484817 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.485875 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:55.485969 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
14:59:55.486366 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.487032 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:55.487120 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:55.487186 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
14:59:55.487706 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:55.488547 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
14:59:55.488656 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
14:59:55.492000 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:55.492654 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.492821 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
14:59:55.493126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661c820>]}
14:59:55.493325 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:55.493529 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
14:59:55.493624 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
14:59:55.493828 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
14:59:55.494037 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
14:59:55.494127 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
14:59:55.494217 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
14:59:55.494915 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
14:59:55.495185 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.495283 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
14:59:55.496280 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
14:59:55.496462 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:55.496534 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
14:59:55.496618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:55.502389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:55.502552 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:55.502622 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
14:59:55.506632 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:55.508075 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:55.508170 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
14:59:55.508763 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.509791 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:55.509868 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
14:59:55.510335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.510929 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:55.511004 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:55.511070 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
14:59:55.511713 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:55.512384 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
14:59:55.512460 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
14:59:55.514548 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:55.515255 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.515386 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
14:59:55.515640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7a790>]}
14:59:55.515817 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
14:59:55.516011 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
14:59:55.516104 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
14:59:55.516364 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
14:59:55.516604 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
14:59:55.516686 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
14:59:55.516760 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
14:59:55.517361 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
14:59:55.517608 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.517683 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
14:59:55.518679 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
14:59:55.518864 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:55.518928 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
14:59:55.518987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:55.523158 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:59:55.523316 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:55.523390 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
14:59:55.525792 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:59:55.527136 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:55.527245 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
14:59:55.527626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.529363 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:55.529444 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
14:59:55.530783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.531360 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:55.531437 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:55.531501 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
14:59:55.533395 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:55.534325 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
14:59:55.534405 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
14:59:55.536138 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:59:55.536655 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.536753 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
14:59:55.536958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8ca0>]}
14:59:55.537129 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
14:59:55.537322 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
14:59:55.537413 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
14:59:55.537520 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
14:59:55.537697 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
14:59:55.537814 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
14:59:55.537896 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
14:59:55.539343 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
14:59:55.539666 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.539767 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
14:59:55.549942 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
14:59:55.550287 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:55.550366 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
14:59:55.550432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:59:55.555845 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:59:55.555972 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:55.556042 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    sum( amount ) as total_payment
    
    from payments

    where payments.state='successful'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
14:59:55.564338 [debug] [Thread-1  ]: SQL status: SELECT 50 in 0.01 seconds
14:59:55.565769 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:55.565907 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers" rename to "customers__dbt_backup"
14:59:55.566643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.567735 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:55.567837 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers__dbt_tmp" rename to "customers"
14:59:55.568378 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:59:55.571175 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
14:59:55.571290 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:55.571359 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
14:59:55.572099 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:59:55.572883 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
14:59:55.572959 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
drop table if exists "demo_destination"."public"."customers__dbt_backup" cascade
14:59:55.575442 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
14:59:55.575934 [debug] [Thread-1  ]: finished collecting timing info
14:59:55.576027 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
14:59:55.576213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52234277-84ae-465c-a257-7b429a1bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697e250>]}
14:59:55.576378 [info ] [Thread-1  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 50[0m in 0.04s]
14:59:55.576561 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
14:59:55.577091 [debug] [MainThread]: Acquiring new postgres connection "master"
14:59:55.577185 [debug] [MainThread]: Using postgres connection "master"
14:59:55.577250 [debug] [MainThread]: On master: BEGIN
14:59:55.577311 [debug] [MainThread]: Opening a new connection, currently in state closed
14:59:55.583805 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:59:55.584005 [debug] [MainThread]: On master: COMMIT
14:59:55.584076 [debug] [MainThread]: Using postgres connection "master"
14:59:55.584148 [debug] [MainThread]: On master: COMMIT
14:59:55.584356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:59:55.584445 [debug] [MainThread]: On master: Close
14:59:55.584655 [info ] [MainThread]: 
14:59:55.584778 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.30s.
14:59:55.584891 [debug] [MainThread]: Connection 'master' was properly closed.
14:59:55.584954 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
14:59:55.587412 [info ] [MainThread]: 
14:59:55.587584 [info ] [MainThread]: [32mCompleted successfully[0m
14:59:55.587723 [info ] [MainThread]: 
14:59:55.587830 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
14:59:55.587998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106645520>]}


============================== 2022-05-27 15:02:55.522611 | 60718d09-ad66-4f61-841f-a223758209b3 ==============================
15:02:55.522631 [info ] [MainThread]: Running with dbt=1.1.0
15:02:55.523091 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:02:55.523206 [debug] [MainThread]: Tracking: tracking
15:02:55.539946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571aca0>]}
15:02:55.556263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:02:55.556490 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:02:55.562418 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:02:55.570249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:02:55.572738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059070d0>]}
15:02:55.575241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a7e50>]}
15:02:55.575391 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:02:55.575527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fb7c0>]}
15:02:55.576231 [info ] [MainThread]: 
15:02:55.576464 [debug] [MainThread]: Acquiring new postgres connection "master"
15:02:55.576993 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:02:55.581743 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:02:55.581884 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:02:55.581959 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:02:55.609450 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:02:55.610427 [debug] [ThreadPool]: On list_demo_destination: Close
15:02:55.611040 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:02:55.634280 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:02:55.634462 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:02:55.634532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:02:55.641845 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:02:55.641921 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:02:55.641984 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:02:55.648615 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:02:55.649290 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:02:55.649567 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:02:55.651618 [debug] [MainThread]: Using postgres connection "master"
15:02:55.651724 [debug] [MainThread]: On master: BEGIN
15:02:55.651791 [debug] [MainThread]: Opening a new connection, currently in state init
15:02:55.655362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:02:55.655482 [debug] [MainThread]: Using postgres connection "master"
15:02:55.655551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:02:55.690714 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
15:02:55.691544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104765b50>]}
15:02:55.691742 [debug] [MainThread]: On master: ROLLBACK
15:02:55.691994 [debug] [MainThread]: Using postgres connection "master"
15:02:55.692094 [debug] [MainThread]: On master: BEGIN
15:02:55.692401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:02:55.692510 [debug] [MainThread]: On master: COMMIT
15:02:55.692595 [debug] [MainThread]: Using postgres connection "master"
15:02:55.692671 [debug] [MainThread]: On master: COMMIT
15:02:55.692828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:02:55.692920 [debug] [MainThread]: On master: Close
15:02:55.693102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:02:55.693246 [info ] [MainThread]: 
15:02:55.694949 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:02:55.695156 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:02:55.695426 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:02:55.695519 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:02:55.695602 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:02:55.696343 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:02:55.696679 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.696766 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:02:55.708913 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:02:55.709271 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:02:55.709362 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:02:55.709434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:55.712140 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:02:55.712297 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:02:55.712373 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:02:55.713281 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:02:55.716427 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:02:55.716520 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:02:55.716814 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.717816 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:02:55.717908 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:02:55.718181 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.721421 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:02:55.721539 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:02:55.721609 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:02:55.722228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:55.724725 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:02:55.724870 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:02:55.726535 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:02:55.727178 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.727284 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:02:55.727494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e12910>]}
15:02:55.727681 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:02:55.727895 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:02:55.728004 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:02:55.728243 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:02:55.728508 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:02:55.728598 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:02:55.728681 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:02:55.729334 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:02:55.729600 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.729675 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:02:55.730694 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:02:55.730879 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:02:55.730944 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:02:55.731002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:55.734890 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:02:55.735009 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:02:55.735076 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:02:55.737017 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:02:55.738287 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:02:55.738389 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:02:55.738746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.739845 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:02:55.740008 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:02:55.740336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.741776 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:02:55.741855 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:02:55.741922 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:02:55.742331 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:55.742980 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:02:55.743050 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:02:55.744121 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:02:55.744711 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.744807 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:02:55.745012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c5580>]}
15:02:55.745174 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:02:55.745368 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:02:55.745462 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:02:55.745612 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:02:55.745796 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:02:55.745867 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:02:55.745933 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:02:55.746564 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:02:55.746854 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.746932 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:02:55.747942 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:02:55.748183 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:02:55.748253 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:02:55.748341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:55.753408 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:02:55.753504 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:02:55.753568 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:02:55.755734 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:02:55.757068 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:02:55.757159 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:02:55.757723 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.758735 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:02:55.758848 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:02:55.759238 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.760010 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:02:55.760106 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:02:55.760176 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:02:55.760757 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:55.761547 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:02:55.761624 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:02:55.762824 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:02:55.763338 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.763427 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:02:55.763616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c5670>]}
15:02:55.763778 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:02:55.763978 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:02:55.764075 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:02:55.764272 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:02:55.764492 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:02:55.764568 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:02:55.764639 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:02:55.765321 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:02:55.765644 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.765736 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:02:55.766883 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:02:55.767119 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:02:55.767187 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:02:55.767250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:55.770982 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:02:55.771084 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:02:55.771145 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:02:55.773259 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:02:55.774623 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:02:55.774708 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:02:55.775127 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.776239 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:02:55.776331 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:02:55.776710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.777398 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:02:55.777475 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:02:55.777541 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:02:55.778407 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:55.779201 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:02:55.779288 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:02:55.780842 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:02:55.781410 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.781504 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:02:55.781703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e12cd0>]}
15:02:55.781890 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:02:55.782085 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:02:55.782178 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:02:55.782276 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:02:55.782462 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:02:55.782534 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:02:55.782610 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:02:55.783194 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:02:55.783467 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.783538 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:02:55.784567 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:02:55.784767 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:02:55.784832 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:02:55.784890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:55.788560 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:02:55.788696 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:02:55.788767 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:02:55.792121 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:02:55.793398 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:02:55.793503 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:02:55.794074 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.795808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:02:55.795895 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:02:55.796432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:02:55.796932 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:02:55.797000 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:02:55.797060 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:02:55.797900 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:02:55.798609 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:02:55.798685 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:02:55.800922 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:02:55.801385 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.801473 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:02:55.801649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b08c40>]}
15:02:55.801806 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:02:55.801985 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:02:55.802073 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:02:55.802169 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:02:55.802344 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:02:55.802418 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:02:55.802529 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:02:55.803993 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:02:55.804286 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.804370 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:02:55.814668 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:02:55.815106 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:02:55.815206 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:02:55.815272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:02:55.819934 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:02:55.820031 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:02:55.820095 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    round(sum( amount ), 2) as total_payment
    
    from payments

    where payments.state='successful'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
15:02:55.821311 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 22:     round(sum( amount ), 2) as total_payment
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

15:02:55.821405 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:02:55.821613 [debug] [Thread-1  ]: finished collecting timing info
15:02:55.821695 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:02:55.821860 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  function round(double precision, integer) does not exist
  LINE 22:     round(sum( amount ), 2) as total_payment
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:02:55.821996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60718d09-ad66-4f61-841f-a223758209b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059be5e0>]}
15:02:55.822166 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:02:55.822371 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:02:55.822853 [debug] [MainThread]: Acquiring new postgres connection "master"
15:02:55.822965 [debug] [MainThread]: Using postgres connection "master"
15:02:55.823036 [debug] [MainThread]: On master: BEGIN
15:02:55.823103 [debug] [MainThread]: Opening a new connection, currently in state closed
15:02:55.826574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:02:55.826743 [debug] [MainThread]: On master: COMMIT
15:02:55.826814 [debug] [MainThread]: Using postgres connection "master"
15:02:55.826879 [debug] [MainThread]: On master: COMMIT
15:02:55.827065 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:02:55.827144 [debug] [MainThread]: On master: Close
15:02:55.827342 [info ] [MainThread]: 
15:02:55.827475 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
15:02:55.827588 [debug] [MainThread]: Connection 'master' was properly closed.
15:02:55.827649 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:02:55.830053 [info ] [MainThread]: 
15:02:55.830212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:02:55.830482 [info ] [MainThread]: 
15:02:55.830676 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:02:55.830820 [error] [MainThread]:   function round(double precision, integer) does not exist
15:02:55.830929 [error] [MainThread]:   LINE 22:     round(sum( amount ), 2) as total_payment
15:02:55.831036 [error] [MainThread]:                ^
15:02:55.831140 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
15:02:55.831244 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:02:55.831356 [info ] [MainThread]: 
15:02:55.831467 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:02:55.831627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ee1c0>]}


============================== 2022-05-27 15:05:20.856370 | 7d1a60b8-b54d-48e1-abcc-5c567f715bae ==============================
15:05:20.856385 [info ] [MainThread]: Running with dbt=1.1.0
15:05:20.856889 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:05:20.856988 [debug] [MainThread]: Tracking: tracking
15:05:20.876886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106919df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106919f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106919f70>]}
15:05:20.895866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:05:20.896102 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:05:20.902375 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:05:20.909697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:05:20.912026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b00f70>]}
15:05:20.914365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9efa0>]}
15:05:20.914516 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:05:20.914650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9af40>]}
15:05:20.915388 [info ] [MainThread]: 
15:05:20.915627 [debug] [MainThread]: Acquiring new postgres connection "master"
15:05:20.916128 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:05:20.921116 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:05:20.921299 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:05:20.921385 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:05:20.949623 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:05:20.950641 [debug] [ThreadPool]: On list_demo_destination: Close
15:05:20.951361 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:05:20.974424 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:05:20.974594 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:05:20.974660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:05:20.979797 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:05:20.979881 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:05:20.979941 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:05:20.985562 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:05:20.986167 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:05:20.986361 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:05:20.988361 [debug] [MainThread]: Using postgres connection "master"
15:05:20.988456 [debug] [MainThread]: On master: BEGIN
15:05:20.988524 [debug] [MainThread]: Opening a new connection, currently in state init
15:05:20.995252 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:05:20.995329 [debug] [MainThread]: Using postgres connection "master"
15:05:20.995393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:05:21.037636 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
15:05:21.038478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069261c0>]}
15:05:21.038664 [debug] [MainThread]: On master: ROLLBACK
15:05:21.038969 [debug] [MainThread]: Using postgres connection "master"
15:05:21.039079 [debug] [MainThread]: On master: BEGIN
15:05:21.039455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:05:21.039576 [debug] [MainThread]: On master: COMMIT
15:05:21.039672 [debug] [MainThread]: Using postgres connection "master"
15:05:21.039755 [debug] [MainThread]: On master: COMMIT
15:05:21.039922 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:05:21.040022 [debug] [MainThread]: On master: Close
15:05:21.040216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:05:21.040376 [info ] [MainThread]: 
15:05:21.043021 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:05:21.043286 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:05:21.043579 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:05:21.043674 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:05:21.043762 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:05:21.044573 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:05:21.044843 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.044930 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:05:21.057117 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:05:21.057414 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:05:21.057493 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:05:21.057560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:21.060360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:05:21.060528 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:05:21.060611 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:05:21.061480 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:05:21.064846 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:05:21.064954 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:05:21.065203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.066375 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:05:21.066463 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:05:21.066772 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.070008 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:05:21.070134 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:05:21.070205 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:05:21.070771 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:05:21.073015 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:05:21.073099 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:05:21.073639 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:05:21.074173 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.074263 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:05:21.074476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572edc0>]}
15:05:21.074698 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:05:21.074952 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:05:21.075059 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:05:21.075235 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:05:21.075458 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:05:21.075540 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:05:21.075617 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:05:21.076291 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:05:21.076580 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.076663 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:05:21.077758 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:05:21.078003 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:05:21.078077 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:05:21.078142 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:21.080557 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:05:21.080650 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:05:21.080722 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:05:21.081958 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:05:21.083290 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:05:21.083418 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:05:21.083751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.084753 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:05:21.084828 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:05:21.085065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.086461 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:05:21.086565 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:05:21.086632 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:05:21.087351 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:05:21.088078 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:05:21.088174 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:05:21.089255 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:05:21.089740 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.089822 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:05:21.090003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed580>]}
15:05:21.090160 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
15:05:21.090347 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:05:21.090435 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:05:21.090572 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:05:21.090778 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:05:21.090853 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:05:21.090923 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:05:21.091623 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:05:21.091952 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.092037 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:05:21.093184 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:05:21.093416 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:05:21.093487 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:05:21.093550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:21.097240 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:05:21.097326 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:05:21.097389 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:05:21.099752 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:05:21.101015 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:05:21.101096 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:05:21.101458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.102490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:05:21.102585 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:05:21.102888 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.103444 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:05:21.103533 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:05:21.103596 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:05:21.104022 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:05:21.104743 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:05:21.104819 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:05:21.105812 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:05:21.106322 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.106405 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:05:21.106588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed490>]}
15:05:21.106750 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:05:21.106934 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:05:21.107028 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:05:21.107125 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:05:21.107313 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:05:21.107390 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:05:21.107459 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:05:21.108146 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:05:21.108546 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.108636 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:05:21.109711 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:05:21.109911 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:05:21.109977 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:05:21.110039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:21.113561 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:05:21.113671 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:05:21.113732 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:05:21.115951 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:05:21.117265 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:05:21.117349 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:05:21.117690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.118659 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:05:21.118736 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:05:21.119149 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.119759 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:05:21.119838 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:05:21.119907 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:05:21.120430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:05:21.121172 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:05:21.121245 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:05:21.122353 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:05:21.122923 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.123009 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:05:21.123191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed580>]}
15:05:21.123353 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:05:21.123539 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:05:21.123632 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:05:21.123738 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:05:21.123976 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:05:21.124046 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:05:21.124114 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:05:21.124703 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:05:21.124986 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.125064 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:05:21.126110 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:05:21.126334 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:05:21.126398 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:05:21.126457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:21.130999 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:05:21.131080 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:05:21.131137 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:05:21.133890 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:05:21.134966 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:05:21.135039 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:05:21.135498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.137146 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:05:21.137239 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:05:21.137589 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:05:21.138099 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:05:21.138166 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:05:21.138226 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:05:21.138960 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:05:21.139633 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:05:21.139698 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:05:21.141007 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:05:21.141451 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.141530 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:05:21.141691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed0d0>]}
15:05:21.141838 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:05:21.142008 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:05:21.142093 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:05:21.142185 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:05:21.142361 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:05:21.142462 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:05:21.142541 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:05:21.143914 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:05:21.144173 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.144254 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:05:21.154338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:05:21.154676 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:05:21.154750 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:05:21.154814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:21.160326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:05:21.160408 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:05:21.160468 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount ),2) as total_payment
    
    from payments

    where payments.state='successful'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
15:05:21.162889 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 22:     ROUND(sum( amount ),2) as total_payment
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

15:05:21.162968 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:05:21.163221 [debug] [Thread-1  ]: finished collecting timing info
15:05:21.163289 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:05:21.163423 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  function round(double precision, integer) does not exist
  LINE 22:     ROUND(sum( amount ),2) as total_payment
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:05:21.163538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1a60b8-b54d-48e1-abcc-5c567f715bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be38e0>]}
15:05:21.163680 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:05:21.163863 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:05:21.164323 [debug] [MainThread]: Acquiring new postgres connection "master"
15:05:21.164421 [debug] [MainThread]: Using postgres connection "master"
15:05:21.164489 [debug] [MainThread]: On master: BEGIN
15:05:21.164550 [debug] [MainThread]: Opening a new connection, currently in state closed
15:05:21.170690 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:05:21.170782 [debug] [MainThread]: On master: COMMIT
15:05:21.170845 [debug] [MainThread]: Using postgres connection "master"
15:05:21.170906 [debug] [MainThread]: On master: COMMIT
15:05:21.171089 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:05:21.171157 [debug] [MainThread]: On master: Close
15:05:21.171308 [info ] [MainThread]: 
15:05:21.171427 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.26s.
15:05:21.171535 [debug] [MainThread]: Connection 'master' was properly closed.
15:05:21.171594 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:05:21.173858 [info ] [MainThread]: 
15:05:21.173997 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:05:21.174115 [info ] [MainThread]: 
15:05:21.174220 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:05:21.174323 [error] [MainThread]:   function round(double precision, integer) does not exist
15:05:21.174422 [error] [MainThread]:   LINE 22:     ROUND(sum( amount ),2) as total_payment
15:05:21.174520 [error] [MainThread]:                ^
15:05:21.174620 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
15:05:21.174717 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:05:21.174822 [info ] [MainThread]: 
15:05:21.174923 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:05:21.175062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069017f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106901190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a1d30>]}


============================== 2022-05-27 15:06:05.927718 | 407b9285-cf7b-429b-8729-ccac4e90a3c2 ==============================
15:06:05.927737 [info ] [MainThread]: Running with dbt=1.1.0
15:06:05.928174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:06:05.928274 [debug] [MainThread]: Tracking: tracking
15:06:05.942778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d8d00>]}
15:06:05.958271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:06:05.958492 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:06:05.964454 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:06:05.971504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:06:05.973758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c60d0>]}
15:06:05.976527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104867e50>]}
15:06:05.976719 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:06:05.976879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104867eb0>]}
15:06:05.977628 [info ] [MainThread]: 
15:06:05.977875 [debug] [MainThread]: Acquiring new postgres connection "master"
15:06:05.978385 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:06:05.983220 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:06:05.983364 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:06:05.983444 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:06:06.015175 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:06:06.016116 [debug] [ThreadPool]: On list_demo_destination: Close
15:06:06.016777 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:06:06.040358 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:06:06.040554 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:06:06.040625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:06:06.057181 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
15:06:06.057299 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:06:06.057372 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:06:06.061051 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
15:06:06.061760 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:06:06.062046 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:06:06.064504 [debug] [MainThread]: Using postgres connection "master"
15:06:06.064663 [debug] [MainThread]: On master: BEGIN
15:06:06.064740 [debug] [MainThread]: Opening a new connection, currently in state init
15:06:06.068093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:06:06.068225 [debug] [MainThread]: Using postgres connection "master"
15:06:06.068302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:06:06.104874 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
15:06:06.105729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104682a60>]}
15:06:06.105921 [debug] [MainThread]: On master: ROLLBACK
15:06:06.106169 [debug] [MainThread]: Using postgres connection "master"
15:06:06.106259 [debug] [MainThread]: On master: BEGIN
15:06:06.106570 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:06:06.106657 [debug] [MainThread]: On master: COMMIT
15:06:06.106738 [debug] [MainThread]: Using postgres connection "master"
15:06:06.106811 [debug] [MainThread]: On master: COMMIT
15:06:06.107006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:06:06.107096 [debug] [MainThread]: On master: Close
15:06:06.107283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:06:06.107440 [info ] [MainThread]: 
15:06:06.109192 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:06:06.109361 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:06:06.109610 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:06:06.109694 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:06:06.109773 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:06:06.110503 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:06:06.110841 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.110927 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:06:06.123219 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:06:06.123583 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:06.123662 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:06:06.123732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:06.126849 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:06.126964 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:06.127032 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:06:06.127909 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:06.130970 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:06.131062 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:06:06.131288 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.132316 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:06.132391 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:06:06.132583 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.135719 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:06:06.135854 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:06.135921 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:06:06.136364 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:06.138504 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:06.138592 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:06:06.139160 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:06.139734 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.139836 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:06:06.140035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008fd6d0>]}
15:06:06.140210 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:06:06.140432 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:06:06.140547 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:06:06.140700 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:06:06.140960 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:06:06.141093 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:06:06.141172 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:06:06.141844 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:06:06.142098 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.142175 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:06:06.143227 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:06:06.143432 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:06.143500 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:06:06.143562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:06.147455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:06.147573 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:06.147641 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:06:06.149500 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:06.150751 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:06.150835 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:06:06.151151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.152079 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:06.152159 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:06:06.152431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.153880 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:06:06.153985 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:06.154049 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:06:06.154856 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:06.155685 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:06.155770 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:06:06.156814 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:06.157415 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.157556 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:06:06.157783 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046af100>]}
15:06:06.157948 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:06:06.158148 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:06:06.158236 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:06:06.158338 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:06:06.158586 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:06:06.158677 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:06:06.158749 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:06:06.159444 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:06:06.159736 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.159816 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:06:06.160868 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:06:06.161089 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:06.161157 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:06:06.161224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:06.165196 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:06.165318 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:06.165380 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:06:06.167619 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:06.168869 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:06.168958 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:06:06.169381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.170493 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:06.170602 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:06:06.170919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.171516 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:06:06.171603 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:06.171672 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:06:06.172068 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:06.172848 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:06.172951 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:06:06.174581 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:06.175269 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.175379 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:06:06.175590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046af250>]}
15:06:06.175760 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:06:06.175960 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:06:06.176050 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:06:06.176236 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:06:06.176426 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:06:06.176498 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:06:06.176569 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:06:06.177249 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:06:06.177548 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.177622 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:06:06.178636 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:06:06.178819 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:06.178889 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:06:06.178948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:06.183479 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:06.183618 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:06.183688 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:06:06.186630 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:06.188045 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:06.188183 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:06:06.189626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.190728 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:06.190814 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:06:06.191202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.191745 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:06:06.191815 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:06.191881 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:06:06.200919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:06:06.201915 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:06.202001 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:06:06.203215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:06.203870 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.203977 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:06:06.204196 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104957bb0>]}
15:06:06.204393 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.03s]
15:06:06.204603 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:06:06.204703 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:06:06.204806 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:06:06.205008 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:06:06.205162 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:06:06.205323 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:06:06.205923 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:06:06.206212 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.206291 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:06:06.207381 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:06:06.207579 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:06.207645 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:06:06.207705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:06.211257 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:06.211418 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:06.211497 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:06:06.213155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:06.214539 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:06.214630 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:06:06.215367 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.217629 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:06.217717 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:06:06.218055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.218740 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:06:06.218851 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:06.218918 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:06:06.219540 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:06.220608 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:06.220776 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:06:06.222328 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:06.222917 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.223011 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:06:06.223226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cbdf0>]}
15:06:06.223404 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:06:06.223650 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:06:06.223744 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:06:06.223851 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:06:06.224049 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:06:06.224124 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:06:06.224197 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:06:06.225723 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:06:06.226147 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.226243 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:06:06.236209 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:06:06.236641 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:06.236748 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:06:06.236823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:06.242476 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:06:06.242660 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:06.242744 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,2) as total_payment
    
    from payments

    where payments.state='successful'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
15:06:06.251082 [debug] [Thread-1  ]: SQL status: SELECT 50 in 0.01 seconds
15:06:06.252594 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:06.252687 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers" rename to "customers__dbt_backup"
15:06:06.253106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.254138 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:06.254222 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers__dbt_tmp" rename to "customers"
15:06:06.254729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:06.257412 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
15:06:06.257510 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:06.257582 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
15:06:06.258393 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:06.259132 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:06.259208 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
drop table if exists "demo_destination"."public"."customers__dbt_backup" cascade
15:06:06.262236 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:06:06.262750 [debug] [Thread-1  ]: finished collecting timing info
15:06:06.262849 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:06:06.263037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '407b9285-cf7b-429b-8729-ccac4e90a3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b0f70>]}
15:06:06.263206 [info ] [Thread-1  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 50[0m in 0.04s]
15:06:06.263404 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:06:06.264023 [debug] [MainThread]: Acquiring new postgres connection "master"
15:06:06.264157 [debug] [MainThread]: Using postgres connection "master"
15:06:06.264226 [debug] [MainThread]: On master: BEGIN
15:06:06.264288 [debug] [MainThread]: Opening a new connection, currently in state closed
15:06:06.268493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:06:06.268659 [debug] [MainThread]: On master: COMMIT
15:06:06.268730 [debug] [MainThread]: Using postgres connection "master"
15:06:06.268874 [debug] [MainThread]: On master: COMMIT
15:06:06.269046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:06:06.269127 [debug] [MainThread]: On master: Close
15:06:06.269321 [info ] [MainThread]: 
15:06:06.269449 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.29s.
15:06:06.269562 [debug] [MainThread]: Connection 'master' was properly closed.
15:06:06.269622 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:06:06.271903 [info ] [MainThread]: 
15:06:06.272050 [info ] [MainThread]: [32mCompleted successfully[0m
15:06:06.272183 [info ] [MainThread]: 
15:06:06.272289 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
15:06:06.272442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046af580>]}


============================== 2022-05-27 15:06:31.233760 | ec4034c5-80a7-4571-bec9-776aa1e826d5 ==============================
15:06:31.233780 [info ] [MainThread]: Running with dbt=1.1.0
15:06:31.234203 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:06:31.234308 [debug] [MainThread]: Tracking: tracking
15:06:31.248548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451beb0>]}
15:06:31.264854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:06:31.265143 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:06:31.271395 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:06:31.278733 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:06:31.281203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817ee0>]}
15:06:31.283607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469aeb0>]}
15:06:31.283740 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:06:31.283872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f4be0>]}
15:06:31.284607 [info ] [MainThread]: 
15:06:31.284836 [debug] [MainThread]: Acquiring new postgres connection "master"
15:06:31.285301 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:06:31.289952 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:06:31.290072 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:06:31.290145 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:06:31.321303 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:06:31.322160 [debug] [ThreadPool]: On list_demo_destination: Close
15:06:31.322766 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:06:31.346941 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:06:31.347111 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:06:31.347214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:06:31.351382 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:06:31.351477 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:06:31.351542 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:06:31.358779 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:06:31.359466 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:06:31.359767 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:06:31.362087 [debug] [MainThread]: Using postgres connection "master"
15:06:31.362200 [debug] [MainThread]: On master: BEGIN
15:06:31.362272 [debug] [MainThread]: Opening a new connection, currently in state init
15:06:31.366616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:06:31.366738 [debug] [MainThread]: Using postgres connection "master"
15:06:31.366808 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:06:31.396980 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:06:31.397805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c1f40>]}
15:06:31.397973 [debug] [MainThread]: On master: ROLLBACK
15:06:31.398231 [debug] [MainThread]: Using postgres connection "master"
15:06:31.398409 [debug] [MainThread]: On master: BEGIN
15:06:31.398810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:06:31.398924 [debug] [MainThread]: On master: COMMIT
15:06:31.399015 [debug] [MainThread]: Using postgres connection "master"
15:06:31.399095 [debug] [MainThread]: On master: COMMIT
15:06:31.399291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:06:31.399382 [debug] [MainThread]: On master: Close
15:06:31.399579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:06:31.399728 [info ] [MainThread]: 
15:06:31.401295 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:06:31.401483 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:06:31.401741 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:06:31.401824 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:06:31.401897 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:06:31.402657 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:06:31.402998 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.403083 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:06:31.414606 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:06:31.414984 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:31.415064 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:06:31.415126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:31.418066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:31.418169 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:31.418237 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:06:31.419121 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:31.422244 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:31.422345 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:06:31.422627 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.423634 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:31.423709 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:06:31.423918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.426848 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:06:31.426964 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:31.427029 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:06:31.428429 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:31.430532 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:06:31.430611 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:06:31.432635 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:31.433144 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.433231 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:06:31.433424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817cd0>]}
15:06:31.433584 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:06:31.433772 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:06:31.433861 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:06:31.434006 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:06:31.434233 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:06:31.434310 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:06:31.434382 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:06:31.434981 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:06:31.435232 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.435308 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:06:31.436332 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:06:31.436558 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:31.436623 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:06:31.436706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:31.441690 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:31.441771 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:31.441836 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:06:31.443430 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:31.444640 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:31.444725 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:06:31.445150 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.446030 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:31.446098 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:06:31.447696 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.449165 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:06:31.449276 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:31.449349 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:06:31.449813 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:31.450529 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:06:31.450604 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:06:31.451505 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:31.451970 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.452052 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:06:31.452227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104178b80>]}
15:06:31.452375 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:06:31.452553 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:06:31.452642 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:06:31.452739 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:06:31.452915 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:06:31.452984 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:06:31.453050 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:06:31.453662 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:06:31.453933 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.454005 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:06:31.454945 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:06:31.455135 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:31.455203 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:06:31.455264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:31.459996 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:31.460106 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:31.460176 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:06:31.462232 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:31.463460 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:31.463548 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:06:31.464255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.465312 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:31.465400 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:06:31.465988 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.466555 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:06:31.466627 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:31.466688 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:06:31.467424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:31.468093 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:06:31.468167 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:06:31.469142 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:31.469600 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.469684 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:06:31.469861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c8640>]}
15:06:31.470013 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:06:31.470198 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:06:31.470288 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:06:31.470388 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:06:31.470732 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:06:31.470821 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:06:31.470891 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:06:31.471575 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:06:31.471817 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.471891 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:06:31.472907 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:06:31.473103 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:31.473170 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:06:31.473229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:31.477345 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:31.477511 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:31.477583 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:06:31.480823 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:31.482070 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:31.482149 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:06:31.486851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.487912 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:31.487990 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:06:31.489281 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.489865 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:06:31.489945 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:31.490009 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:06:31.490935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:31.491648 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:06:31.491724 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:06:31.492818 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:06:31.493376 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.493470 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:06:31.493654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c40c70>]}
15:06:31.493833 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:06:31.494033 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:06:31.494123 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:06:31.494262 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:06:31.494462 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:06:31.494542 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:06:31.494612 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:06:31.495170 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:06:31.495421 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.495494 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:06:31.496547 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:06:31.496768 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:31.496833 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:06:31.496897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:31.501135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:31.501238 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:31.501299 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:06:31.503080 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:06:31.504251 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:31.504338 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:06:31.506737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.508677 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:31.508763 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:06:31.510032 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.510649 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:06:31.510753 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:31.510824 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:06:31.514149 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:31.514948 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:06:31.515025 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:06:31.525510 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:06:31.526104 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.526204 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:06:31.526400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a28d60>]}
15:06:31.526563 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.03s]
15:06:31.526750 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:06:31.526839 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:06:31.526982 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:06:31.527189 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:06:31.527264 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:06:31.527338 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:06:31.528897 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:06:31.529158 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.529238 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:06:31.539667 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:06:31.540045 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:31.540125 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:06:31.540186 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:06:31.544317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:06:31.544411 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:31.544477 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment
    
    from payments

    where payments.state='successful'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
15:06:31.551239 [debug] [Thread-1  ]: SQL status: SELECT 50 in 0.01 seconds
15:06:31.552653 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:31.552737 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers" rename to "customers__dbt_backup"
15:06:31.554265 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.555300 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:31.555379 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers__dbt_tmp" rename to "customers"
15:06:31.555852 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:06:31.558370 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
15:06:31.558449 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:31.558511 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
15:06:31.559264 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:06:31.559979 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:06:31.560061 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
drop table if exists "demo_destination"."public"."customers__dbt_backup" cascade
15:06:31.564358 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:06:31.564868 [debug] [Thread-1  ]: finished collecting timing info
15:06:31.564959 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:06:31.565147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4034c5-80a7-4571-bec9-776aa1e826d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ec430>]}
15:06:31.565306 [info ] [Thread-1  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 50[0m in 0.04s]
15:06:31.565495 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:06:31.565958 [debug] [MainThread]: Acquiring new postgres connection "master"
15:06:31.566043 [debug] [MainThread]: Using postgres connection "master"
15:06:31.566120 [debug] [MainThread]: On master: BEGIN
15:06:31.566182 [debug] [MainThread]: Opening a new connection, currently in state closed
15:06:31.571474 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:06:31.571579 [debug] [MainThread]: On master: COMMIT
15:06:31.571640 [debug] [MainThread]: Using postgres connection "master"
15:06:31.571699 [debug] [MainThread]: On master: COMMIT
15:06:31.571840 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:06:31.571907 [debug] [MainThread]: On master: Close
15:06:31.572055 [info ] [MainThread]: 
15:06:31.572171 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.29s.
15:06:31.572279 [debug] [MainThread]: Connection 'master' was properly closed.
15:06:31.572339 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:06:31.574535 [info ] [MainThread]: 
15:06:31.574659 [info ] [MainThread]: [32mCompleted successfully[0m
15:06:31.574788 [info ] [MainThread]: 
15:06:31.574891 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
15:06:31.575031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c40fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104500160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045000a0>]}


============================== 2022-05-27 15:08:22.543104 | a520671b-fe98-4b71-9b20-c5ca127c8ecf ==============================
15:08:22.543125 [info ] [MainThread]: Running with dbt=1.1.0
15:08:22.543563 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:08:22.543657 [debug] [MainThread]: Tracking: tracking
15:08:22.558273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118897e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118897f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188b40a0>]}
15:08:22.574048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:08:22.574269 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:08:22.580342 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:08:22.587641 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:08:22.589932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a82fd0>]}
15:08:22.592599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118888a60>]}
15:08:22.592800 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:08:22.592938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a1afd0>]}
15:08:22.593710 [info ] [MainThread]: 
15:08:22.593952 [debug] [MainThread]: Acquiring new postgres connection "master"
15:08:22.594472 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:08:22.599397 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:08:22.599515 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:08:22.599589 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:08:22.633263 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:08:22.634212 [debug] [ThreadPool]: On list_demo_destination: Close
15:08:22.634839 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:08:22.658635 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:08:22.658800 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:08:22.658867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:08:22.664368 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:08:22.664464 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:08:22.664531 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:08:22.667891 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
15:08:22.668528 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:08:22.670221 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:08:22.672197 [debug] [MainThread]: Using postgres connection "master"
15:08:22.672282 [debug] [MainThread]: On master: BEGIN
15:08:22.672347 [debug] [MainThread]: Opening a new connection, currently in state init
15:08:22.678925 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:08:22.679013 [debug] [MainThread]: Using postgres connection "master"
15:08:22.679078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:08:22.710753 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:08:22.711498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e9b50>]}
15:08:22.711663 [debug] [MainThread]: On master: ROLLBACK
15:08:22.711887 [debug] [MainThread]: Using postgres connection "master"
15:08:22.711970 [debug] [MainThread]: On master: BEGIN
15:08:22.712222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:08:22.712301 [debug] [MainThread]: On master: COMMIT
15:08:22.712369 [debug] [MainThread]: Using postgres connection "master"
15:08:22.712435 [debug] [MainThread]: On master: COMMIT
15:08:22.712587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:08:22.712670 [debug] [MainThread]: On master: Close
15:08:22.712835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:08:22.712977 [info ] [MainThread]: 
15:08:22.714576 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:08:22.714744 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:08:22.714997 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:08:22.715087 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:08:22.715170 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:08:22.715854 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:08:22.716176 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.716258 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:08:22.727718 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:08:22.728104 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:08:22.728182 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:08:22.728246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:22.730753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:08:22.730856 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:08:22.730926 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:08:22.731726 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:08:22.734748 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:08:22.734846 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:08:22.735117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.736129 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:08:22.736207 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:08:22.738756 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.741759 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:08:22.741842 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:08:22.741908 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:08:22.760967 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
15:08:22.763307 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:08:22.763400 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:08:22.764838 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:08:22.765414 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.765518 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:08:22.765735 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107532670>]}
15:08:22.765917 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.05s]
15:08:22.766134 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:08:22.766232 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:08:22.766396 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:08:22.766652 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:08:22.766742 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:08:22.766821 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:08:22.767544 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:08:22.767827 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.767915 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:08:22.769079 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:08:22.769405 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:08:22.769496 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:08:22.769571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:22.773626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:08:22.773722 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:08:22.773791 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:08:22.778788 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:08:22.780245 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:08:22.780338 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:08:22.780778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.781755 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:08:22.781832 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:08:22.782196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.783670 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:08:22.783751 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:08:22.783816 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:08:22.785920 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:08:22.786641 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:08:22.786715 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:08:22.787933 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:08:22.788428 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.788531 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:08:22.788721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11888b9a0>]}
15:08:22.788890 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:08:22.789085 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:08:22.789244 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:08:22.789443 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:08:22.789689 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:08:22.789776 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:08:22.789904 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:08:22.790674 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:08:22.790958 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.791047 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:08:22.792131 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:08:22.792361 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:08:22.792434 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:08:22.792498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:22.796396 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:08:22.796480 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:08:22.796551 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:08:22.798354 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:08:22.799576 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:08:22.799689 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:08:22.801978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.803118 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:08:22.803207 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:08:22.803510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.804070 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:08:22.804146 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:08:22.804213 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:08:22.804633 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:08:22.805324 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:08:22.805394 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:08:22.806534 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:08:22.807091 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.807194 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:08:22.807414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c47b20>]}
15:08:22.807590 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:08:22.807790 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:08:22.807884 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:08:22.808070 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:08:22.808288 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:08:22.808368 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:08:22.808441 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:08:22.809118 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:08:22.809382 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.809467 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:08:22.810574 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:08:22.810853 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:08:22.810931 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:08:22.810997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:22.817651 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:08:22.817800 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:08:22.817876 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:08:22.819676 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:08:22.820920 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:08:22.821022 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:08:22.821330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.822275 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:08:22.822356 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:08:22.822907 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.823455 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:08:22.823527 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:08:22.823588 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:08:22.824960 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:08:22.825657 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:08:22.825732 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:08:22.827571 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:08:22.828278 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.828420 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:08:22.828646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c2d220>]}
15:08:22.828843 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:08:22.829049 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:08:22.829139 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:08:22.829237 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:08:22.829418 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:08:22.829556 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:08:22.829658 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:08:22.830256 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:08:22.830534 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.830612 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:08:22.831680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:08:22.831889 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:08:22.831959 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:08:22.832018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:22.837325 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:08:22.837457 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:08:22.837522 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:08:22.844682 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
15:08:22.845942 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:08:22.846020 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:08:22.846442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.848469 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:08:22.848629 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:08:22.849914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:08:22.850545 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:08:22.850620 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:08:22.850681 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:08:22.852088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:08:22.852847 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:08:22.852920 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:08:22.854224 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:08:22.854664 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.854742 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:08:22.854915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ca7e50>]}
15:08:22.855076 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.03s]
15:08:22.855262 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:08:22.855350 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:08:22.855443 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:08:22.855621 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:08:22.855691 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:08:22.855757 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:08:22.857145 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:08:22.857517 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.857618 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:08:22.867720 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:08:22.868064 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:08:22.868153 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:08:22.868218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:08:22.873334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:08:22.873421 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:08:22.873484 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
    where payments.state='successful'

    group by account_id
),

account_status as (
    select account_id,
    count(payment.id) 
        from payments
    where payments.state='failed'

    group by account_id
)

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

)

select * from final
  );
15:08:22.873877 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "final"
LINE 38: final as (
         ^

15:08:22.873959 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:08:22.874177 [debug] [Thread-1  ]: finished collecting timing info
15:08:22.874245 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:08:22.874384 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "final"
  LINE 38: final as (
           ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:08:22.874500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a520671b-fe98-4b71-9b20-c5ca127c8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c75160>]}
15:08:22.874655 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:08:22.874836 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:08:22.875313 [debug] [MainThread]: Acquiring new postgres connection "master"
15:08:22.875407 [debug] [MainThread]: Using postgres connection "master"
15:08:22.875471 [debug] [MainThread]: On master: BEGIN
15:08:22.875530 [debug] [MainThread]: Opening a new connection, currently in state closed
15:08:22.884936 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:08:22.885039 [debug] [MainThread]: On master: COMMIT
15:08:22.885102 [debug] [MainThread]: Using postgres connection "master"
15:08:22.885164 [debug] [MainThread]: On master: COMMIT
15:08:22.885315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:08:22.885388 [debug] [MainThread]: On master: Close
15:08:22.885551 [info ] [MainThread]: 
15:08:22.885670 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.29s.
15:08:22.885780 [debug] [MainThread]: Connection 'master' was properly closed.
15:08:22.885838 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:08:22.888129 [info ] [MainThread]: 
15:08:22.888259 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:08:22.888383 [info ] [MainThread]: 
15:08:22.888488 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:08:22.888591 [error] [MainThread]:   syntax error at or near "final"
15:08:22.888691 [error] [MainThread]:   LINE 38: final as (
15:08:22.888791 [error] [MainThread]:            ^
15:08:22.888891 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:08:22.888999 [info ] [MainThread]: 
15:08:22.889105 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:08:22.889262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11888bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11888b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188759a0>]}


============================== 2022-05-27 15:09:43.037170 | 8c099c97-11a8-4c48-b565-aba5ea15155e ==============================
15:09:43.037189 [info ] [MainThread]: Running with dbt=1.1.0
15:09:43.037816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:09:43.038039 [debug] [MainThread]: Tracking: tracking
15:09:43.053035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab5070>]}
15:09:43.068869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:09:43.069224 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:09:43.075249 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:09:43.082721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:09:43.085059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c82fa0>]}
15:09:43.087818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6faf0>]}
15:09:43.088020 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:09:43.088169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1af70>]}
15:09:43.088915 [info ] [MainThread]: 
15:09:43.089137 [debug] [MainThread]: Acquiring new postgres connection "master"
15:09:43.089655 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:09:43.094499 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:09:43.094611 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:09:43.094688 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:09:43.121416 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:09:43.122437 [debug] [ThreadPool]: On list_demo_destination: Close
15:09:43.123105 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:09:43.146408 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:09:43.146577 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:09:43.146644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:09:43.152335 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:09:43.152436 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:09:43.152503 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:09:43.161137 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:09:43.161788 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:09:43.161997 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:09:43.164046 [debug] [MainThread]: Using postgres connection "master"
15:09:43.164134 [debug] [MainThread]: On master: BEGIN
15:09:43.164200 [debug] [MainThread]: Opening a new connection, currently in state init
15:09:43.167925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:09:43.168010 [debug] [MainThread]: Using postgres connection "master"
15:09:43.168074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:09:43.198552 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:09:43.199257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa4220>]}
15:09:43.199419 [debug] [MainThread]: On master: ROLLBACK
15:09:43.199639 [debug] [MainThread]: Using postgres connection "master"
15:09:43.199719 [debug] [MainThread]: On master: BEGIN
15:09:43.200030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:09:43.200111 [debug] [MainThread]: On master: COMMIT
15:09:43.200184 [debug] [MainThread]: Using postgres connection "master"
15:09:43.200250 [debug] [MainThread]: On master: COMMIT
15:09:43.200422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:09:43.200504 [debug] [MainThread]: On master: Close
15:09:43.200669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:09:43.200814 [info ] [MainThread]: 
15:09:43.202356 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:09:43.202507 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:09:43.202738 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:09:43.202820 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:09:43.202903 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:09:43.203616 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:09:43.203925 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.204016 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:09:43.215733 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:09:43.216107 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:43.216184 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:09:43.216248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:43.219502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:43.219610 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:43.219677 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:09:43.220531 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:43.223551 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:43.223658 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:09:43.223943 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.225078 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:43.225176 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:09:43.225390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.228518 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:09:43.228631 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:43.228697 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:09:43.229576 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:43.231667 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:43.231753 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:09:43.233008 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:43.233511 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.233603 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:09:43.233795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6dc40>]}
15:09:43.233956 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:09:43.234142 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:09:43.234235 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:09:43.234379 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:09:43.234605 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:09:43.234683 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:09:43.234757 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:09:43.235370 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:09:43.235659 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.235734 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:09:43.236763 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:09:43.236961 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:43.237027 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:09:43.237089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:43.264716 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
15:09:43.264932 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:43.265011 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:09:43.266975 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:43.268464 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:43.268564 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:09:43.268909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.269959 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:43.270040 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:09:43.270329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.272083 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:09:43.272225 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:43.272305 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:09:43.272726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:43.273526 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:43.273611 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:09:43.274608 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:43.275156 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.275255 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:09:43.275475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6e4c0>]}
15:09:43.275654 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.04s]
15:09:43.275852 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:09:43.276006 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:09:43.276131 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:09:43.276363 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:09:43.276510 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:09:43.276623 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:09:43.277347 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:09:43.277667 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.277748 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:09:43.278856 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:09:43.279117 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:43.279190 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:09:43.279254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:43.283713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:43.283859 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:43.283936 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:09:43.286827 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:43.288146 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:43.288242 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:09:43.288734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.289752 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:43.289837 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:09:43.290272 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.290934 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:09:43.291047 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:43.291126 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:09:43.291868 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:43.292716 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:43.292831 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:09:43.293731 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:43.294299 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.294401 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:09:43.294616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d34d60>]}
15:09:43.294804 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:09:43.295004 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:09:43.295102 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:09:43.295205 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:09:43.295455 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:09:43.295574 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:09:43.295652 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:09:43.296334 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:09:43.296647 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.296723 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:09:43.297752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:09:43.297936 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:43.298004 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:09:43.298070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:43.305300 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:09:43.305380 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:43.305446 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:09:43.308878 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:43.310008 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:43.310092 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:09:43.310748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.311735 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:43.311807 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:09:43.312257 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.312838 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:09:43.312912 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:43.312978 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:09:43.313826 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:43.314656 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:43.314738 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:09:43.315670 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:43.316411 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.316539 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:09:43.316759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8af10>]}
15:09:43.316923 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:09:43.317131 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:09:43.317224 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:09:43.317327 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:09:43.317571 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:09:43.317649 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:09:43.317721 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:09:43.318331 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:09:43.318588 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.318667 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:09:43.319809 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:09:43.320126 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:43.320219 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:09:43.320278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:43.325751 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:09:43.325898 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:43.325967 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:09:43.327589 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:43.328926 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:43.329019 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:09:43.329340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.331289 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:43.331410 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:09:43.331901 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:43.332507 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:09:43.332586 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:43.332652 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:09:43.333391 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:43.334120 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:43.334189 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:09:43.336310 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:43.336884 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.336985 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:09:43.337182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6e0a0>]}
15:09:43.337345 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:09:43.337531 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:09:43.337622 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:09:43.337764 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:09:43.337974 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:09:43.338052 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:09:43.338123 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:09:43.339613 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:09:43.339919 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.340016 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:09:43.350177 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:09:43.350560 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:09:43.350633 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:09:43.350696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:43.355194 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:43.355307 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:09:43.355371 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count(payment.id) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:09:43.356017 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "account_failed_payments"
LINE 44:         account_failed_payments.failed_count as account_fail...
                 ^

15:09:43.356103 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:09:43.356323 [debug] [Thread-1  ]: finished collecting timing info
15:09:43.356398 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:09:43.356550 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near "account_failed_payments"
  LINE 44:         account_failed_payments.failed_count as account_fail...
                   ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:09:43.356683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c099c97-11a8-4c48-b565-aba5ea15155e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4ed90>]}
15:09:43.356852 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:09:43.357073 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:09:43.357587 [debug] [MainThread]: Acquiring new postgres connection "master"
15:09:43.357681 [debug] [MainThread]: Using postgres connection "master"
15:09:43.357745 [debug] [MainThread]: On master: BEGIN
15:09:43.357806 [debug] [MainThread]: Opening a new connection, currently in state closed
15:09:43.361360 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:09:43.361442 [debug] [MainThread]: On master: COMMIT
15:09:43.361506 [debug] [MainThread]: Using postgres connection "master"
15:09:43.361564 [debug] [MainThread]: On master: COMMIT
15:09:43.361977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:09:43.362057 [debug] [MainThread]: On master: Close
15:09:43.362208 [info ] [MainThread]: 
15:09:43.362325 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.27s.
15:09:43.362432 [debug] [MainThread]: Connection 'master' was properly closed.
15:09:43.362490 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:09:43.364682 [info ] [MainThread]: 
15:09:43.364807 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:09:43.364932 [info ] [MainThread]: 
15:09:43.365037 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:09:43.365142 [error] [MainThread]:   syntax error at or near "account_failed_payments"
15:09:43.365242 [error] [MainThread]:   LINE 44:         account_failed_payments.failed_count as account_fail...
15:09:43.365340 [error] [MainThread]:                    ^
15:09:43.365438 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:09:43.365543 [info ] [MainThread]: 
15:09:43.365646 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:09:43.365787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6f2e0>]}


============================== 2022-05-27 15:09:57.449141 | 322650a7-be92-4e14-b05e-1933dc6d0bd1 ==============================
15:09:57.449161 [info ] [MainThread]: Running with dbt=1.1.0
15:09:57.449622 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:09:57.449718 [debug] [MainThread]: Tracking: tracking
15:09:57.464190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5070>]}
15:09:57.480678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:09:57.480937 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:09:57.486742 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:09:57.493953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:09:57.496333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d7fa0>]}
15:09:57.498758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cca30>]}
15:09:57.498896 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:09:57.499025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766ff70>]}
15:09:57.499741 [info ] [MainThread]: 
15:09:57.499957 [debug] [MainThread]: Acquiring new postgres connection "master"
15:09:57.500407 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:09:57.504940 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:09:57.505086 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:09:57.505193 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:09:57.512182 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
15:09:57.513218 [debug] [ThreadPool]: On list_demo_destination: Close
15:09:57.513843 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:09:57.538478 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:09:57.538682 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:09:57.538753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:09:57.544594 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:09:57.544690 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:09:57.544753 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:09:57.550573 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:09:57.551170 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:09:57.551412 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:09:57.553322 [debug] [MainThread]: Using postgres connection "master"
15:09:57.553410 [debug] [MainThread]: On master: BEGIN
15:09:57.553471 [debug] [MainThread]: Opening a new connection, currently in state init
15:09:57.557652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:09:57.557737 [debug] [MainThread]: Using postgres connection "master"
15:09:57.557801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:09:57.597058 [debug] [MainThread]: SQL status: SELECT 5 in 0.04 seconds
15:09:57.597830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c1eb0>]}
15:09:57.598004 [debug] [MainThread]: On master: ROLLBACK
15:09:57.598239 [debug] [MainThread]: Using postgres connection "master"
15:09:57.598324 [debug] [MainThread]: On master: BEGIN
15:09:57.598644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:09:57.598733 [debug] [MainThread]: On master: COMMIT
15:09:57.598812 [debug] [MainThread]: Using postgres connection "master"
15:09:57.598884 [debug] [MainThread]: On master: COMMIT
15:09:57.599069 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:09:57.599155 [debug] [MainThread]: On master: Close
15:09:57.599325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:09:57.599478 [info ] [MainThread]: 
15:09:57.601061 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:09:57.601215 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:09:57.601448 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:09:57.601530 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:09:57.601608 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:09:57.602325 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:09:57.602665 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.602749 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:09:57.614850 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:09:57.615263 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:57.615349 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:09:57.615420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:57.619869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:57.620013 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:57.620089 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:09:57.620976 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:57.624279 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:57.624420 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:09:57.624774 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.625863 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:57.625950 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:09:57.626241 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.629568 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:09:57.629689 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:57.629763 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:09:57.630178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:57.632769 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:09:57.632862 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:09:57.633522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:57.634098 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.634196 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:09:57.634394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107400fd0>]}
15:09:57.634573 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:09:57.634782 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:09:57.634884 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:09:57.635045 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:09:57.635263 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:09:57.635364 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:09:57.635434 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:09:57.636118 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:09:57.636427 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.636513 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:09:57.637594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:09:57.637808 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:57.637879 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:09:57.637943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:57.640667 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:57.640765 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:57.640829 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:09:57.641569 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:57.642706 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:57.642786 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:09:57.643016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.643990 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:57.644082 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:09:57.644345 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.645856 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:09:57.645976 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:57.646057 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:09:57.646669 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:57.647459 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:09:57.647532 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:09:57.648087 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:57.648604 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.648693 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:09:57.648879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107187310>]}
15:09:57.649046 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
15:09:57.649244 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:09:57.649340 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:09:57.649436 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:09:57.649626 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:09:57.649694 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:09:57.649763 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:09:57.650377 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:09:57.650649 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.650749 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:09:57.651810 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:09:57.652076 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:57.652146 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:09:57.652209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:57.655878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:57.655964 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:57.656023 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:09:57.658142 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:57.659329 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:57.659412 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:09:57.659776 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.660691 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:57.660783 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:09:57.661122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.661639 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:09:57.661711 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:57.661772 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:09:57.662171 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:57.662795 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:09:57.662859 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:09:57.663839 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:57.664269 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.664361 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:09:57.664541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077879a0>]}
15:09:57.664695 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.01s]
15:09:57.664877 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:09:57.664966 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:09:57.665152 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:09:57.665337 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:09:57.665406 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:09:57.665478 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:09:57.666079 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:09:57.666320 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.666389 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:09:57.667348 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:09:57.667521 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:57.667589 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:09:57.667647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:57.672248 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:57.672326 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:57.672386 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:09:57.674694 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:57.675724 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:57.675797 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:09:57.676575 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.677513 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:57.677585 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:09:57.677906 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.678516 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:09:57.678600 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:57.678664 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:09:57.679133 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:57.679769 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:09:57.679837 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:09:57.680744 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:09:57.681258 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.681347 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:09:57.681511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107762c10>]}
15:09:57.681658 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:09:57.681831 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:09:57.681919 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:09:57.682041 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:09:57.682216 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:09:57.682284 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:09:57.682349 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:09:57.682860 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:09:57.683129 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.683205 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:09:57.684277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:09:57.684555 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:57.684625 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:09:57.684686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:57.690521 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:09:57.690682 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:57.690749 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:09:57.692854 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:09:57.694118 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:57.694205 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:09:57.694691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.696293 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:57.696363 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:09:57.700821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:09:57.701474 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:09:57.701548 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:57.701610 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:09:57.702124 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:09:57.702880 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:09:57.702951 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:09:57.711205 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:09:57.711728 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.711818 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:09:57.712007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e9fa0>]}
15:09:57.712171 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.03s]
15:09:57.712360 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:09:57.712450 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:09:57.712550 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:09:57.712771 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:09:57.712843 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:09:57.712912 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:09:57.714374 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:09:57.714634 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.714710 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:09:57.725143 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:09:57.725487 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:09:57.725571 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:09:57.725635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:09:57.729121 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:09:57.729274 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:09:57.729345 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count(payment.id) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value,
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:09:57.730753 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "payment"
LINE 31:     count(payment.id) as failed_count
                   ^

15:09:57.730840 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:09:57.731059 [debug] [Thread-1  ]: finished collecting timing info
15:09:57.731163 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:09:57.731313 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  missing FROM-clause entry for table "payment"
  LINE 31:     count(payment.id) as failed_count
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:09:57.731438 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322650a7-be92-4e14-b05e-1933dc6d0bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077629a0>]}
15:09:57.731602 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:09:57.731791 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:09:57.732408 [debug] [MainThread]: Acquiring new postgres connection "master"
15:09:57.732523 [debug] [MainThread]: Using postgres connection "master"
15:09:57.732598 [debug] [MainThread]: On master: BEGIN
15:09:57.732667 [debug] [MainThread]: Opening a new connection, currently in state closed
15:09:57.736102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:09:57.736290 [debug] [MainThread]: On master: COMMIT
15:09:57.736369 [debug] [MainThread]: Using postgres connection "master"
15:09:57.736439 [debug] [MainThread]: On master: COMMIT
15:09:57.736609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:09:57.736700 [debug] [MainThread]: On master: Close
15:09:57.736901 [info ] [MainThread]: 
15:09:57.737044 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
15:09:57.737166 [debug] [MainThread]: Connection 'master' was properly closed.
15:09:57.737229 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:09:57.739655 [info ] [MainThread]: 
15:09:57.739820 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:09:57.739956 [info ] [MainThread]: 
15:09:57.740067 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:09:57.740192 [error] [MainThread]:   missing FROM-clause entry for table "payment"
15:09:57.740311 [error] [MainThread]:   LINE 31:     count(payment.id) as failed_count
15:09:57.740415 [error] [MainThread]:                      ^
15:09:57.740520 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:09:57.740634 [info ] [MainThread]: 
15:09:57.740742 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:09:57.740950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107187a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107187a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107177070>]}


============================== 2022-05-27 15:10:29.239616 | e0fdf9df-6e09-4661-bddc-d50c4d415c1b ==============================
15:10:29.239636 [info ] [MainThread]: Running with dbt=1.1.0
15:10:29.240058 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:10:29.240162 [debug] [MainThread]: Tracking: tracking
15:10:29.254930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af99df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af99f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af99f70>]}
15:10:29.271472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:10:29.271750 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:10:29.278157 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:10:29.285766 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:10:29.288133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b182f70>]}
15:10:29.290533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11efa0>]}
15:10:29.290672 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:10:29.290807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11af40>]}
15:10:29.291519 [info ] [MainThread]: 
15:10:29.291736 [debug] [MainThread]: Acquiring new postgres connection "master"
15:10:29.292279 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:10:29.297286 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:10:29.297442 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:10:29.297521 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:10:29.320972 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
15:10:29.321864 [debug] [ThreadPool]: On list_demo_destination: Close
15:10:29.322501 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:10:29.345804 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:10:29.345976 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:10:29.346048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:10:29.350109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:10:29.350198 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:10:29.350269 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:10:29.353292 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
15:10:29.353936 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:10:29.354126 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:10:29.356072 [debug] [MainThread]: Using postgres connection "master"
15:10:29.356159 [debug] [MainThread]: On master: BEGIN
15:10:29.356223 [debug] [MainThread]: Opening a new connection, currently in state init
15:10:29.359300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:10:29.359374 [debug] [MainThread]: Using postgres connection "master"
15:10:29.359436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:10:29.391505 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:10:29.392251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa41c0>]}
15:10:29.392417 [debug] [MainThread]: On master: ROLLBACK
15:10:29.392692 [debug] [MainThread]: Using postgres connection "master"
15:10:29.392865 [debug] [MainThread]: On master: BEGIN
15:10:29.393154 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:10:29.393270 [debug] [MainThread]: On master: COMMIT
15:10:29.393350 [debug] [MainThread]: Using postgres connection "master"
15:10:29.393423 [debug] [MainThread]: On master: COMMIT
15:10:29.393624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:10:29.393753 [debug] [MainThread]: On master: Close
15:10:29.393935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:10:29.394083 [info ] [MainThread]: 
15:10:29.395843 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:10:29.396022 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:10:29.396281 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:10:29.396371 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:10:29.396458 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:10:29.397231 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:10:29.397565 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.397654 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:10:29.409128 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:10:29.409434 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:29.409513 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:10:29.409581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:29.412380 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:29.412585 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:29.412677 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:10:29.414052 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:29.417357 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:29.417523 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:10:29.418019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.419168 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:29.419258 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:10:29.419547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.422600 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:10:29.422695 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:29.422767 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:10:29.423820 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:29.425863 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:29.425946 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:10:29.427726 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:29.428232 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.428319 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:10:29.428518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad37940>]}
15:10:29.428681 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:10:29.428881 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:10:29.428969 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:10:29.429067 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:10:29.429247 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:10:29.429373 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:10:29.429452 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:10:29.430056 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:10:29.430307 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.430388 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:10:29.431361 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:10:29.431554 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:29.431621 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:10:29.431683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:29.436551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:29.436628 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:29.436688 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:10:29.438315 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:29.439530 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:29.439615 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:10:29.440349 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.441546 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:29.441654 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:10:29.442045 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.443473 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:10:29.443556 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:29.443622 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:10:29.444101 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:29.444968 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:29.445094 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:10:29.446362 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:29.446998 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.447105 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:10:29.447320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad37040>]}
15:10:29.447493 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:10:29.447696 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:10:29.447793 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:10:29.448029 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:10:29.448300 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:10:29.448379 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:10:29.448452 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:10:29.449135 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:10:29.449406 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.449483 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:10:29.450624 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:10:29.450959 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:29.451066 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:10:29.451132 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:29.454603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:29.454746 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:29.454818 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:10:29.456546 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:29.457773 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:29.457860 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:10:29.458556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.459616 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:29.459708 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:10:29.460161 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.460829 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:10:29.460946 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:29.461013 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:10:29.461499 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:29.462440 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:29.462534 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:10:29.463420 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:29.463972 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.464061 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:10:29.464240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad61670>]}
15:10:29.464389 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:10:29.464565 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:10:29.464648 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:10:29.464837 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:10:29.465132 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:10:29.465210 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:10:29.465276 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:10:29.465929 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:10:29.466187 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.466264 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:10:29.467225 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:10:29.467398 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:29.467462 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:10:29.467520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:29.471114 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:29.471247 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:29.471315 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:10:29.473127 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:29.474313 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:29.474388 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:10:29.474770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.475713 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:29.475785 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:10:29.476117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.476606 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:10:29.476687 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:29.476746 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:10:29.477586 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:29.478700 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:29.478841 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:10:29.480066 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:29.480818 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.480913 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:10:29.481134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20f640>]}
15:10:29.481335 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:10:29.481562 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:10:29.481665 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:10:29.481828 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:10:29.482024 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:10:29.482102 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:10:29.482179 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:10:29.482751 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:10:29.483099 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.483193 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:10:29.484357 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:10:29.484645 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:29.484753 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:10:29.484810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:29.489434 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:29.489547 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:29.489616 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:10:29.493598 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:29.494936 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:29.495043 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:10:29.495600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.497345 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:29.497425 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:10:29.498429 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:29.498995 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:10:29.499067 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:29.499130 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:10:29.499721 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:29.500423 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:29.500496 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:10:29.502501 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:29.502971 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.503060 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:10:29.503244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b28c0d0>]}
15:10:29.503418 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:10:29.503612 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:10:29.503702 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:10:29.503843 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:10:29.504055 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:10:29.504132 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:10:29.504206 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:10:29.505710 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:10:29.505971 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.506049 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:10:29.516218 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:10:29.517128 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:29.517267 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:10:29.517338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:29.520785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:29.520896 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:29.520956 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
        
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count(id) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value,
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:10:29.522345 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "id" does not exist
LINE 32:     count(id) as failed_count
                   ^

15:10:29.522427 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:10:29.522630 [debug] [Thread-1  ]: finished collecting timing info
15:10:29.522726 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:10:29.522901 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  column "id" does not exist
  LINE 32:     count(id) as failed_count
                     ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:10:29.523025 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fdf9df-6e09-4661-bddc-d50c4d415c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23f520>]}
15:10:29.523197 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:10:29.523386 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:10:29.523876 [debug] [MainThread]: Acquiring new postgres connection "master"
15:10:29.523965 [debug] [MainThread]: Using postgres connection "master"
15:10:29.524030 [debug] [MainThread]: On master: BEGIN
15:10:29.524089 [debug] [MainThread]: Opening a new connection, currently in state closed
15:10:29.530051 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:10:29.530147 [debug] [MainThread]: On master: COMMIT
15:10:29.530209 [debug] [MainThread]: Using postgres connection "master"
15:10:29.530270 [debug] [MainThread]: On master: COMMIT
15:10:29.530463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:10:29.530533 [debug] [MainThread]: On master: Close
15:10:29.530682 [info ] [MainThread]: 
15:10:29.530800 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.24s.
15:10:29.530909 [debug] [MainThread]: Connection 'master' was properly closed.
15:10:29.530969 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:10:29.533460 [info ] [MainThread]: 
15:10:29.533588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:10:29.533708 [info ] [MainThread]: 
15:10:29.533814 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:10:29.533925 [error] [MainThread]:   column "id" does not exist
15:10:29.534024 [error] [MainThread]:   LINE 32:     count(id) as failed_count
15:10:29.534123 [error] [MainThread]:                      ^
15:10:29.534221 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:10:29.534327 [info ] [MainThread]: 
15:10:29.534435 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:10:29.534577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af81df0>]}


============================== 2022-05-27 15:10:40.387633 | d7feb539-512d-47ba-80fd-26ddadb8c98a ==============================
15:10:40.387653 [info ] [MainThread]: Running with dbt=1.1.0
15:10:40.388089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:10:40.388195 [debug] [MainThread]: Tracking: tracking
15:10:40.404247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb40d0>]}
15:10:40.419770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:10:40.420071 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:10:40.426122 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:10:40.433261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:10:40.435527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d83f40>]}
15:10:40.438266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1efa0>]}
15:10:40.438462 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:10:40.438605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1af70>]}
15:10:40.439346 [info ] [MainThread]: 
15:10:40.439598 [debug] [MainThread]: Acquiring new postgres connection "master"
15:10:40.440102 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:10:40.444987 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:10:40.445114 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:10:40.445189 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:10:40.460669 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
15:10:40.461694 [debug] [ThreadPool]: On list_demo_destination: Close
15:10:40.462471 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:10:40.486575 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:10:40.486762 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:10:40.486831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:10:40.491077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:10:40.491242 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:10:40.491320 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:10:40.494150 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
15:10:40.494934 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:10:40.495260 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:10:40.497683 [debug] [MainThread]: Using postgres connection "master"
15:10:40.497791 [debug] [MainThread]: On master: BEGIN
15:10:40.497863 [debug] [MainThread]: Opening a new connection, currently in state init
15:10:40.501897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:10:40.501987 [debug] [MainThread]: Using postgres connection "master"
15:10:40.502054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:10:40.532466 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:10:40.533264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6f700>]}
15:10:40.533443 [debug] [MainThread]: On master: ROLLBACK
15:10:40.533650 [debug] [MainThread]: Using postgres connection "master"
15:10:40.533738 [debug] [MainThread]: On master: BEGIN
15:10:40.533997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:10:40.534080 [debug] [MainThread]: On master: COMMIT
15:10:40.534156 [debug] [MainThread]: Using postgres connection "master"
15:10:40.534223 [debug] [MainThread]: On master: COMMIT
15:10:40.534398 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:10:40.534482 [debug] [MainThread]: On master: Close
15:10:40.534653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:10:40.534800 [info ] [MainThread]: 
15:10:40.536432 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:10:40.536588 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:10:40.536806 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:10:40.536886 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:10:40.536970 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:10:40.537659 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:10:40.537970 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.538048 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:10:40.549293 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:10:40.549613 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:40.549686 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:10:40.549750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:40.553684 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:40.553841 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:40.553906 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:10:40.555581 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:40.558605 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:40.558735 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:10:40.559082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.560194 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:40.560274 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:10:40.560616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.563615 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:10:40.563707 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:40.563780 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:10:40.564229 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:40.566254 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:10:40.566351 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:10:40.567437 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:40.568015 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.568104 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:10:40.568310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107229340>]}
15:10:40.568502 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:10:40.568724 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:10:40.568819 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:10:40.568924 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:10:40.569128 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:10:40.569209 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:10:40.569282 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:10:40.569940 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:10:40.570232 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.570311 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:10:40.571355 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:10:40.571551 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:40.571618 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:10:40.571679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:40.575898 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:40.575986 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:40.576046 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:10:40.577564 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:40.578619 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:40.578695 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:10:40.579017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.579895 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:40.579962 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:10:40.580290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.581551 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:10:40.581632 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:40.581697 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:10:40.582141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:40.582811 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:10:40.582881 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:10:40.584066 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:40.584486 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.584566 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:10:40.584721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107947d30>]}
15:10:40.584864 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:10:40.585036 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:10:40.585123 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:10:40.585217 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:10:40.585400 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:10:40.585475 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:10:40.585543 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:10:40.586313 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:10:40.586643 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.586728 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:10:40.587804 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:10:40.588013 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:40.588082 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:10:40.588143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:40.591856 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:40.592028 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:40.592094 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:10:40.593689 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:40.594940 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:40.595023 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:10:40.595429 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.596381 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:40.596449 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:10:40.597015 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.597604 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:10:40.597675 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:40.597738 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:10:40.598491 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:40.599145 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:10:40.599217 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:10:40.601197 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:40.601784 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.601967 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:10:40.602204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f47070>]}
15:10:40.602370 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:10:40.602556 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:10:40.602641 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:10:40.602902 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:10:40.603243 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:10:40.603348 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:10:40.603434 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:10:40.604213 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:10:40.604519 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.604594 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:10:40.605651 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:10:40.605874 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:40.605943 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:10:40.606007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:40.610184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:40.610304 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:40.610373 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:10:40.612128 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:40.613556 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:40.613661 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:10:40.614187 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.615470 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:40.615586 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:10:40.616121 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.616797 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:10:40.616874 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:40.616939 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:10:40.617571 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:40.618328 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:10:40.618403 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:10:40.619959 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:40.620721 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.620827 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:10:40.621053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f27c10>]}
15:10:40.621231 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:10:40.621432 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:10:40.621521 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:10:40.621622 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:10:40.621808 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:10:40.621880 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:10:40.621952 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:10:40.622506 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:10:40.622777 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.622849 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:10:40.624013 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:10:40.624384 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:40.624465 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:10:40.624536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:40.628420 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:40.628512 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:40.628574 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:10:40.631657 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:10:40.632903 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:40.633017 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:10:40.634440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.636219 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:40.636307 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:10:40.637220 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.637938 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:10:40.638017 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:40.638078 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:10:40.638689 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:40.639470 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:10:40.639540 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:10:40.641491 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:10:40.641989 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.642114 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:10:40.642321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa9fa0>]}
15:10:40.642489 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:10:40.642693 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:10:40.642786 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:10:40.642886 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:10:40.643069 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:10:40.643138 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:10:40.643207 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:10:40.644668 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:10:40.645043 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.645122 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:10:40.655489 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:10:40.655957 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:40.656038 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:10:40.656105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:10:40.660310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:10:40.660421 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:40.660486 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
        
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count( payment_id ) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value,
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:10:40.669793 [debug] [Thread-1  ]: SQL status: SELECT 50 in 0.01 seconds
15:10:40.671224 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:40.671313 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers" rename to "customers__dbt_backup"
15:10:40.671746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.672719 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:40.672790 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
alter table "demo_destination"."public"."customers__dbt_tmp" rename to "customers"
15:10:40.673612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:10:40.676272 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
15:10:40.676357 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:40.676425 [debug] [Thread-1  ]: On model.demo_data_project.customers: COMMIT
15:10:40.677010 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:10:40.677759 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:10:40.677828 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */
drop table if exists "demo_destination"."public"."customers__dbt_backup" cascade
15:10:40.680817 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:10:40.681286 [debug] [Thread-1  ]: finished collecting timing info
15:10:40.681373 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:10:40.681560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7feb539-512d-47ba-80fd-26ddadb8c98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b680d0>]}
15:10:40.681719 [info ] [Thread-1  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 50[0m in 0.04s]
15:10:40.681914 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:10:40.682379 [debug] [MainThread]: Acquiring new postgres connection "master"
15:10:40.682486 [debug] [MainThread]: Using postgres connection "master"
15:10:40.682557 [debug] [MainThread]: On master: BEGIN
15:10:40.682622 [debug] [MainThread]: Opening a new connection, currently in state closed
15:10:40.688626 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:10:40.688719 [debug] [MainThread]: On master: COMMIT
15:10:40.688786 [debug] [MainThread]: Using postgres connection "master"
15:10:40.688849 [debug] [MainThread]: On master: COMMIT
15:10:40.689016 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:10:40.689091 [debug] [MainThread]: On master: Close
15:10:40.689245 [info ] [MainThread]: 
15:10:40.689368 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
15:10:40.689481 [debug] [MainThread]: Connection 'master' was properly closed.
15:10:40.689542 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:10:40.691975 [info ] [MainThread]: 
15:10:40.692146 [info ] [MainThread]: [32mCompleted successfully[0m
15:10:40.692283 [info ] [MainThread]: 
15:10:40.692392 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
15:10:40.692540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6e370>]}


============================== 2022-05-27 15:21:20.637654 | 0a83f58a-0721-441e-a43f-178c19ef7e0a ==============================
15:21:20.637671 [info ] [MainThread]: Running with dbt=1.1.0
15:21:20.638235 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:21:20.638333 [debug] [MainThread]: Tracking: tracking
15:21:20.654416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609adc0>]}
15:21:20.673099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
15:21:20.673313 [debug] [MainThread]: Partial parsing: added file: demo_data_project://models/users.sql
15:21:20.673453 [debug] [MainThread]: Partial parsing: updated file: demo_data_project://models/customers.sql
15:21:20.679520 [debug] [MainThread]: 1699: static parser successfully parsed users.sql
15:21:20.685711 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
15:21:20.688173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:21:20.690550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106289f40>]}
15:21:20.692959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621ad90>]}
15:21:20.693112 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:21:20.693254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606dca0>]}
15:21:20.694059 [info ] [MainThread]: 
15:21:20.694331 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:20.694842 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:21:20.699649 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:21:20.699790 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:21:20.699863 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:21:20.731354 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:21:20.732329 [debug] [ThreadPool]: On list_demo_destination: Close
15:21:20.732969 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:21:20.755285 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:21:20.755453 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:21:20.755521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:21:20.762227 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:21:20.762321 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:21:20.762385 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:21:20.770875 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:21:20.771500 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:21:20.771765 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:21:20.773804 [debug] [MainThread]: Using postgres connection "master"
15:21:20.773897 [debug] [MainThread]: On master: BEGIN
15:21:20.773962 [debug] [MainThread]: Opening a new connection, currently in state init
15:21:20.784240 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:21:20.784325 [debug] [MainThread]: Using postgres connection "master"
15:21:20.784393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:21:20.814332 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:21:20.815079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025cf640>]}
15:21:20.815255 [debug] [MainThread]: On master: ROLLBACK
15:21:20.815501 [debug] [MainThread]: Using postgres connection "master"
15:21:20.815588 [debug] [MainThread]: On master: BEGIN
15:21:20.815902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:21:20.815990 [debug] [MainThread]: On master: COMMIT
15:21:20.816071 [debug] [MainThread]: Using postgres connection "master"
15:21:20.816144 [debug] [MainThread]: On master: COMMIT
15:21:20.816332 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:21:20.816422 [debug] [MainThread]: On master: Close
15:21:20.816595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:21:20.816757 [info ] [MainThread]: 
15:21:20.819768 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:21:20.819935 [info ] [Thread-1  ]: 1 of 7 START view model public.stg_accounts .................................... [RUN]
15:21:20.820186 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:21:20.820277 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:21:20.820365 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:21:20.821131 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:21:20.821580 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.821670 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:21:20.833739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:21:20.834098 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:20.834175 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:21:20.834239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.836758 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:20.836844 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:20.836910 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:21:20.837792 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:20.840886 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:20.840982 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:21:20.841310 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.842439 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:20.842527 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:21:20.842749 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.845936 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:21:20.846042 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:20.846117 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:21:20.846852 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:20.849039 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:20.849123 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:21:20.849815 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:20.850309 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.850397 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:21:20.850582 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0ed30>]}
15:21:20.850749 [info ] [Thread-1  ]: 1 of 7 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.03s]
15:21:20.850950 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:21:20.851049 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:21:20.851192 [info ] [Thread-1  ]: 2 of 7 START view model public.stg_payments .................................... [RUN]
15:21:20.851400 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:21:20.851477 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:21:20.851547 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:21:20.852156 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:21:20.852385 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.852458 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:21:20.853473 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:21:20.853675 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:20.853755 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:21:20.853817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.856222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:20.856306 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:20.856369 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:21:20.857075 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:20.858163 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:20.858237 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:21:20.858457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.859366 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:20.859439 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:21:20.859663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.861047 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:21:20.861155 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:20.861218 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:21:20.861540 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:20.862231 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:20.862300 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:21:20.862814 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:20.863351 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.863464 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:21:20.863656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106353040>]}
15:21:20.863821 [info ] [Thread-1  ]: 2 of 7 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.01s]
15:21:20.864032 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:21:20.864130 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:21:20.864266 [info ] [Thread-1  ]: 3 of 7 START view model public.stg_plans ....................................... [RUN]
15:21:20.864446 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:21:20.864519 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:21:20.864586 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:21:20.865198 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:21:20.865434 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.865504 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:21:20.866468 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:21:20.866815 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:20.866881 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:21:20.866940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.871260 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:20.871366 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:20.871438 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:21:20.873592 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:20.874826 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:20.874911 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:21:20.879467 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.880708 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:20.880799 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:21:20.881205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.881948 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:21:20.882031 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:20.882096 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:21:20.882617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:20.883375 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:20.883468 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:21:20.884803 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:20.885258 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.885345 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:21:20.885526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e07790>]}
15:21:20.885693 [info ] [Thread-1  ]: 3 of 7 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:21:20.885879 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:21:20.885970 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:21:20.886117 [info ] [Thread-1  ]: 4 of 7 START view model public.stg_purchases ................................... [RUN]
15:21:20.886349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:21:20.886420 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:21:20.886486 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:21:20.887135 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:21:20.887397 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.887470 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:21:20.888550 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:21:20.888764 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:20.888832 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:21:20.888893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.893336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:20.893483 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:20.893554 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:21:20.896129 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:20.897366 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:20.897473 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:21:20.898212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.899211 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:20.899282 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:21:20.899702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.900216 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:21:20.900283 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:20.900344 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:21:20.900791 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:20.901414 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:20.901477 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:21:20.902482 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:20.903016 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.903104 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:21:20.903292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630cd00>]}
15:21:20.903460 [info ] [Thread-1  ]: 4 of 7 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:21:20.903651 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:21:20.903743 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:21:20.903886 [info ] [Thread-1  ]: 5 of 7 START view model public.stg_users ....................................... [RUN]
15:21:20.904078 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:21:20.904148 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:21:20.904217 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:21:20.904952 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:21:20.905267 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.905352 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:21:20.906442 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:21:20.906640 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:20.906709 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:21:20.906769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.913865 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:20.914029 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:20.914096 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:21:20.916380 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:20.917716 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:20.917821 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:21:20.918208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.919990 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:20.920081 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:21:20.920416 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:20.921056 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:21:20.921136 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:20.921210 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:21:20.921796 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:20.922572 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:20.922642 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:21:20.924119 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:20.924608 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.924694 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:21:20.924878 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638c070>]}
15:21:20.925041 [info ] [Thread-1  ]: 5 of 7 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:21:20.925233 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:21:20.925318 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:21:20.925415 [info ] [Thread-1  ]: 6 of 7 START table model public.customers ...................................... [RUN]
15:21:20.925591 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:21:20.925668 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:21:20.925739 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:21:20.927203 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:21:20.927509 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.927587 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:21:20.937295 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:21:20.937581 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:21:20.937658 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:21:20.937724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.941902 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:20.941986 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:21:20.942046 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
        
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count( payment_id ) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

account_status as (
    select account_id,
    account_payments,
    extract(YEAR from age(account.created_at, current_timestamp())) * 12 + extract(MONTH FROM age(account.created_at, current_timestamp())) as account_age_months,
    account_age_months * (SELECT plan.price WHERE plan.plan_id = account.plan_id) as billable_amount,

    from accounts

    left join account_payments
        on accounts.account_id = account_payments.account_id
    left join plans
        on accounts.plan_id = plan.plan_id
)

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value,
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:21:20.942379 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 42: ...AR from age(account.created_at, current_timestamp())) * 12 +...
                                                              ^

15:21:20.942454 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:21:20.942634 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.942701 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:21:20.942830 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near ")"
  LINE 42: ...AR from age(account.created_at, current_timestamp())) * 12 +...
                                                                ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:21:20.942940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1a850>]}
15:21:20.943077 [error] [Thread-1  ]: 6 of 7 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:21:20.943245 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:21:20.943327 [debug] [Thread-1  ]: Began running node model.demo_data_project.users
15:21:20.943463 [info ] [Thread-1  ]: 7 of 7 START table model public.users .......................................... [RUN]
15:21:20.943645 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.users"
15:21:20.943718 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.users
15:21:20.943783 [debug] [Thread-1  ]: Compiling model.demo_data_project.users
15:21:20.945064 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.users"
15:21:20.945312 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.945386 [debug] [Thread-1  ]: Began executing node model.demo_data_project.users
15:21:20.946504 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.users"
15:21:20.946686 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.users"
15:21:20.946755 [debug] [Thread-1  ]: On model.demo_data_project.users: BEGIN
15:21:20.946814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:20.951382 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:20.951464 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.users"
15:21:20.951523 [debug] [Thread-1  ]: On model.demo_data_project.users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.users"} */


  create  table "demo_destination"."public"."users__dbt_tmp"
  as (
    

with users as (
    select * from "demo_destination"."public"."stg_users"
),

purchases as (
    select * from "demo_destination"."public"."stg_purchases"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
        
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count( payment_id ) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value,
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:21:20.952330 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "payments" does not exist
LINE 19:         from payments
                      ^

15:21:20.952399 [debug] [Thread-1  ]: On model.demo_data_project.users: ROLLBACK
15:21:20.952582 [debug] [Thread-1  ]: finished collecting timing info
15:21:20.952646 [debug] [Thread-1  ]: On model.demo_data_project.users: Close
15:21:20.952767 [debug] [Thread-1  ]: Database Error in model users (models/users.sql)
  relation "payments" does not exist
  LINE 19:         from payments
                        ^
  compiled SQL at target/run/demo_data_project/models/users.sql
15:21:20.952868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a83f58a-0721-441e-a43f-178c19ef7e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106314880>]}
15:21:20.952997 [error] [Thread-1  ]: 7 of 7 ERROR creating table model public.users ................................. [[31mERROR[0m in 0.01s]
15:21:20.953153 [debug] [Thread-1  ]: Finished running node model.demo_data_project.users
15:21:20.953599 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:20.953690 [debug] [MainThread]: Using postgres connection "master"
15:21:20.953756 [debug] [MainThread]: On master: BEGIN
15:21:20.953817 [debug] [MainThread]: Opening a new connection, currently in state closed
15:21:20.958550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:21:20.958635 [debug] [MainThread]: On master: COMMIT
15:21:20.958696 [debug] [MainThread]: Using postgres connection "master"
15:21:20.958755 [debug] [MainThread]: On master: COMMIT
15:21:20.959243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:21:20.959310 [debug] [MainThread]: On master: Close
15:21:20.959452 [info ] [MainThread]: 
15:21:20.959567 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.27s.
15:21:20.959677 [debug] [MainThread]: Connection 'master' was properly closed.
15:21:20.959735 [debug] [MainThread]: Connection 'model.demo_data_project.users' was properly closed.
15:21:20.961869 [info ] [MainThread]: 
15:21:20.961990 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
15:21:20.962108 [info ] [MainThread]: 
15:21:20.962212 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:21:20.962313 [error] [MainThread]:   syntax error at or near ")"
15:21:20.962411 [error] [MainThread]:   LINE 42: ...AR from age(account.created_at, current_timestamp())) * 12 +...
15:21:20.962508 [error] [MainThread]:                                                                 ^
15:21:20.962606 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:21:20.962704 [info ] [MainThread]: 
15:21:20.962841 [error] [MainThread]: [33mDatabase Error in model users (models/users.sql)[0m
15:21:20.962951 [error] [MainThread]:   relation "payments" does not exist
15:21:20.963054 [error] [MainThread]:   LINE 19:         from payments
15:21:20.963156 [error] [MainThread]:                         ^
15:21:20.963252 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/users.sql
15:21:20.963356 [info ] [MainThread]: 
15:21:20.963457 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
15:21:20.963596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e076a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106276cd0>]}


============================== 2022-05-27 15:21:47.054526 | a80d883e-3df9-4685-b9af-05b48f7d917e ==============================
15:21:47.054542 [info ] [MainThread]: Running with dbt=1.1.0
15:21:47.054936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/teal/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:21:47.055023 [debug] [MainThread]: Tracking: tracking
15:21:47.068582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481bf70>]}
15:21:47.084273 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
15:21:47.084445 [debug] [MainThread]: Partial parsing: deleted file: demo_data_project://models/users.sql
15:21:47.086350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.demo_data_project.example

15:21:47.089167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e2f10>]}
15:21:47.091520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a1eb0>]}
15:21:47.091657 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:21:47.091789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a1f70>]}
15:21:47.092479 [info ] [MainThread]: 
15:21:47.092690 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:47.093141 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination"
15:21:47.097705 [debug] [ThreadPool]: Using postgres connection "list_demo_destination"
15:21:47.097917 [debug] [ThreadPool]: On list_demo_destination: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination"} */

    select distinct nspname from pg_namespace
  
15:21:47.097995 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:21:47.124799 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
15:21:47.125704 [debug] [ThreadPool]: On list_demo_destination: Close
15:21:47.126318 [debug] [ThreadPool]: Acquiring new postgres connection "list_demo_destination_public"
15:21:47.129232 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:21:47.129326 [debug] [ThreadPool]: On list_demo_destination_public: BEGIN
15:21:47.129398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:21:47.134638 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:21:47.134727 [debug] [ThreadPool]: Using postgres connection "list_demo_destination_public"
15:21:47.134794 [debug] [ThreadPool]: On list_demo_destination_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "list_demo_destination_public"} */
select
      'demo_destination' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'demo_destination' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:21:47.141212 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
15:21:47.141896 [debug] [ThreadPool]: On list_demo_destination_public: ROLLBACK
15:21:47.142130 [debug] [ThreadPool]: On list_demo_destination_public: Close
15:21:47.144258 [debug] [MainThread]: Using postgres connection "master"
15:21:47.144353 [debug] [MainThread]: On master: BEGIN
15:21:47.144421 [debug] [MainThread]: Opening a new connection, currently in state init
15:21:47.151096 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:21:47.151190 [debug] [MainThread]: Using postgres connection "master"
15:21:47.151262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:21:47.184554 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
15:21:47.185279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a1bb0>]}
15:21:47.185461 [debug] [MainThread]: On master: ROLLBACK
15:21:47.185696 [debug] [MainThread]: Using postgres connection "master"
15:21:47.185790 [debug] [MainThread]: On master: BEGIN
15:21:47.186084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:21:47.186173 [debug] [MainThread]: On master: COMMIT
15:21:47.186253 [debug] [MainThread]: Using postgres connection "master"
15:21:47.186325 [debug] [MainThread]: On master: COMMIT
15:21:47.186506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:21:47.186642 [debug] [MainThread]: On master: Close
15:21:47.186865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:21:47.187056 [info ] [MainThread]: 
15:21:47.189082 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_accounts
15:21:47.189304 [info ] [Thread-1  ]: 1 of 6 START view model public.stg_accounts .................................... [RUN]
15:21:47.189579 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_accounts"
15:21:47.189678 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_accounts
15:21:47.189779 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_accounts
15:21:47.190534 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_accounts"
15:21:47.190901 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.191004 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_accounts
15:21:47.224302 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_accounts"
15:21:47.224696 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:47.224773 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: BEGIN
15:21:47.224837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:47.227284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:47.227379 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:47.227443 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */

  create view "demo_destination"."public"."stg_accounts__dbt_tmp" as (
    select 
    id as account_id
    , name as account_name
    , domain
    , plan_id
    , created_at
    , updated_at

from demo.accounts
  );
15:21:47.228245 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:47.231132 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:47.231224 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts" rename to "stg_accounts__dbt_backup"
15:21:47.231496 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.232589 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:47.232676 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
alter table "demo_destination"."public"."stg_accounts__dbt_tmp" rename to "stg_accounts"
15:21:47.233106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.236027 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:21:47.236112 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:47.236181 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: COMMIT
15:21:47.237085 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:47.239092 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_accounts"
15:21:47.239175 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_accounts"} */
drop view if exists "demo_destination"."public"."stg_accounts__dbt_backup" cascade
15:21:47.240221 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:47.240694 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.240784 [debug] [Thread-1  ]: On model.demo_data_project.stg_accounts: Close
15:21:47.240959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009ac700>]}
15:21:47.241112 [info ] [Thread-1  ]: 1 of 6 OK created view model public.stg_accounts ............................... [[32mCREATE VIEW[0m in 0.05s]
15:21:47.241297 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_accounts
15:21:47.241385 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_payments
15:21:47.241484 [info ] [Thread-1  ]: 2 of 6 START view model public.stg_payments .................................... [RUN]
15:21:47.241656 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_payments"
15:21:47.241727 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_payments
15:21:47.241796 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_payments
15:21:47.242378 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_payments"
15:21:47.242652 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.242724 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_payments
15:21:47.243668 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_payments"
15:21:47.243857 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:47.243924 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: BEGIN
15:21:47.243983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:47.247623 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:47.247764 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:47.247827 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */

  create view "demo_destination"."public"."stg_payments__dbt_tmp" as (
    select
    id as payment_id
    , account_id
    , amount
    , state
    , created_at
from demo.payments
  );
15:21:47.249756 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:47.250951 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:47.251033 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments" rename to "stg_payments__dbt_backup"
15:21:47.251347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.252346 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:47.252424 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
alter table "demo_destination"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
15:21:47.253021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.253913 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:21:47.254008 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:47.254086 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: COMMIT
15:21:47.254477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:47.255360 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_payments"
15:21:47.255455 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_payments"} */
drop view if exists "demo_destination"."public"."stg_payments__dbt_backup" cascade
15:21:47.256662 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:47.257285 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.257384 [debug] [Thread-1  ]: On model.demo_data_project.stg_payments: Close
15:21:47.257593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ecd60>]}
15:21:47.257767 [info ] [Thread-1  ]: 2 of 6 OK created view model public.stg_payments ............................... [[32mCREATE VIEW[0m in 0.02s]
15:21:47.257975 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_payments
15:21:47.258067 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_plans
15:21:47.258224 [info ] [Thread-1  ]: 3 of 6 START view model public.stg_plans ....................................... [RUN]
15:21:47.258423 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_plans"
15:21:47.258496 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_plans
15:21:47.258567 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_plans
15:21:47.259110 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_plans"
15:21:47.259418 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.259497 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_plans
15:21:47.260608 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_plans"
15:21:47.260825 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:47.260890 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: BEGIN
15:21:47.260951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:47.264996 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:47.265174 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:47.265248 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */

  create view "demo_destination"."public"."stg_plans__dbt_tmp" as (
    select
    id
    , name
    , seats
    , monthly_rate
from demo.plans
  );
15:21:47.267938 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:47.269292 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:47.269381 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans" rename to "stg_plans__dbt_backup"
15:21:47.270324 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.271371 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:47.271465 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
alter table "demo_destination"."public"."stg_plans__dbt_tmp" rename to "stg_plans"
15:21:47.271858 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.272496 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:21:47.272571 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:47.272634 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: COMMIT
15:21:47.273158 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:47.274744 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_plans"
15:21:47.274824 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_plans"} */
drop view if exists "demo_destination"."public"."stg_plans__dbt_backup" cascade
15:21:47.275989 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:47.276478 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.276560 [debug] [Thread-1  ]: On model.demo_data_project.stg_plans: Close
15:21:47.276748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c01070>]}
15:21:47.276918 [info ] [Thread-1  ]: 3 of 6 OK created view model public.stg_plans .................................. [[32mCREATE VIEW[0m in 0.02s]
15:21:47.277107 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_plans
15:21:47.277243 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_purchases
15:21:47.277530 [info ] [Thread-1  ]: 4 of 6 START view model public.stg_purchases ................................... [RUN]
15:21:47.277783 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_purchases"
15:21:47.277860 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_purchases
15:21:47.277930 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_purchases
15:21:47.278525 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_purchases"
15:21:47.278739 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.278811 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_purchases
15:21:47.279842 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_purchases"
15:21:47.280027 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:47.280096 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: BEGIN
15:21:47.280155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:47.284364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:21:47.284525 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:47.284598 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */

  create view "demo_destination"."public"."stg_purchases__dbt_tmp" as (
    select
    id as purchase_id
    , user_id
    , item
    , category
    , price
    , state
    , created_at

from demo.purchases
  );
15:21:47.286127 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:47.287400 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:47.287506 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases" rename to "stg_purchases__dbt_backup"
15:21:47.288116 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.289192 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:47.289282 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
alter table "demo_destination"."public"."stg_purchases__dbt_tmp" rename to "stg_purchases"
15:21:47.289594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.290100 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:21:47.290166 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:47.290223 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: COMMIT
15:21:47.290587 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:47.291261 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_purchases"
15:21:47.291329 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_purchases"} */
drop view if exists "demo_destination"."public"."stg_purchases__dbt_backup" cascade
15:21:47.292788 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:47.293299 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.293391 [debug] [Thread-1  ]: On model.demo_data_project.stg_purchases: Close
15:21:47.293593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104beb0d0>]}
15:21:47.293767 [info ] [Thread-1  ]: 4 of 6 OK created view model public.stg_purchases .............................. [[32mCREATE VIEW[0m in 0.02s]
15:21:47.293964 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_purchases
15:21:47.294061 [debug] [Thread-1  ]: Began running node model.demo_data_project.stg_users
15:21:47.294222 [info ] [Thread-1  ]: 5 of 6 START view model public.stg_users ....................................... [RUN]
15:21:47.294418 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.stg_users"
15:21:47.294490 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.stg_users
15:21:47.294560 [debug] [Thread-1  ]: Compiling model.demo_data_project.stg_users
15:21:47.295143 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.stg_users"
15:21:47.295415 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.295496 [debug] [Thread-1  ]: Began executing node model.demo_data_project.stg_users
15:21:47.296577 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.stg_users"
15:21:47.296778 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:47.296851 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: BEGIN
15:21:47.296914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:47.302361 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:47.302447 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:47.302508 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */

  create view "demo_destination"."public"."stg_users__dbt_tmp" as (
    select 
    id as user_id
    , account_id
    , first_name
    , last_name
    , email
    , gender
    , language
    , deactivated

from demo.users
  );
15:21:47.305929 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:21:47.307053 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:47.307141 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users" rename to "stg_users__dbt_backup"
15:21:47.307673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.308614 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:47.308686 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
alter table "demo_destination"."public"."stg_users__dbt_tmp" rename to "stg_users"
15:21:47.309161 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:21:47.309738 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:21:47.309822 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:47.309889 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: COMMIT
15:21:47.310688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:21:47.311490 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.stg_users"
15:21:47.311566 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.stg_users"} */
drop view if exists "demo_destination"."public"."stg_users__dbt_backup" cascade
15:21:47.313064 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:21:47.313668 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.313763 [debug] [Thread-1  ]: On model.demo_data_project.stg_users: Close
15:21:47.313962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4d280>]}
15:21:47.314122 [info ] [Thread-1  ]: 5 of 6 OK created view model public.stg_users .................................. [[32mCREATE VIEW[0m in 0.02s]
15:21:47.314355 [debug] [Thread-1  ]: Finished running node model.demo_data_project.stg_users
15:21:47.314479 [debug] [Thread-1  ]: Began running node model.demo_data_project.customers
15:21:47.314593 [info ] [Thread-1  ]: 6 of 6 START table model public.customers ...................................... [RUN]
15:21:47.314804 [debug] [Thread-1  ]: Acquiring new postgres connection "model.demo_data_project.customers"
15:21:47.314876 [debug] [Thread-1  ]: Began compiling node model.demo_data_project.customers
15:21:47.314944 [debug] [Thread-1  ]: Compiling model.demo_data_project.customers
15:21:47.316390 [debug] [Thread-1  ]: Writing injected SQL for node "model.demo_data_project.customers"
15:21:47.316662 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.316742 [debug] [Thread-1  ]: Began executing node model.demo_data_project.customers
15:21:47.326763 [debug] [Thread-1  ]: Writing runtime SQL for node "model.demo_data_project.customers"
15:21:47.327132 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:21:47.327212 [debug] [Thread-1  ]: On model.demo_data_project.customers: BEGIN
15:21:47.327275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:21:47.333487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:21:47.333636 [debug] [Thread-1  ]: Using postgres connection "model.demo_data_project.customers"
15:21:47.333709 [debug] [Thread-1  ]: On model.demo_data_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "demo_data_project", "target_name": "dev", "node_id": "model.demo_data_project.customers"} */


  create  table "demo_destination"."public"."customers__dbt_tmp"
  as (
    

with accounts as (
    select * from "demo_destination"."public"."stg_accounts"
),

payments as (
    select * from "demo_destination"."public"."stg_payments"
),

plans as (
    select * from "demo_destination"."public"."stg_plans"
),

account_payments as (
    select account_id,
    ROUND(sum( amount )::numeric,0) as total_payment 
        from payments
        
    where payments.state='successful'

    group by account_id
),

account_failed_payments as (
    select account_id,
    count( payment_id ) as failed_count
        from payments
    where payments.state='failed'

    group by account_id
),

account_status as (
    select account_id,
    account_payments,
    extract(YEAR from age(account.created_at, current_timestamp())) * 12 + extract(MONTH FROM age(account.created_at, current_timestamp())) as account_age_months,
    account_age_months * (SELECT plan.price WHERE plan.plan_id = account.plan_id) as billable_amount,

    from accounts

    left join account_payments
        on accounts.account_id = account_payments.account_id
    left join plans
        on accounts.plan_id = plan.plan_id
)

final as (

    select  
        accounts.account_name,
        accounts.account_id,
        account_payments.total_payment as account_lifetime_value,
        account_failed_payments.failed_count as account_failed_payments

    from accounts

    left join account_payments 
        on accounts.account_id = account_payments.account_id

    left join account_failed_payments   
        on accounts.account_id = account_failed_payments.account_id

)

select * from final
  );
15:21:47.334210 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 42: ...AR from age(account.created_at, current_timestamp())) * 12 +...
                                                              ^

15:21:47.334309 [debug] [Thread-1  ]: On model.demo_data_project.customers: ROLLBACK
15:21:47.334557 [debug] [Thread-1  ]: finished collecting timing info
15:21:47.334643 [debug] [Thread-1  ]: On model.demo_data_project.customers: Close
15:21:47.334796 [debug] [Thread-1  ]: Database Error in model customers (models/customers.sql)
  syntax error at or near ")"
  LINE 42: ...AR from age(account.created_at, current_timestamp())) * 12 +...
                                                                ^
  compiled SQL at target/run/demo_data_project/models/customers.sql
15:21:47.334930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a80d883e-3df9-4685-b9af-05b48f7d917e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c30d00>]}
15:21:47.335107 [error] [Thread-1  ]: 6 of 6 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
15:21:47.335307 [debug] [Thread-1  ]: Finished running node model.demo_data_project.customers
15:21:47.335798 [debug] [MainThread]: Acquiring new postgres connection "master"
15:21:47.335887 [debug] [MainThread]: Using postgres connection "master"
15:21:47.335955 [debug] [MainThread]: On master: BEGIN
15:21:47.336011 [debug] [MainThread]: Opening a new connection, currently in state closed
15:21:47.342096 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:21:47.342210 [debug] [MainThread]: On master: COMMIT
15:21:47.342277 [debug] [MainThread]: Using postgres connection "master"
15:21:47.342335 [debug] [MainThread]: On master: COMMIT
15:21:47.342502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:21:47.342579 [debug] [MainThread]: On master: Close
15:21:47.342737 [info ] [MainThread]: 
15:21:47.342849 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0.25s.
15:21:47.342958 [debug] [MainThread]: Connection 'master' was properly closed.
15:21:47.343016 [debug] [MainThread]: Connection 'model.demo_data_project.customers' was properly closed.
15:21:47.346176 [info ] [MainThread]: 
15:21:47.346333 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:21:47.346458 [info ] [MainThread]: 
15:21:47.346561 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
15:21:47.346661 [error] [MainThread]:   syntax error at or near ")"
15:21:47.346760 [error] [MainThread]:   LINE 42: ...AR from age(account.created_at, current_timestamp())) * 12 +...
15:21:47.346852 [error] [MainThread]:                                                                 ^
15:21:47.346943 [error] [MainThread]:   compiled SQL at target/run/demo_data_project/models/customers.sql
15:21:47.347041 [info ] [MainThread]: 
15:21:47.347136 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
15:21:47.347273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bee460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bee820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bee3a0>]}
